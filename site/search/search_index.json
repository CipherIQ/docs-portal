{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"CipherIQ","text":"<p>Welcome to the CipherIQ portal.</p>"},{"location":"#products","title":"Products","text":""},{"location":"#cbom-generator","title":"CBOM Generator","text":"<p>Cryptographic Bill of Materials Generator for Post-Quantum Cryptography (PQC) readiness assessment.</p> <ul> <li>Inventories cryptographic assets on Linux systems</li> <li>CycloneDX 1.6/1.7 output format</li> <li>Service discovery with YAML plugins</li> <li>Privacy-by-default (GDPR/CCPA compliant)</li> </ul>"},{"location":"#quick-links","title":"Quick Links","text":"<ul> <li>GitHub Organization</li> <li>Support</li> </ul>"},{"location":"cbom-generator/","title":"CBOM Generator","text":"<p>Version: 1.9.0 | Platform: Linux (Ubuntu, RHEL, Debian)</p>"},{"location":"cbom-generator/#what-is-cbom-generator","title":"What is CBOM Generator?","text":"<p>The Cryptographic Bill of Materials (CBOM) Generator is a production-ready, high-performance C11 multithreaded application that inventories cryptographic assets on Linux systems to assess Post-Quantum Cryptography (PQC) readiness.</p> <p>Key Capabilities:</p> <ul> <li>Comprehensive Asset Discovery: Certificates, keys, packages, services, protocols, cipher suites</li> <li>Complete Dependency Graph: Tracks relationships between services, protocols, and algorithms</li> <li>PQC Readiness Assessment: Analyzes quantum vulnerability across your entire cryptographic infrastructure</li> <li>High Performance: Scans 12,000+ files/minute with parallel processing</li> <li>Privacy-by-Default: GDPR/CCPA compliant with configurable redaction</li> <li>Industry Standards: Outputs CycloneDX 1.6/1.7 format with CBOM extensions</li> </ul>"},{"location":"cbom-generator/#why-use-cbom-generator","title":"Why Use CBOM Generator?","text":""},{"location":"cbom-generator/#for-security-teams","title":"For Security Teams","text":"<ul> <li>Inventory all cryptographic assets before quantum computers break current encryption</li> <li>Identify weak or deprecated algorithms that need immediate replacement</li> <li>Track certificate expiration and trust issues</li> <li>Map service dependencies on cryptographic components</li> </ul>"},{"location":"cbom-generator/#for-compliance","title":"For Compliance","text":"<ul> <li>Generate machine-readable cryptographic inventories for audits</li> <li>Track FIPS 140-2/3 certified implementations</li> <li>Document privacy controls and data redaction</li> <li>Provide SLSA provenance for build transparency</li> </ul>"},{"location":"cbom-generator/#for-operations","title":"For Operations","text":"<ul> <li>Discover all TLS/SSH configurations across infrastructure</li> <li>Identify services using deprecated protocols or cipher suites</li> <li>Plan migrations with PQC readiness scoring and recommendations</li> </ul>"},{"location":"cbom-generator/#quick-links","title":"Quick Links","text":"<ul> <li>Installation - Get started with building and installing</li> <li>Quick Start - Run your first scan</li> <li>CLI Reference - Complete command-line options</li> <li>Features - Deep-dive into capabilities</li> <li>Playbooks - Step-by-step migration guides</li> </ul>"},{"location":"cbom-generator/about/best-practices/","title":"Best Practices","text":"<p>Recommended usage patterns for CBOM Generator.</p>"},{"location":"cbom-generator/about/best-practices/#privacy-mode","title":"Privacy Mode","text":"<p>Always use privacy mode for external sharing:</p> <pre><code>./build/cbom-generator --no-personal-data --output audit-cbom.json\n</code></pre> <p>This ensures: - Hostnames redacted - Usernames redacted - File paths anonymized - GDPR/CCPA compliance</p>"},{"location":"cbom-generator/about/best-practices/#deduplication","title":"Deduplication","text":"<p>Use safe deduplication for production scans:</p> <pre><code>./build/cbom-generator --dedup-mode=safe --output cbom.json\n</code></pre> <p>Benefits: - Single component per unique certificate - All locations preserved in evidence - Balanced output size and detail</p>"},{"location":"cbom-generator/about/best-practices/#cyclonedx-format","title":"CycloneDX Format","text":"<p>Use CycloneDX for interoperability:</p> <pre><code>./build/cbom-generator --format cyclonedx --cyclonedx-spec 1.7 --output cbom.json\n</code></pre> <ul> <li>Industry standard format</li> <li>Tool ecosystem compatibility</li> <li>Full CBOM extension support</li> </ul>"},{"location":"cbom-generator/about/best-practices/#cbom_salt","title":"CBOM_SALT","text":"<p>Set consistent salt for reproducible pseudonyms:</p> <pre><code>export CBOM_SALT=\"organization-specific-salt-value\"\n./build/cbom-generator --no-personal-data --output cbom.json\n</code></pre> <p>This allows: - Consistent pseudonyms across scans - Cross-organization correlation - Reproducible results</p>"},{"location":"cbom-generator/about/best-practices/#schema-validation","title":"Schema Validation","text":"<p>Validate output against CycloneDX schema:</p> <pre><code># Generate CBOM\n./build/cbom-generator --output cbom.json\n\n# Validate\ncyclonedx validate --input cbom.json\n</code></pre>"},{"location":"cbom-generator/about/best-practices/#service-discovery","title":"Service Discovery","text":"<p>Enable service discovery for complete inventory:</p> <pre><code>./build/cbom-generator \\\n    --discover-services \\\n    --plugin-dir plugins \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --output cbom.json\n</code></pre> <p>This captures: - Running services - TLS/SSH configurations - Protocol and cipher suite details</p>"},{"location":"cbom-generator/about/best-practices/#error-logging","title":"Error Logging","text":"<p>Use error logging with TUI mode:</p> <pre><code>./build/cbom-generator \\\n    --tui \\\n    --error-log /tmp/cbom-errors.log \\\n    --output cbom.json\n</code></pre> <p>TUI suppresses stderr, so error log is essential for debugging.</p>"},{"location":"cbom-generator/about/best-practices/#deterministic-output","title":"Deterministic Output","text":"<p>Keep deterministic mode enabled (default):</p> <pre><code>./build/cbom-generator --deterministic --output cbom.json\n</code></pre> <p>Enables: - CI/CD change detection - CBOM comparison over time - Reproducible results</p>"},{"location":"cbom-generator/about/best-practices/#cross-architecture-scanning","title":"Cross-Architecture Scanning","text":"<p>Use cross-arch mode for embedded systems:</p> <pre><code>./build/cbom-generator \\\n    --cross-arch \\\n    --crypto-registry crypto-registry-yocto.yaml \\\n    --plugin-dir plugins/embedded \\\n    --output rootfs-cbom.json \\\n    /path/to/rootfs\n</code></pre>"},{"location":"cbom-generator/about/best-practices/#regular-scanning","title":"Regular Scanning","text":"<p>Schedule regular scans for monitoring:</p> <pre><code># Weekly scan\n0 0 * * 0 ./build/cbom-generator \\\n    --discover-services \\\n    --plugin-dir plugins \\\n    --no-personal-data \\\n    --output /var/cbom/cbom-$(date +%Y%m%d).json\n</code></pre>"},{"location":"cbom-generator/about/best-practices/#pqc-migration","title":"PQC Migration","text":"<p>Generate migration reports for planning:</p> <pre><code>./build/cbom-generator \\\n    --pqc-report migration-plan.txt \\\n    --output cbom.json\n</code></pre> <p>Review break year distribution and prioritize migrations.</p>"},{"location":"cbom-generator/about/support/","title":"Support","text":"<p>Getting help with CBOM Generator.</p>"},{"location":"cbom-generator/about/support/#getting-help","title":"Getting Help","text":""},{"location":"cbom-generator/about/support/#documentation","title":"Documentation","text":"<ul> <li>Installation Guide</li> <li>Quick Start</li> <li>CLI Reference</li> <li>Troubleshooting</li> </ul>"},{"location":"cbom-generator/about/support/#command-line-help","title":"Command-Line Help","text":"<pre><code>./build/cbom-generator --help\n./build/cbom-generator --version\n</code></pre>"},{"location":"cbom-generator/about/support/#reporting-issues","title":"Reporting Issues","text":""},{"location":"cbom-generator/about/support/#github-issues","title":"GitHub Issues","text":"<p>Report bugs and feature requests at: https://github.com/your-org/cryptoBOM/issues</p>"},{"location":"cbom-generator/about/support/#issue-template","title":"Issue Template","text":"<p>When reporting issues, include:</p> <ol> <li>CBOM Generator version: <code>./build/cbom-generator --version</code></li> <li>Operating system: <code>uname -a</code></li> <li>Command used: Full command line</li> <li>Error message: Complete error output</li> <li>Steps to reproduce: Minimal steps to trigger the issue</li> </ol>"},{"location":"cbom-generator/about/support/#technical-documentation","title":"Technical Documentation","text":""},{"location":"cbom-generator/about/support/#design-documents","title":"Design Documents","text":"<ul> <li><code>docs/DESIGN.md</code> - Technical architecture</li> <li><code>docs/REQUIREMENTS.md</code> - Formal requirements</li> <li><code>docs/NORMALIZATION.md</code> - Asset ID generation</li> </ul>"},{"location":"cbom-generator/about/support/#plugin-development","title":"Plugin Development","text":"<ul> <li><code>docs/PLUGIN_GUIDE.md</code> - Plugin development guide</li> <li><code>docs/PLUGIN_YAML_FORMAT.md</code> - YAML plugin schema</li> </ul>"},{"location":"cbom-generator/about/support/#api-documentation","title":"API Documentation","text":"<ul> <li><code>include/*.h</code> - Header files with API documentation</li> </ul>"},{"location":"cbom-generator/about/support/#external-references","title":"External References","text":""},{"location":"cbom-generator/about/support/#cyclonedx","title":"CycloneDX","text":"<ul> <li>CycloneDX Specification</li> <li>CBOM Extensions</li> <li>Schema Downloads</li> </ul>"},{"location":"cbom-generator/about/support/#nist-standards","title":"NIST Standards","text":"<ul> <li>NIST SP 800-57 - Key Management</li> <li>NIST IR 8413 - PQC Status Report</li> <li>FIPS 140-3 - Cryptographic Module Standards</li> </ul>"},{"location":"cbom-generator/about/support/#pqc-resources","title":"PQC Resources","text":"<ul> <li>NIST PQC Project</li> <li>NSA CNSA 2.0</li> </ul>"},{"location":"cbom-generator/about/support/#license","title":"License","text":"<p>CBOM Generator is licensed under GPL-3.0-or-later.</p> <p>For commercial licensing options, contact: sales@cipheriq.io</p>"},{"location":"cbom-generator/about/support/#contributing","title":"Contributing","text":"<p>Contributions are welcome! See <code>CONTRIBUTING.md</code> for guidelines.</p>"},{"location":"cbom-generator/about/support/#development-setup","title":"Development Setup","text":"<pre><code># Clone repository\ngit clone https://github.com/your-org/cryptoBOM.git\ncd cryptoBOM\n\n# Build debug version\ncmake -B build-debug -DCMAKE_BUILD_TYPE=Debug\ncmake --build build-debug\n\n# Run tests\ncd build-debug &amp;&amp; ctest\n</code></pre>"},{"location":"cbom-generator/about/support/#contact","title":"Contact","text":"<ul> <li>Technical Support: support@cipheriq.io</li> <li>Sales: sales@cipheriq.io</li> <li>GitHub: https://github.com/your-org/cryptoBOM</li> </ul> <p>Copyright (c) 2025 Graziano Labs Corp.</p>"},{"location":"cbom-generator/about/whats-new/","title":"What's New","text":"<p>Release highlights for CBOM Generator.</p>"},{"location":"cbom-generator/about/whats-new/#v190-december-2025","title":"v1.9.0 (December 2025)","text":""},{"location":"cbom-generator/about/whats-new/#crypto-registry-extension","title":"Crypto Registry Extension","text":"<ul> <li>External YAML registries for custom crypto library detection</li> <li>Distribution-specific registries: Ubuntu, Yocto, Alpine, OpenWrt</li> <li>No recompilation needed for new library support</li> </ul>"},{"location":"cbom-generator/about/whats-new/#cross-architecture-scanning","title":"Cross-Architecture Scanning","text":"<ul> <li><code>--cross-arch</code> flag for Yocto/Buildroot rootfs scanning</li> <li>ELF VERNEED version detection without package managers</li> <li>Embedded service plugins for IoT devices</li> </ul>"},{"location":"cbom-generator/about/whats-new/#alternate-detection-pqc","title":"Alternate Detection PQC","text":"<ul> <li>Kernel crypto API detection (AF_ALG)</li> <li>Static linking detection (Go, Rust)</li> <li>Symbol analysis for embedded crypto</li> <li>Improved PQC classification for alternate-detected apps</li> </ul>"},{"location":"cbom-generator/about/whats-new/#v160-november-2025","title":"v1.6.0 (November 2025)","text":""},{"location":"cbom-generator/about/whats-new/#extensible-crypto-registry","title":"Extensible Crypto Registry","text":"<ul> <li>YAML configuration for crypto library definitions</li> <li>Built-in registry: OpenSSL, libgcrypt, libsodium, nettle, Kerberos</li> <li>Graceful fallback on YAML errors</li> </ul>"},{"location":"cbom-generator/about/whats-new/#v130-november-2025","title":"v1.3.0 (November 2025)","text":""},{"location":"cbom-generator/about/whats-new/#yaml-plugin-architecture","title":"YAML Plugin Architecture","text":"<ul> <li>Declarative service plugins in YAML</li> <li>50+ enterprise plugins included</li> <li>19 embedded Linux plugins for IoT</li> <li>Phase pipeline: Detection \u2192 Extraction \u2192 Generation</li> </ul>"},{"location":"cbom-generator/about/whats-new/#service-discovery-enhancements","title":"Service Discovery Enhancements","text":"<ul> <li>5 detection methods: process, port, config, systemd, package</li> <li>6 config parsers: INI, Apache, Nginx, YAML, JSON, OpenSSL cipher</li> <li>Full dependency graph: SERVICE\u2192PROTOCOL\u2192SUITE\u2192ALGORITHM</li> </ul>"},{"location":"cbom-generator/about/whats-new/#v120-november-2025","title":"v1.2.0 (November 2025)","text":""},{"location":"cbom-generator/about/whats-new/#pqc-assessment-enhancements","title":"PQC Assessment Enhancements","text":"<ul> <li>Break year estimation: 2030/2035/2040/2045 timeline</li> <li>Migration report: <code>--pqc-report</code> flag</li> <li>Per-component rationale: Explains classification</li> <li>Hybrid detection: X25519-ML-KEM-768</li> </ul>"},{"location":"cbom-generator/about/whats-new/#v110-november-2025","title":"v1.1.0 (November 2025)","text":""},{"location":"cbom-generator/about/whats-new/#schema-compliance","title":"Schema Compliance","text":"<ul> <li>100% CycloneDX validation pass rate</li> <li>Human-readable bom-refs: <code>cert:digicert-root-ca</code></li> <li>Zero hash collisions</li> </ul>"},{"location":"cbom-generator/about/whats-new/#deprecated","title":"Deprecated","text":"<ul> <li>Epoch timestamps (use ISO-8601)</li> </ul>"},{"location":"cbom-generator/about/whats-new/#v100-november-2025","title":"v1.0.0 (November 2025)","text":""},{"location":"cbom-generator/about/whats-new/#initial-release","title":"Initial Release","text":"<ul> <li>5 built-in scanners: Certificate, Key, Package, Service, Filesystem</li> <li>CycloneDX 1.6/1.7 output</li> <li>PQC readiness assessment</li> <li>Privacy-by-default (GDPR/CCPA)</li> <li>Multi-threaded scanning</li> <li>Persistent caching</li> <li>SLSA provenance</li> </ul>"},{"location":"cbom-generator/advanced/","title":"Advanced Usage","text":"<p>Expert features for power users and automation.</p>"},{"location":"cbom-generator/advanced/#advanced-topics","title":"Advanced Topics","text":"Topic Description Comparing CBOMs Diff CBOMs over time Filtering Output jq queries for analysis Generating Reports Custom report generation"},{"location":"cbom-generator/advanced/#automation-examples","title":"Automation Examples","text":""},{"location":"cbom-generator/advanced/#cicd-integration","title":"CI/CD Integration","text":"<pre><code>#!/bin/bash\n# ci-cbom-check.sh\n\n# Generate CBOM\n./build/cbom-generator \\\n    --deterministic \\\n    --no-personal-data \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --output current-cbom.json\n\n# Check PQC readiness threshold\nSCORE=$(cat current-cbom.json | jq -r '.metadata.properties[] | select(.name == \"cbom:pqc:readiness_score\") | .value')\nif (( $(echo \"$SCORE &lt; 10\" | bc -l) )); then\n    echo \"FAIL: PQC readiness score $SCORE% below threshold\"\n    exit 1\nfi\n\necho \"PASS: PQC readiness score $SCORE%\"\n</code></pre>"},{"location":"cbom-generator/advanced/#scheduled-scanning","title":"Scheduled Scanning","text":"<pre><code># /etc/cron.weekly/cbom-scan\n#!/bin/bash\n\nDATE=$(date +%Y%m%d)\n./build/cbom-generator \\\n    --discover-services \\\n    --plugin-dir /opt/cbom/plugins \\\n    --no-personal-data \\\n    --pqc-report /var/reports/pqc-$DATE.txt \\\n    --output /var/cbom/cbom-$DATE.json\n</code></pre>"},{"location":"cbom-generator/advanced/#container-scanning","title":"Container Scanning","text":"<pre><code># Extract and scan container filesystem\ndocker export container_id | tar -C /tmp/container-fs -xf -\n./build/cbom-generator \\\n    --cross-arch \\\n    --crypto-registry crypto-registry-alpine.yaml \\\n    --output container-cbom.json \\\n    /tmp/container-fs\nrm -rf /tmp/container-fs\n</code></pre>"},{"location":"cbom-generator/advanced/#environment-variables","title":"Environment Variables","text":"Variable Description <code>CBOM_SALT</code> Salt for privacy redaction (consistent pseudonyms) <code>CBOM_CACHE_DIR</code> Cache directory location <code>CBOM_LOG_LEVEL</code> Logging verbosity"},{"location":"cbom-generator/advanced/#output-piping","title":"Output Piping","text":"<pre><code># Stream to another tool\n./build/cbom-generator --output - | tee cbom.json | jq '.components | length'\n\n# Compress output\n./build/cbom-generator --output - | gzip &gt; cbom.json.gz\n\n# Send to remote\n./build/cbom-generator --output - | curl -X POST -d @- https://api.example.com/cbom\n</code></pre>"},{"location":"cbom-generator/advanced/comparing-cboms/","title":"Comparing CBOMs","text":"<p>Track changes in cryptographic assets over time.</p>"},{"location":"cbom-generator/advanced/comparing-cboms/#use-cases","title":"Use Cases","text":"<ul> <li>Detect new/removed certificates</li> <li>Track algorithm changes</li> <li>Monitor PQC readiness progress</li> <li>Audit configuration drift</li> </ul>"},{"location":"cbom-generator/advanced/comparing-cboms/#basic-comparison","title":"Basic Comparison","text":""},{"location":"cbom-generator/advanced/comparing-cboms/#hash-comparison","title":"Hash Comparison","text":"<pre><code># Quick check if anything changed\nsha256sum baseline.json current.json\n</code></pre>"},{"location":"cbom-generator/advanced/comparing-cboms/#component-count-comparison","title":"Component Count Comparison","text":"<pre><code>echo \"Baseline:\"\ncat baseline.json | jq '.components | length'\n\necho \"Current:\"\ncat current.json | jq '.components | length'\n</code></pre>"},{"location":"cbom-generator/advanced/comparing-cboms/#detailed-comparisons","title":"Detailed Comparisons","text":""},{"location":"cbom-generator/advanced/comparing-cboms/#find-new-components","title":"Find New Components","text":"<pre><code># Extract component names\ncat baseline.json | jq -r '.components[].name' | sort &gt; baseline-names.txt\ncat current.json | jq -r '.components[].name' | sort &gt; current-names.txt\n\n# Find additions\ncomm -13 baseline-names.txt current-names.txt\n</code></pre>"},{"location":"cbom-generator/advanced/comparing-cboms/#find-removed-components","title":"Find Removed Components","text":"<pre><code># Find removals\ncomm -23 baseline-names.txt current-names.txt\n</code></pre>"},{"location":"cbom-generator/advanced/comparing-cboms/#find-changed-components","title":"Find Changed Components","text":"<pre><code># Compare by bom-ref\ncat baseline.json | jq -r '.components[] | \"\\(.[\"bom-ref\"])|\\(.name)\"' | sort &gt; baseline-refs.txt\ncat current.json | jq -r '.components[] | \"\\(.[\"bom-ref\"])|\\(.name)\"' | sort &gt; current-refs.txt\n\ndiff baseline-refs.txt current-refs.txt\n</code></pre>"},{"location":"cbom-generator/advanced/comparing-cboms/#pqc-progress-tracking","title":"PQC Progress Tracking","text":""},{"location":"cbom-generator/advanced/comparing-cboms/#compare-pqc-scores","title":"Compare PQC Scores","text":"<pre><code>echo \"=== PQC Progress ===\"\n\necho -n \"Baseline: \"\ncat baseline.json | jq -r '.metadata.properties[] | select(.name == \"cbom:pqc:readiness_score\") | .value'\n\necho -n \"Current:  \"\ncat current.json | jq -r '.metadata.properties[] | select(.name == \"cbom:pqc:readiness_score\") | .value'\n</code></pre>"},{"location":"cbom-generator/advanced/comparing-cboms/#compare-break-year-distribution","title":"Compare Break Year Distribution","text":"<pre><code>echo \"=== Break Year Distribution ===\"\n\nfor year in 2030 2035 2040 2045; do\n    echo \"Break $year:\"\n    echo -n \"  Baseline: \"\n    cat baseline.json | jq -r \".metadata.properties[] | select(.name == \\\"cbom:pqc:break_${year}_count\\\") | .value // \\\"0\\\"\"\n    echo -n \"  Current:  \"\n    cat current.json | jq -r \".metadata.properties[] | select(.name == \\\"cbom:pqc:break_${year}_count\\\") | .value // \\\"0\\\"\"\ndone\n</code></pre>"},{"location":"cbom-generator/advanced/comparing-cboms/#certificate-tracking","title":"Certificate Tracking","text":""},{"location":"cbom-generator/advanced/comparing-cboms/#new-certificates","title":"New Certificates","text":"<pre><code>cat baseline.json | jq -r '.components[] | select(.cryptoProperties?.assetType == \"certificate\") | .name' | sort &gt; baseline-certs.txt\ncat current.json | jq -r '.components[] | select(.cryptoProperties?.assetType == \"certificate\") | .name' | sort &gt; current-certs.txt\n\necho \"New certificates:\"\ncomm -13 baseline-certs.txt current-certs.txt\n</code></pre>"},{"location":"cbom-generator/advanced/comparing-cboms/#expired-certificates","title":"Expired Certificates","text":"<pre><code>cat current.json | jq -r '.components[] |\n    select(.cryptoProperties?.certificateProperties?.certificateState[0]?.state == \"deactivated\") |\n    \"\\(.name) - EXPIRED\"'\n</code></pre>"},{"location":"cbom-generator/advanced/comparing-cboms/#automated-diff-script","title":"Automated Diff Script","text":"<pre><code>#!/bin/bash\n# cbom-diff.sh &lt;baseline.json&gt; &lt;current.json&gt;\n\nBASELINE=$1\nCURRENT=$2\n\necho \"=== CBOM Comparison Report ===\"\necho \"Baseline: $BASELINE\"\necho \"Current:  $CURRENT\"\necho \"\"\n\n# Component counts\necho \"=== Component Counts ===\"\nprintf \"%-20s %10s %10s\\n\" \"Type\" \"Baseline\" \"Current\"\nprintf \"%-20s %10s %10s\\n\" \"----\" \"--------\" \"-------\"\n\nfor type in certificate algorithm key library service protocol; do\n    BASELINE_COUNT=$(cat $BASELINE | jq \"[.components[] | select(.cryptoProperties?.assetType == \\\"$type\\\")] | length\")\n    CURRENT_COUNT=$(cat $CURRENT | jq \"[.components[] | select(.cryptoProperties?.assetType == \\\"$type\\\")] | length\")\n    printf \"%-20s %10s %10s\\n\" \"$type\" \"$BASELINE_COUNT\" \"$CURRENT_COUNT\"\ndone\n\n# PQC comparison\necho \"\"\necho \"=== PQC Readiness ===\"\nBASELINE_PQC=$(cat $BASELINE | jq -r '.metadata.properties[] | select(.name == \"cbom:pqc:readiness_score\") | .value // \"N/A\"')\nCURRENT_PQC=$(cat $CURRENT | jq -r '.metadata.properties[] | select(.name == \"cbom:pqc:readiness_score\") | .value // \"N/A\"')\necho \"Baseline: $BASELINE_PQC%\"\necho \"Current:  $CURRENT_PQC%\"\n</code></pre>"},{"location":"cbom-generator/advanced/comparing-cboms/#time-series-analysis","title":"Time-Series Analysis","text":""},{"location":"cbom-generator/advanced/comparing-cboms/#store-historical-cboms","title":"Store Historical CBOMs","text":"<pre><code># Daily scans with dated filenames\n./build/cbom-generator --output /var/cbom/cbom-$(date +%Y%m%d).json\n\n# Keep 30 days of history\nfind /var/cbom -name \"cbom-*.json\" -mtime +30 -delete\n</code></pre>"},{"location":"cbom-generator/advanced/comparing-cboms/#generate-trend-report","title":"Generate Trend Report","text":"<pre><code>#!/bin/bash\n# Show PQC readiness trend over last 7 days\n\necho \"Date,PQC Score\"\nfor file in /var/cbom/cbom-*.json; do\n    date=$(basename $file | sed 's/cbom-\\(.*\\)\\.json/\\1/')\n    score=$(cat $file | jq -r '.metadata.properties[] | select(.name == \"cbom:pqc:readiness_score\") | .value // \"0\"')\n    echo \"$date,$score\"\ndone\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/","title":"Filtering Output","text":"<p>Use jq queries to extract specific information from CBOM output.</p>"},{"location":"cbom-generator/advanced/filtering-output/#basic-queries","title":"Basic Queries","text":""},{"location":"cbom-generator/advanced/filtering-output/#count-components","title":"Count Components","text":"<pre><code>cat cbom.json | jq '.components | length'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#list-component-names","title":"List Component Names","text":"<pre><code>cat cbom.json | jq -r '.components[].name'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#get-metadata-properties","title":"Get Metadata Properties","text":"<pre><code>cat cbom.json | jq '.metadata.properties'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#filtering-by-type","title":"Filtering by Type","text":""},{"location":"cbom-generator/advanced/filtering-output/#find-certificates","title":"Find Certificates","text":"<pre><code>cat cbom.json | jq '.components[] | select(.cryptoProperties?.assetType == \"certificate\")'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#find-algorithms","title":"Find Algorithms","text":"<pre><code>cat cbom.json | jq '.components[] | select(.cryptoProperties?.assetType == \"algorithm\")'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#find-libraries","title":"Find Libraries","text":"<pre><code>cat cbom.json | jq '.components[] | select(.type == \"library\")'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#find-services","title":"Find Services","text":"<pre><code>cat cbom.json | jq '.components[] | select(.type == \"operating-system\")'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#filtering-by-properties","title":"Filtering by Properties","text":""},{"location":"cbom-generator/advanced/filtering-output/#find-by-pqc-status","title":"Find by PQC Status","text":"<pre><code># Find DEPRECATED algorithms\ncat cbom.json | jq '.components[] |\n    select(.properties[]? | select(.name == \"cbom:pqc:status\" and .value == \"DEPRECATED\"))'\n\n# Find PQC SAFE components\ncat cbom.json | jq '.components[] |\n    select(.properties[]? | select(.name == \"cbom:pqc:status\" and .value == \"SAFE\"))'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#find-weak-keys","title":"Find Weak Keys","text":"<pre><code>cat cbom.json | jq '.components[] |\n    select(.properties[]? | select(.name == \"cbom:key:is_weak\" and .value == \"true\"))'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#find-by-security-profile","title":"Find by Security Profile","text":"<pre><code>cat cbom.json | jq '.components[] |\n    select(.properties[]? | select(.name == \"cbom:proto:security_profile\" and .value == \"OLD\"))'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#extracting-specific-fields","title":"Extracting Specific Fields","text":""},{"location":"cbom-generator/advanced/filtering-output/#component-summary","title":"Component Summary","text":"<pre><code>cat cbom.json | jq '.components[] | {name, type, \"bom-ref\"}'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#certificate-details","title":"Certificate Details","text":"<pre><code>cat cbom.json | jq '.components[] |\n    select(.cryptoProperties?.assetType == \"certificate\") |\n    {name,\n     valid_from: .cryptoProperties.certificateProperties.notValidBefore,\n     valid_to: .cryptoProperties.certificateProperties.notValidAfter}'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#key-information","title":"Key Information","text":"<pre><code>cat cbom.json | jq '.components[] |\n    select(.cryptoProperties?.assetType == \"related-crypto-material\") |\n    {name,\n     type: .cryptoProperties.relatedCryptoMaterialProperties.type,\n     size: .cryptoProperties.relatedCryptoMaterialProperties.size}'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#aggregation-queries","title":"Aggregation Queries","text":""},{"location":"cbom-generator/advanced/filtering-output/#count-by-asset-type","title":"Count by Asset Type","text":"<pre><code>cat cbom.json | jq '[.components[] | .cryptoProperties?.assetType] |\n    group_by(.) |\n    map({type: .[0], count: length})'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#count-by-pqc-status","title":"Count by PQC Status","text":"<pre><code>cat cbom.json | jq '[.components[] |\n    [.properties[]? | select(.name == \"cbom:pqc:status\")][0].value] |\n    group_by(.) |\n    map({status: .[0], count: length})'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#algorithm-distribution","title":"Algorithm Distribution","text":"<pre><code>cat cbom.json | jq '[.components[] |\n    select(.cryptoProperties?.assetType == \"algorithm\") |\n    .name] |\n    group_by(.) |\n    map({algorithm: .[0], count: length}) |\n    sort_by(.count) |\n    reverse'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#dependency-queries","title":"Dependency Queries","text":""},{"location":"cbom-generator/advanced/filtering-output/#find-service-dependencies","title":"Find Service Dependencies","text":"<pre><code>cat cbom.json | jq '.dependencies[] | select(.ref | startswith(\"service:\"))'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#trace-algorithm-usage","title":"Trace Algorithm Usage","text":"<pre><code>cat cbom.json | jq '.dependencies[] |\n    select(.dependsOn[]? | contains(\"algo:sha256\")) |\n    .ref'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#find-components-using-a-library","title":"Find Components Using a Library","text":"<pre><code>cat cbom.json | jq '.dependencies[] |\n    select(.dependsOn[]? | contains(\"library:openssl\")) |\n    .ref'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#output-formatting","title":"Output Formatting","text":""},{"location":"cbom-generator/advanced/filtering-output/#csv-export","title":"CSV Export","text":"<pre><code>cat cbom.json | jq -r '.components[] | [.name, .type, .[\"bom-ref\"]] | @csv'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#tsv-export","title":"TSV Export","text":"<pre><code>cat cbom.json | jq -r '.components[] | [.name, .type] | @tsv'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#custom-format","title":"Custom Format","text":"<pre><code>cat cbom.json | jq -r '.components[] |\n    select(.cryptoProperties?.assetType == \"certificate\") |\n    \"\\(.name)\\t\\(.cryptoProperties.certificateProperties.notValidAfter)\"'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#complex-queries","title":"Complex Queries","text":""},{"location":"cbom-generator/advanced/filtering-output/#certificates-expiring-within-30-days","title":"Certificates Expiring Within 30 Days","text":"<pre><code>EXPIRE=$(date -d \"+30 days\" --iso-8601)\ncat cbom.json | jq --arg exp \"$EXPIRE\" '.components[] |\n    select(.cryptoProperties?.certificateProperties?.notValidAfter &lt; $exp) |\n    select(.cryptoProperties?.certificateProperties != null) |\n    {name, expires: .cryptoProperties.certificateProperties.notValidAfter}'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#services-with-deprecated-protocols","title":"Services with Deprecated Protocols","text":"<pre><code>cat cbom.json | jq '.dependencies[] |\n    select(.ref | startswith(\"service:\")) |\n    select(.dependsOn[]? | test(\"protocol:tls-1\\\\.[01]\")) |\n    .ref'\n</code></pre>"},{"location":"cbom-generator/advanced/filtering-output/#complete-dependency-chain","title":"Complete Dependency Chain","text":"<pre><code># Get all dependencies for a service\nSERVICE=\"service:nginx\"\ncat cbom.json | jq --arg svc \"$SERVICE\" '\n    def deps($ref): .dependencies[] | select(.ref == $ref) | .dependsOn[];\n    {service: $svc, chain: [deps($svc)]}\n'\n</code></pre>"},{"location":"cbom-generator/advanced/generating-reports/","title":"Generating Reports","text":"<p>Create custom reports from CBOM output.</p>"},{"location":"cbom-generator/advanced/generating-reports/#built-in-pqc-report","title":"Built-in PQC Report","text":"<p>Use <code>--pqc-report</code> for comprehensive migration report:</p> <pre><code>./build/cbom-generator \\\n    --pqc-report migration-report.txt \\\n    --output cbom.json\n</code></pre>"},{"location":"cbom-generator/advanced/generating-reports/#custom-report-scripts","title":"Custom Report Scripts","text":""},{"location":"cbom-generator/advanced/generating-reports/#executive-summary","title":"Executive Summary","text":"<pre><code>#!/bin/bash\n# executive-summary.sh &lt;cbom.json&gt;\n\nCBOM=$1\n\necho \"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\"\necho \"         CRYPTOGRAPHIC INVENTORY SUMMARY\"\necho \"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\"\necho \"\"\n\n# Scan info\necho \"Scan Date: $(cat $CBOM | jq -r '.metadata.timestamp')\"\necho \"\"\n\n# Component counts\necho \"COMPONENT INVENTORY\"\necho \"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\"\nTOTAL=$(cat $CBOM | jq '.components | length')\nCERTS=$(cat $CBOM | jq '[.components[] | select(.cryptoProperties?.assetType == \"certificate\")] | length')\nKEYS=$(cat $CBOM | jq '[.components[] | select(.cryptoProperties?.assetType == \"related-crypto-material\")] | length')\nALGOS=$(cat $CBOM | jq '[.components[] | select(.cryptoProperties?.assetType == \"algorithm\")] | length')\nLIBS=$(cat $CBOM | jq '[.components[] | select(.type == \"library\")] | length')\n\nprintf \"%-20s %10s\\n\" \"Total Components:\" \"$TOTAL\"\nprintf \"%-20s %10s\\n\" \"Certificates:\" \"$CERTS\"\nprintf \"%-20s %10s\\n\" \"Keys:\" \"$KEYS\"\nprintf \"%-20s %10s\\n\" \"Algorithms:\" \"$ALGOS\"\nprintf \"%-20s %10s\\n\" \"Libraries:\" \"$LIBS\"\necho \"\"\n\n# PQC Assessment\necho \"PQC READINESS\"\necho \"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\"\nSCORE=$(cat $CBOM | jq -r '.metadata.properties[] | select(.name == \"cbom:pqc:readiness_score\") | .value // \"N/A\"')\nSAFE=$(cat $CBOM | jq -r '.metadata.properties[] | select(.name == \"cbom:pqc:safe_count\") | .value // \"0\"')\nTRANS=$(cat $CBOM | jq -r '.metadata.properties[] | select(.name == \"cbom:pqc:transitional_count\") | .value // \"0\"')\nDEPR=$(cat $CBOM | jq -r '.metadata.properties[] | select(.name == \"cbom:pqc:deprecated_count\") | .value // \"0\"')\nUNSAFE=$(cat $CBOM | jq -r '.metadata.properties[] | select(.name == \"cbom:pqc:unsafe_count\") | .value // \"0\"')\n\nprintf \"%-20s %10s%%\\n\" \"Readiness Score:\" \"$SCORE\"\nprintf \"%-20s %10s\\n\" \"PQC Safe:\" \"$SAFE\"\nprintf \"%-20s %10s\\n\" \"Transitional:\" \"$TRANS\"\nprintf \"%-20s %10s\\n\" \"Deprecated:\" \"$DEPR\"\nprintf \"%-20s %10s\\n\" \"Unsafe:\" \"$UNSAFE\"\necho \"\"\necho \"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\"\n</code></pre>"},{"location":"cbom-generator/advanced/generating-reports/#certificate-expiration-report","title":"Certificate Expiration Report","text":"<pre><code>#!/bin/bash\n# cert-expiration-report.sh &lt;cbom.json&gt;\n\nCBOM=$1\n\necho \"CERTIFICATE EXPIRATION REPORT\"\necho \"=============================\"\necho \"\"\n\n# Expired\necho \"EXPIRED CERTIFICATES\"\necho \"--------------------\"\ncat $CBOM | jq -r '.components[] |\n    select(.cryptoProperties?.certificateProperties?.certificateState[0]?.state == \"deactivated\") |\n    \"  - \\(.name)\"'\necho \"\"\n\n# Expiring within 30 days\necho \"EXPIRING WITHIN 30 DAYS\"\necho \"-----------------------\"\nEXPIRE_30=$(date -d \"+30 days\" --iso-8601)\ncat $CBOM | jq -r --arg exp \"$EXPIRE_30\" '.components[] |\n    select(.cryptoProperties?.certificateProperties?.notValidAfter &lt; $exp) |\n    select(.cryptoProperties?.certificateProperties?.certificateState[0]?.state == \"active\") |\n    \"  - \\(.name) (expires: \\(.cryptoProperties.certificateProperties.notValidAfter))\"'\necho \"\"\n\n# Expiring within 90 days\necho \"EXPIRING WITHIN 90 DAYS\"\necho \"-----------------------\"\nEXPIRE_90=$(date -d \"+90 days\" --iso-8601)\ncat $CBOM | jq -r --arg exp30 \"$EXPIRE_30\" --arg exp90 \"$EXPIRE_90\" '.components[] |\n    select(.cryptoProperties?.certificateProperties?.notValidAfter &gt; $exp30) |\n    select(.cryptoProperties?.certificateProperties?.notValidAfter &lt; $exp90) |\n    select(.cryptoProperties?.certificateProperties != null) |\n    \"  - \\(.name) (expires: \\(.cryptoProperties.certificateProperties.notValidAfter))\"'\n</code></pre>"},{"location":"cbom-generator/advanced/generating-reports/#weak-algorithm-report","title":"Weak Algorithm Report","text":"<pre><code>#!/bin/bash\n# weak-algorithm-report.sh &lt;cbom.json&gt;\n\nCBOM=$1\n\necho \"WEAK ALGORITHM DETECTION REPORT\"\necho \"================================\"\necho \"\"\n\necho \"DEPRECATED ALGORITHMS\"\necho \"---------------------\"\ncat $CBOM | jq -r '.components[] |\n    select(.properties[]? | select(.name == \"cbom:pqc:status\" and .value == \"DEPRECATED\")) |\n    \"  - \\(.name)\"'\necho \"\"\n\necho \"WEAK KEYS\"\necho \"---------\"\ncat $CBOM | jq -r '.components[] |\n    select(.properties[]? | select(.name == \"cbom:key:is_weak\" and .value == \"true\")) |\n    \"  - \\(.name) (\\(.evidence.occurrences[0].location // \"N/A\"))\"'\necho \"\"\n\necho \"OLD SECURITY PROFILES\"\necho \"---------------------\"\ncat $CBOM | jq -r '.components[] |\n    select(.properties[]? | select(.name == \"cbom:proto:security_profile\" and .value == \"OLD\")) |\n    \"  - \\(.name)\"'\n</code></pre>"},{"location":"cbom-generator/advanced/generating-reports/#html-report-generation","title":"HTML Report Generation","text":"<pre><code>#!/bin/bash\n# html-report.sh &lt;cbom.json&gt; &lt;output.html&gt;\n\nCBOM=$1\nOUTPUT=$2\n\nTOTAL=$(cat $CBOM | jq '.components | length')\nSCORE=$(cat $CBOM | jq -r '.metadata.properties[] | select(.name == \"cbom:pqc:readiness_score\") | .value // \"N/A\"')\nTIMESTAMP=$(cat $CBOM | jq -r '.metadata.timestamp')\n\ncat &gt; $OUTPUT &lt;&lt; EOF\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;CBOM Report&lt;/title&gt;\n    &lt;style&gt;\n        body { font-family: Arial, sans-serif; margin: 40px; }\n        h1 { color: #333; }\n        .metric { display: inline-block; padding: 20px; margin: 10px; background: #f5f5f5; border-radius: 5px; }\n        .metric .value { font-size: 36px; font-weight: bold; }\n        .metric .label { color: #666; }\n        table { border-collapse: collapse; width: 100%; margin-top: 20px; }\n        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n        th { background: #333; color: white; }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;Cryptographic Bill of Materials Report&lt;/h1&gt;\n    &lt;p&gt;Generated: $TIMESTAMP&lt;/p&gt;\n\n    &lt;div class=\"metric\"&gt;\n        &lt;div class=\"value\"&gt;$TOTAL&lt;/div&gt;\n        &lt;div class=\"label\"&gt;Components&lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div class=\"metric\"&gt;\n        &lt;div class=\"value\"&gt;$SCORE%&lt;/div&gt;\n        &lt;div class=\"label\"&gt;PQC Readiness&lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;h2&gt;Components&lt;/h2&gt;\n    &lt;table&gt;\n        &lt;tr&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Type&lt;/th&gt;&lt;th&gt;PQC Status&lt;/th&gt;&lt;/tr&gt;\nEOF\n\ncat $CBOM | jq -r '.components[] | \"&lt;tr&gt;&lt;td&gt;\\(.name)&lt;/td&gt;&lt;td&gt;\\(.cryptoProperties?.assetType // .type)&lt;/td&gt;&lt;td&gt;\\([.properties[]? | select(.name == \"cbom:pqc:status\")][0].value // \"N/A\")&lt;/td&gt;&lt;/tr&gt;\"' &gt;&gt; $OUTPUT\n\ncat &gt;&gt; $OUTPUT &lt;&lt; EOF\n    &lt;/table&gt;\n&lt;/body&gt;\n&lt;/html&gt;\nEOF\n\necho \"Report generated: $OUTPUT\"\n</code></pre>"},{"location":"cbom-generator/advanced/generating-reports/#json-to-csv-conversion","title":"JSON to CSV Conversion","text":"<pre><code>#!/bin/bash\n# cbom-to-csv.sh &lt;cbom.json&gt; &lt;output.csv&gt;\n\nCBOM=$1\nOUTPUT=$2\n\necho \"name,type,asset_type,pqc_status,location\" &gt; $OUTPUT\n\ncat $CBOM | jq -r '.components[] |\n    [\n        .name,\n        .type,\n        (.cryptoProperties?.assetType // \"N/A\"),\n        ([.properties[]? | select(.name == \"cbom:pqc:status\")][0].value // \"N/A\"),\n        (.evidence.occurrences[0].location // \"N/A\")\n    ] | @csv' &gt;&gt; $OUTPUT\n\necho \"CSV exported: $OUTPUT\"\n</code></pre>"},{"location":"cbom-generator/cli-reference/","title":"CLI Reference","text":"<p>Complete command-line interface documentation for CBOM Generator.</p>"},{"location":"cbom-generator/cli-reference/#usage","title":"Usage","text":"<pre><code>./build/cbom-generator [OPTIONS] [PATHS...]\n</code></pre> <p>If no paths are specified, scans default system locations.</p>"},{"location":"cbom-generator/cli-reference/#option-categories","title":"Option Categories","text":"Category Description Output Options File output, format selection Privacy Options GDPR/CCPA compliance controls Display Options TUI, reports, error logging Performance Options Threading, determinism, cross-arch Deduplication Duplicate handling modes Service Discovery Plugin-based service detection Crypto Registry Library detection configuration Attestation SLSA provenance and signing"},{"location":"cbom-generator/cli-reference/#quick-reference","title":"Quick Reference","text":"<pre><code># Basic scan\n./build/cbom-generator --output cbom.json\n\n# Privacy-compliant scan\n./build/cbom-generator --no-personal-data --output cbom.json\n\n# Service discovery with plugins\n./build/cbom-generator --discover-services --plugin-dir plugins --output cbom.json\n\n# CycloneDX 1.7 with dependencies\n./build/cbom-generator --cyclonedx-spec 1.7 --output cbom.json\n\n# TUI mode with error logging\n./build/cbom-generator --tui --error-log errors.log --output cbom.json\n\n# Cross-architecture (Yocto/embedded)\n./build/cbom-generator --cross-arch --crypto-registry crypto-registry-yocto.yaml \\\n    --output rootfs-cbom.json /path/to/rootfs\n</code></pre>"},{"location":"cbom-generator/cli-reference/#common-combinations","title":"Common Combinations","text":""},{"location":"cbom-generator/cli-reference/#production-scan","title":"Production Scan","text":"<pre><code>./build/cbom-generator \\\n    --no-personal-data \\\n    --discover-services \\\n    --plugin-dir plugins \\\n    --dedup-mode safe \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --output production-cbom.json\n</code></pre>"},{"location":"cbom-generator/cli-reference/#compliance-audit","title":"Compliance Audit","text":"<pre><code>./build/cbom-generator \\\n    --no-personal-data \\\n    --no-network \\\n    --deterministic \\\n    --pqc-report pqc-migration.txt \\\n    --output audit-cbom.json\n</code></pre>"},{"location":"cbom-generator/cli-reference/#embeddedyocto-scan","title":"Embedded/Yocto Scan","text":"<pre><code>ROOTFS=/path/to/yocto/rootfs\n./build/cbom-generator \\\n    --cross-arch \\\n    --discover-services \\\n    --plugin-dir plugins/embedded \\\n    --crypto-registry crypto-registry-yocto.yaml \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --output yocto-cbom.json \\\n    $ROOTFS/usr/bin $ROOTFS/usr/sbin $ROOTFS/usr/lib $ROOTFS/etc\n</code></pre>"},{"location":"cbom-generator/cli-reference/attestation-options/","title":"Attestation Options","text":"<p>SLSA provenance and digital signature support for CBOM integrity.</p>"},{"location":"cbom-generator/cli-reference/attestation-options/#current-status-v10","title":"Current Status (v1.0)","text":"Feature Status SLSA v0.2 provenance metadata Implemented Cryptographic signing (DSSE/PGP) Deferred to v1.1 <p>What v1.0 Provides:</p> <p>The <code>metadata.provenance</code> block includes build attestation:</p> <pre><code>{\n  \"provenance\": {\n    \"git_commit\": \"abc123...\",\n    \"compiler\": \"GCC 11.4.0\",\n    \"openssl_version\": \"3.0.2\",\n    \"build_timestamp\": \"2025-11-09T15:00:00Z\",\n    \"build_type\": \"Release\"\n  }\n}\n</code></pre> <p>This allows build verification without cryptographic signatures.</p>"},{"location":"cbom-generator/cli-reference/attestation-options/#-enable-attestation","title":"<code>--enable-attestation</code>","text":"<p>Enable CBOM attestation with digital signature.</p> <p>Status: v1.0 accepts flag but skips signing; v1.1 will implement full DSSE/PGP signing.</p> <pre><code># Enable attestation (v1.0: metadata only, v1.1: with signature)\n./build/cbom-generator --enable-attestation --signing-key key.pem --output cbom.json\n</code></pre>"},{"location":"cbom-generator/cli-reference/attestation-options/#-signature-method-method","title":"<code>--signature-method METHOD</code>","text":"<p>Signature method selection.</p> <p>Values: <code>dsse</code> (default), <code>pgp</code></p> <p>Status: Planned for v1.1</p> <pre><code># DSSE envelope (v1.1)\n./build/cbom-generator --enable-attestation --signature-method=dsse --signing-key key.pem\n\n# PGP signature (v1.1)\n./build/cbom-generator --enable-attestation --signature-method=pgp --signing-key key.asc\n</code></pre>"},{"location":"cbom-generator/cli-reference/attestation-options/#-signing-key-path","title":"<code>--signing-key PATH</code>","text":"<p>Path to signing key file.</p> <p>Status: Planned for v1.1</p> <pre><code>./build/cbom-generator --enable-attestation --signing-key /path/to/key.pem --output cbom.json\n</code></pre>"},{"location":"cbom-generator/cli-reference/attestation-options/#slsa-provenance-fields","title":"SLSA Provenance Fields","text":"<p>The provenance metadata includes:</p> Field Description <code>git_commit</code> Git commit hash of the build <code>compiler</code> Compiler name and version <code>openssl_version</code> OpenSSL library version <code>build_timestamp</code> ISO-8601 build timestamp <code>build_type</code> Release or Debug"},{"location":"cbom-generator/cli-reference/attestation-options/#v11-planned-features","title":"v1.1 Planned Features","text":"<ul> <li>DSSE (Dead Simple Signing Envelope) support</li> <li>PGP signature support</li> <li>Key management integration</li> <li>Signature verification tooling</li> </ul> <p>See GitHub issues or ROADMAP.md for timeline.</p>"},{"location":"cbom-generator/cli-reference/crypto-registry/","title":"Crypto Registry Extension (v1.6)","text":"<p>Extensible crypto library registry via YAML configuration for detecting cryptographic libraries across different Linux distributions.</p>"},{"location":"cbom-generator/cli-reference/crypto-registry/#overview","title":"Overview","text":"<p>The Crypto Registry is a declarative catalog of cryptographic libraries, providers, and embedded crypto engines. By externalizing this knowledge into YAML, the CBOM Generator can correctly classify crypto libraries (OpenSSL, GnuTLS, wolfSSL, mbedTLS, etc.) and create accurate DEPENDS_ON relationships in CycloneDX output.</p> <p>Benefits:</p> <ul> <li>Support new distributions without code changes</li> <li>Detect custom/vendor-specific crypto libraries</li> <li>Platform-aware crypto visibility</li> <li>Instant adaptation via YAML updates</li> </ul>"},{"location":"cbom-generator/cli-reference/crypto-registry/#-crypto-registry-file","title":"<code>--crypto-registry FILE</code>","text":"<p>Load external crypto library registry from YAML file to extend built-in registry.</p> <p>How it works:</p> <ol> <li>Built-in Registry (Always Available): 5 crypto libraries</li> <li>YAML Extension (Optional): Additional libraries from external file</li> <li>Lookup Order: Built-in searched first, then YAML extensions</li> <li>Graceful Degradation: YAML failures are warnings, not errors</li> </ol> <pre><code># Standard scan (built-in registry only)\n./build/cbom-generator --output cbom.json\n\n# With Ubuntu/Debian registry extension\n./build/cbom-generator --crypto-registry crypto-registry-ubuntu.yaml --output cbom.json\n\n# With Yocto/embedded registry extension\n./build/cbom-generator --crypto-registry crypto-registry-yocto.yaml --output cbom.json\n\n# Invalid file (graceful degradation)\n./build/cbom-generator --crypto-registry /nonexistent.yaml --output cbom.json\n# Output: WARNING: Continuing with built-in crypto registry only.\n</code></pre>"},{"location":"cbom-generator/cli-reference/crypto-registry/#how-registry-works-in-scan-flow","title":"How Registry Works in Scan Flow","text":"<p>When scanning binaries, the CBOM Generator uses the registry to identify cryptographic dependencies:</p> <pre><code>1. Scanner finds ELF binary (e.g., /usr/sbin/nginx)\n2. Reads ELF dependencies via readelf -d \u2192 [libssl.so.3, libcrypto.so.3]\n3. Queries registry: find_crypto_lib_by_soname(\"libssl.so.3\")\n4. Registry returns: {id: \"openssl\", algorithms: [AES, RSA, ECDSA, ...]}\n5. Creates DEPENDS_ON relationship: nginx \u2192 openssl\n</code></pre> <p>Example: nginx with OpenSSL: <pre><code>Binary: /usr/sbin/nginx\n    \u2502\n    \u251c\u2500\u2500 readelf -d \u2192 NEEDED: libssl.so.3\n    \u2502                        libcrypto.so.3\n    \u2502\n    \u2514\u2500\u2500 Registry Lookup:\n        \u251c\u2500\u2500 libssl.so.3    \u2192 openssl (match!)\n        \u251c\u2500\u2500 libcrypto.so.3 \u2192 openssl (match!)\n\nResult: nginx DEPENDS_ON openssl\n</code></pre></p>"},{"location":"cbom-generator/cli-reference/crypto-registry/#built-in-crypto-libraries","title":"Built-in Crypto Libraries","text":"<p>The generator includes 5 built-in crypto libraries:</p> Library ID Description SONAME Patterns openssl OpenSSL TLS library libssl.so, libcrypto.so libgcrypt GnuPG crypto library libgcrypt.so libsodium NaCl crypto library libsodium.so nettle Low-level crypto library libnettle.so, libhogweed.so krb5 Kerberos crypto libgssapi_krb5.so, libkrb5.so <p>Built-in Embedded Apps (3):</p> <ul> <li><code>openssh_internal</code> - OpenSSH built-in crypto</li> <li><code>wireguard_internal</code> - WireGuard VPN crypto</li> <li><code>age_internal</code> - age encryption tool</li> </ul>"},{"location":"cbom-generator/cli-reference/crypto-registry/#available-registry-files","title":"Available Registry Files","text":"Registry Libraries Apps Target <code>crypto-registry-ubuntu.yaml</code> 16 7 Ubuntu, Debian, Raspberry Pi OS <code>registry/crypto-registry-yocto.yaml</code> 26 4 Yocto, Buildroot, embedded <code>registry/crypto-registry-openwrt.yaml</code> 6 7 OpenWrt, LEDE, routers <code>registry/crypto-registry-alpine.yaml</code> 8 7 Alpine, Docker containers"},{"location":"cbom-generator/cli-reference/crypto-registry/#yaml-registry-format","title":"YAML Registry Format","text":"<pre><code>version: 1  # Schema version (required)\n\ncrypto_libraries:\n  - id: boringssl                    # Unique identifier\n    pkg_patterns:                     # Package name patterns\n      - libboringssl\n      - boringssl\n    soname_patterns:                  # Shared library patterns\n      - libboringssl.so\n    algorithms:                       # Supported algorithms\n      - RSA\n      - ECDSA\n      - AES-GCM\n\nembedded_crypto_apps:\n  - provider_id: dropbear            # Unique provider ID\n    binary_names:                     # Binary name patterns\n      - dropbear\n      - dbclient\n    package_names:                    # Package name patterns\n      - dropbear\n    algorithms:                       # Supported algorithms\n      - aes128-ctr\n      - curve25519-sha256\n</code></pre> <p>Pattern Matching: All patterns use substring matching:</p> <ul> <li>Pattern <code>libssl.so</code> matches <code>libssl.so.3</code>, <code>libssl.so.1.1</code></li> <li>Pattern <code>openssl</code> matches <code>openssl-dev</code>, <code>libopenssl3</code></li> </ul>"},{"location":"cbom-generator/cli-reference/crypto-registry/#creating-custom-registries","title":"Creating Custom Registries","text":"<p>Step 1: Copy example file: <pre><code>cp crypto-registry-ubuntu.yaml my-registry.yaml\n</code></pre></p> <p>Step 2: Add your custom libraries: <pre><code>version: 1\n\ncrypto_libraries:\n  - id: my_custom_tls\n    pkg_patterns:\n      - my-tls-package\n    soname_patterns:\n      - libmytls.so\n    algorithms:\n      - RSA\n      - AES-GCM\n</code></pre></p> <p>Step 3: Validate: <pre><code>./build/cbom-generator --crypto-registry my-registry.yaml --help 2&gt;&amp;1 | grep -i \"loaded\"\n</code></pre></p> <p>Step 4: Verify detection: <pre><code>./build/cbom-generator --crypto-registry my-registry.yaml --output cbom.json\ncat cbom.json | jq '.components[] | select(.name | contains(\"my_custom_tls\"))'\n</code></pre></p>"},{"location":"cbom-generator/cli-reference/crypto-registry/#security-considerations","title":"Security Considerations","text":"<p>Soft Limits (prevent YAML bombs):</p> <ul> <li>Maximum 100 crypto libraries per YAML file</li> <li>Maximum 50 embedded apps per YAML file</li> <li>File size limited to 1MB</li> <li>Nesting depth limited to 32 levels</li> </ul> <p>Graceful Degradation:</p> <ul> <li>YAML parsing errors \u2192 warning + continue with built-in</li> <li>File not found \u2192 warning + continue with built-in</li> <li>Scanner never fails due to registry issues</li> </ul> <p>Thread Safety:</p> <ul> <li>Registry loaded once at startup</li> <li>Read-only after initialization</li> <li>No runtime reload (restart required for changes)</li> </ul>"},{"location":"cbom-generator/cli-reference/crypto-registry/#see-also","title":"See Also","text":"<ul> <li>Crypto Registry Guide</li> <li>Crypto Registry YAML Specification</li> </ul>"},{"location":"cbom-generator/cli-reference/deduplication-options/","title":"Deduplication Options","text":"<p>Control how duplicate cryptographic assets are handled.</p>"},{"location":"cbom-generator/cli-reference/deduplication-options/#-dedup-mode-mode","title":"<code>--dedup-mode MODE</code>","text":"<p>Control duplicate asset handling.</p> <p>Values:</p> Mode Description <code>off</code> No deduplication (legacy behavior) <code>safe</code> Deduplicate certificates, keys, OpenPGP (default, recommended) <code>strict</code> Safe mode + bundle modeling + relationship pruning <pre><code># Safe deduplication (default)\n./build/cbom-generator --dedup-mode=safe --output cbom.json\n\n# No deduplication (all files reported separately)\n./build/cbom-generator --dedup-mode=off --output cbom.json\n\n# Strict deduplication with bundle modeling\n./build/cbom-generator --dedup-mode=strict --emit-bundles --output cbom.json\n</code></pre> <p>Deduplication Behavior:</p>"},{"location":"cbom-generator/cli-reference/deduplication-options/#safe-mode-default","title":"Safe Mode (Default)","text":"<p>Same certificate found in multiple locations becomes a single component with multiple evidence entries:</p> <pre><code>{\n  \"name\": \"DigiCert Global Root CA\",\n  \"evidence\": {\n    \"occurrences\": [\n      {\"location\": \"/etc/ssl/certs/DigiCert_Global_Root_CA.pem\"},\n      {\"location\": \"/usr/share/ca-certificates/DigiCert_Global_Root_CA.crt\"}\n    ]\n  }\n}\n</code></pre>"},{"location":"cbom-generator/cli-reference/deduplication-options/#strict-mode","title":"Strict Mode","text":"<p>Bundles similar components (e.g., all system CA certificates become a single bundle).</p>"},{"location":"cbom-generator/cli-reference/deduplication-options/#-emit-bundles","title":"<code>--emit-bundles</code>","text":"<p>Emit bundle components when using <code>--dedup-mode=strict</code>.</p> <pre><code># Strict mode with bundles\n./build/cbom-generator --dedup-mode=strict --emit-bundles --output cbom.json\n</code></pre> <p>Bundle Example:</p> <pre><code>{\n  \"type\": \"cryptographic-asset\",\n  \"name\": \"System CA Bundle\",\n  \"description\": \"System root certificate authority bundle\",\n  \"components\": [\n    {\"ref\": \"cert-digicert-global-root-ca\"},\n    {\"ref\": \"cert-isrg-root-x1\"},\n    {\"ref\": \"cert-globalsign-root-ca\"}\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/cli-reference/deduplication-options/#choosing-a-mode","title":"Choosing a Mode","text":"Use Case Recommended Mode General scanning <code>safe</code> (default) Compliance audits <code>safe</code> Debugging/investigation <code>off</code> Large enterprise scans <code>strict --emit-bundles</code> Minimal output size <code>strict --emit-bundles</code> <p>Note: Safe mode provides the best balance of accuracy and readability for most use cases.</p>"},{"location":"cbom-generator/cli-reference/display-options/","title":"Display Options","text":"<p>Control visual output and reporting.</p>"},{"location":"cbom-generator/cli-reference/display-options/#-tui","title":"<code>--tui</code>","text":"<p>Enable Terminal User Interface with real-time progress display.</p> <p>Features:</p> <ul> <li>Real-time progress bars for each scanner</li> <li>Live file counters and asset discovery counts</li> <li>Current directory being scanned</li> <li>Estimated completion percentage</li> <li>Asset breakdown by type (certs, keys, algorithms, libraries, protocols, services, cipher suites)</li> <li>Clean exit summary with PQC assessment</li> </ul> <pre><code># Enable TUI mode\n./build/cbom-generator --tui --output cbom.json\n\n# TUI with specific directory\n./build/cbom-generator --tui /etc/ssl\n\n# TUI with multiple paths\n./build/cbom-generator --tui --output cbom.json /etc/ssl /etc/pki /usr/share\n</code></pre> <p>Display Layout: <pre><code>+- CBOM Generator ------------------------- CipherIQ v1.0.0 -+\n| Progress: [####################] 100%      Time: 00:00:03 |\n+- Scanning Progress ------------------------------------------+\n| [X] Certificate Scanner  215000 files   152 certs         |\n| [X] Key Scanner         216000 files     0 keys           |\n| [X] Package Scanner     System-wide      0 pkgs           |\n| [X] Service Scanner     System-wide      0 svcs           |\n| [X] Filesystem Scanner  164000 files  3689 files          |\n| [X] Output Generation   System-wide      1 output         |\n+- Status ----------------------------------------------------|\n| Total Assets: 289 (193 certs, 16 keys, 14 algos, ...)     |\n| COMPLETE                                                   |\n+--------------------------------- Graziano Labs Corp. -+\n  Press any key to exit\n</code></pre></p> <p>Use when:</p> <ul> <li>Interactive scans where you want to monitor progress</li> <li>Large directory scans (prevents \"hanging\" appearance)</li> <li>Demonstrations or presentations</li> <li>Real-time visibility into scanning status</li> </ul> <p>Note on Error Visibility: In TUI mode, stderr is suppressed to prevent display corruption. Use <code>--error-log</code> to capture errors.</p>"},{"location":"cbom-generator/cli-reference/display-options/#-pqc-report-file-v12","title":"<code>--pqc-report FILE</code> (v1.2+)","text":"<p>Generate comprehensive PQC migration report in human-readable text format.</p> <p>Features:</p> <ul> <li>Executive summary with vulnerability breakdown</li> <li>Assets grouped by break year (2030/2035/2040/2045)</li> <li>Migration timeline with phased approach (2024-2045)</li> <li>NIST standards reference (FIPS 203/204/205)</li> <li>Prioritized recommendations and action items</li> <li>Risk assessment matrix</li> <li>Compliance guidance (NSA CNSA 2.0, FIPS 140-3)</li> </ul> <pre><code># Generate CBOM + PQC migration report\n./build/cbom-generator /etc/ssl/certs \\\n    --output cbom.json \\\n    --pqc-report migration-report.txt\n\n# View migration priorities\ncat migration-report.txt\n\n# TUI mode with PQC report\n./build/cbom-generator --tui \\\n    --output cbom.json \\\n    --pqc-report pqc-report.txt\n</code></pre> <p>Sample Report Output: <pre><code>\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n       POST-QUANTUM CRYPTOGRAPHY MIGRATION REPORT\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nEXECUTIVE SUMMARY\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nTotal Cryptographic Assets: 351\nPQC-Safe Assets: 1 (0.3%)\nQuantum-Vulnerable Assets: 199 (56.7%)\n\nVULNERABILITY BREAKDOWN BY BREAK YEAR\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nCRITICAL (Break by 2030):    119 assets  [IMMEDIATE ACTION]\nHIGH (Break by 2035):         64 assets  [PLAN MIGRATION NOW]\nMEDIUM (Break by 2040):        0 assets  [MONITOR CLOSELY]\nLOW (Break by 2045+):          0 assets  [LONG-TERM PLAN]\n</code></pre></p> <p>Use Cases:</p> <ul> <li>Executive briefings on quantum readiness</li> <li>Migration planning with timelines</li> <li>Compliance reporting (NSA CNSA 2.0 deadline tracking)</li> <li>Risk assessment and prioritization</li> </ul>"},{"location":"cbom-generator/cli-reference/display-options/#-error-log-file","title":"<code>--error-log FILE</code>","text":"<p>Write errors to a log file with timestamps (especially useful with <code>--tui</code>).</p> <p>Problem Solved: In TUI mode, stderr output is suppressed to prevent display corruption. Without <code>--error-log</code>, errors are only visible in the final JSON output.</p> <p>Features:</p> <ul> <li>ISO-8601 timestamps: <code>[YYYY-MM-DD HH:MM:SS]</code></li> <li>Severity levels: <code>[error]</code>, <code>[warning]</code></li> <li>Component name and detailed error message</li> <li>Immediate write with <code>fflush()</code> for real-time visibility</li> <li>Thread-safe operation</li> </ul> <pre><code># TUI mode with error logging (recommended)\n./build/cbom-generator --tui --error-log /tmp/cbom-errors.log --output cbom.json\n\n# Monitor errors in real-time (separate terminal)\ntail -f /tmp/cbom-errors.log\n\n# Normal mode with error logging\n./build/cbom-generator --error-log /tmp/cbom-errors.log --output cbom.json\n</code></pre> <p>Error Log Format: <pre><code>[2025-11-15 14:33:01] [error] certificate_scanner: Certificate parsing failed: MEMORY_ERROR\n[2025-11-15 14:33:02] [warning] key_scanner: Permission denied: /root/.ssh/id_rsa\n</code></pre></p> <p>Real-Time Monitoring: <pre><code># Start scan in one terminal\n./build/cbom-generator --tui --error-log /tmp/errors.log --output cbom.json\n\n# Monitor errors in another terminal\ntail -f /tmp/errors.log\n</code></pre></p>"},{"location":"cbom-generator/cli-reference/output-options/","title":"Output Options","text":"<p>Control where and how CBOM output is generated.</p>"},{"location":"cbom-generator/cli-reference/output-options/#-o-output-file","title":"<code>-o, --output FILE</code>","text":"<p>Specify output file path (default: stdout).</p> <pre><code># Write to file\n./build/cbom-generator --output /tmp/cbom.json\n\n# Write to stdout (default)\n./build/cbom-generator &gt; cbom.json\n</code></pre>"},{"location":"cbom-generator/cli-reference/output-options/#-f-format-format","title":"<code>-f, --format FORMAT</code>","text":"<p>Output format selection.</p> <p>Values: <code>json</code>, <code>cyclonedx</code> (both produce identical CycloneDX output)</p> <p>Note: This flag is accepted for backward compatibility but has no effect. The generator always outputs CycloneDX format regardless of this flag's value.</p> <pre><code># All of these produce identical CycloneDX output:\n./build/cbom-generator --output cbom.json\n./build/cbom-generator --format json --output cbom.json\n./build/cbom-generator --format cyclonedx --output cbom.json\n</code></pre>"},{"location":"cbom-generator/cli-reference/output-options/#-cyclonedx-spec-version","title":"<code>--cyclonedx-spec VERSION</code>","text":"<p>CycloneDX specification version.</p> <p>Values: <code>1.6</code> (default), <code>1.7</code></p> <pre><code># CycloneDX 1.6 (default, maximum compatibility)\n./build/cbom-generator --output cbom.json\n\n# CycloneDX 1.7 (latest spec with dependencies array)\n./build/cbom-generator --cyclonedx-spec=1.7 --output cbom.json\n</code></pre> <p>Note: Both versions produce similar content. Key differences:</p> Feature 1.6 1.7 <code>specVersion</code> field <code>\"1.6\"</code> <code>\"1.7\"</code> Dependencies array Supported Enhanced Tool compatibility Wider Growing <p>Recommendation: Use <code>1.6</code> for maximum compatibility with existing tools. Use <code>1.7</code> when you need the full dependency graph.</p>"},{"location":"cbom-generator/cli-reference/performance-options/","title":"Performance Options","text":"<p>Control threading, determinism, and cross-architecture scanning.</p>"},{"location":"cbom-generator/cli-reference/performance-options/#-t-threads-n","title":"<code>-t, --threads N</code>","text":"<p>Number of worker threads for parallel scanner execution.</p> <p>Default: CPU count (auto-detected) - Parallel execution is enabled by default</p> <p>Range: 1 to 32 threads</p> <p>Default Behavior (when flag not specified):</p> <ul> <li>Automatically detects CPU count using <code>sysconf(_SC_NPROCESSORS_ONLN)</code></li> <li>Creates thread pool with detected CPU count</li> <li>Fallback: 4 threads if detection fails</li> </ul> <p>How it works:</p> <ul> <li>Creates thread pool with N worker threads</li> <li>Runs all 5 scanners in parallel (certificate, key, package, service, filesystem)</li> <li>Utilizes available CPU cores efficiently</li> <li>Thread-safe operations on shared asset store (mutex-protected)</li> </ul> <pre><code># Use 8 threads (parallel)\n./build/cbom-generator --threads 8 --output cbom.json\n\n# Single-threaded (sequential fallback)\n./build/cbom-generator --threads 1 --output cbom.json\n\n# Maximum parallelism (default: CPU count)\n./build/cbom-generator --output cbom.json\n</code></pre> <p>Performance (measured on /etc/ssl with 294 certificates):</p> Mode Time Speedup Sequential (--threads 1) 0.36s baseline Parallel (--threads 4) 0.22s 1.64x faster <p>Note: Speedup varies by workload. Best results on systems with 4+ cores scanning large directories.</p>"},{"location":"cbom-generator/cli-reference/performance-options/#-d-deterministic-default-on","title":"<code>-d, --deterministic</code> (Default: ON)","text":"<p>Enable deterministic output (same input produces identical hash).</p> <pre><code># Deterministic mode (default)\n./build/cbom-generator --deterministic --output cbom.json\n\n# Disable determinism (includes timestamps)\n./build/cbom-generator --no-deterministic --output cbom.json\n</code></pre> <p>Use deterministic mode when:</p> <ul> <li>Comparing CBOMs across time</li> <li>CI/CD pipelines</li> <li>Change detection</li> <li>Reproducible builds</li> </ul>"},{"location":"cbom-generator/cli-reference/performance-options/#-cross-arch-v17","title":"<code>--cross-arch</code> (v1.7+)","text":"<p>Enable cross-architecture scanning mode for embedded/Yocto systems.</p> <p>This is the canonical way to scan cross-compiled rootfs images (e.g., ARM64 Yocto builds from an x86_64 development host).</p> <p>What it does:</p> <ol> <li>Disables Host Package Manager: Skips dpkg/rpm queries that would return incorrect host packages</li> <li>Uses VERNEED/SONAME Version Detection: Extracts versions directly from ELF binaries</li> <li>Enables Embedded Service Detection: Works with <code>--plugin-dir plugins/embedded</code></li> </ol> <p>Version Resolution (without manifest):</p> Tier Source Confidence Example Tier 3 ELF VERNEED 0.80 <code>OPENSSL_3.0.0</code> \u2192 <code>3.0.0</code> Tier 4 SONAME parsing 0.60 <code>libssl.so.3</code> \u2192 <code>3</code> <p>Canonical Usage (Yocto Development System):</p> <pre><code># Define the rootfs path in your Yocto build directory\nROOTFS=/mnt/yocto-builds/yocto-cbom/poky/build-qemu/tmp/work/qemuarm64-poky-linux/core-image-minimal/1.0/rootfs\n\n# Scan cross-compiled ARM64 rootfs from x86_64 host\n./build/cbom-generator \\\n    --cross-arch \\\n    --discover-services \\\n    --plugin-dir plugins/embedded \\\n    --crypto-registry crypto-registry-yocto.yaml \\\n    --format cyclonedx --cyclonedx-spec=1.7 \\\n    -o yocto-cbom.json \\\n    $ROOTFS/usr/bin $ROOTFS/usr/sbin $ROOTFS/usr/lib $ROOTFS/etc\n</code></pre> <p>Why scan binaries directly (not manifests)?</p> <p>Scanning the actual ELF binaries provides ground truth about what cryptographic libraries are actually linked:</p> <ul> <li>Runtime library substitutions</li> <li>Statically linked crypto</li> <li>Embedded crypto implementations</li> <li>Actual SONAME versions deployed</li> </ul> <p>What gets detected:</p> <ul> <li>Crypto libraries via SONAME (libssl.so.3, libgnutls.so.30, libcrypto.so.3)</li> <li>Embedded services (dropbear, wpa_supplicant, strongSwan, lighttpd)</li> <li>Application-to-library dependencies</li> <li>Certificates and keys in the rootfs</li> </ul> <p>Important Notes:</p> <ol> <li>Never use <code>--cross-arch</code> with host paths like <code>/usr/bin</code> - that's contradictory</li> <li>Use Yocto build directory paths - development systems have rootfs under <code>tmp/work/.../rootfs/</code></li> <li>Include multiple directories for comprehensive coverage</li> <li>Use embedded plugins (<code>plugins/embedded/</code>) for IoT/embedded services</li> <li>Use Yocto crypto registry (<code>crypto-registry-yocto.yaml</code>) for embedded library patterns</li> </ol> <p>See Also:</p> <ul> <li>Cross-Architecture Scanning Guide</li> <li>Yocto Testing Guide</li> </ul>"},{"location":"cbom-generator/cli-reference/privacy-options/","title":"Privacy Options","text":"<p>Control personal data handling for GDPR/CCPA compliance.</p>"},{"location":"cbom-generator/cli-reference/privacy-options/#-no-personal-data-default-on","title":"<code>--no-personal-data</code> (Default: ON)","text":"<p>Redact personal data for GDPR/CCPA compliance.</p> <p>What is redacted:</p> Data Type Original Redacted Hostnames <code>myserver.example.com</code> <code>&lt;host-hash-XXXXXXXX&gt;</code> Home directories <code>/home/alice/.ssh</code> <code>&lt;path-hash-XXXXXXXX&gt;</code> Usernames <code>alice</code> salted hashes <pre><code># Privacy mode (default)\n./build/cbom-generator --no-personal-data --output cbom.json\n\n# Explicitly enable (same as default)\n./build/cbom-generator --no-personal-data --output cbom.json\n</code></pre>"},{"location":"cbom-generator/cli-reference/privacy-options/#-include-personal-data","title":"<code>--include-personal-data</code>","text":"<p>Include hostnames, usernames, full file paths, and scan user SSH configurations.</p> <p>What this enables:</p> <ul> <li>Hostnames in metadata (instead of <code>&lt;host-hash-XXXXXXXX&gt;</code>)</li> <li>Usernames in file paths (instead of <code>&lt;user-username&gt;</code>)</li> <li>Full home directory paths (instead of <code>&lt;path-hash-XXXXXXXX&gt;</code>)</li> <li>User SSH config scanning (~/.ssh/config for all users in /home/*)</li> </ul> <p>Use when: Internal scans, debugging, or when GDPR/CCPA doesn't apply.</p> <pre><code># Include all personal data + user SSH configs\n./build/cbom-generator --include-personal-data --output cbom-full.json\n</code></pre> <p>Warning: Output may contain sensitive information. Use appropriate access controls.</p> <p>Note: User SSH config scanning is privacy-sensitive because it:</p> <ul> <li>Accesses user home directories</li> <li>Reveals individual user cryptographic preferences</li> <li>May expose non-public KEX algorithm choices</li> </ul>"},{"location":"cbom-generator/cli-reference/privacy-options/#-no-network","title":"<code>--no-network</code>","text":"<p>Disable network operations.</p> <p>Status: This flag is accepted and recorded in output metadata, but has no functional effect in v1.0 because network operations are not yet implemented.</p> <p>Planned for v1.1+:</p> <ul> <li>OCSP (Online Certificate Status Protocol) validation</li> <li>CRL (Certificate Revocation List) checking</li> <li>Remote NIST CMVP certification database queries</li> <li>Network-based trust validation</li> </ul> <p>Current behavior: Flag is stored in metadata and sets <code>revocation_policy</code> to \"disabled\" vs \"cache-only\" in output, but no actual network operations occur regardless of flag value.</p> <pre><code># Flag accepted but has no effect in v1.0\n./build/cbom-generator --no-network --output cbom.json\n\n# Combine with privacy mode (both metadata-only in v1.0)\n./build/cbom-generator --no-personal-data --no-network --output cbom.json\n</code></pre>"},{"location":"cbom-generator/cli-reference/service-discovery/","title":"Service Discovery Options (v1.3)","text":"<p>YAML plugin-driven service discovery for detecting running services and extracting their cryptographic configurations.</p>"},{"location":"cbom-generator/cli-reference/service-discovery/#-discover-services","title":"<code>--discover-services</code>","text":"<p>Enable YAML plugin-driven service discovery pipeline.</p> <p>What it does:</p> <ol> <li>Phase 1: Loads YAML plugins from plugins/ directory</li> <li>Phase 2: Discovers running services via process, port, config file, systemd, and package detection</li> <li>Phase 3: Extracts TLS/SSL configuration from each detected service</li> <li>Phase 4: Generates CycloneDX components with full crypto metadata and PQC assessment</li> </ol> <p>Supported Services (built-in plugins include):</p> <ul> <li>Databases: PostgreSQL, MySQL, MariaDB, MongoDB, Redis, CouchDB</li> <li>Web Servers: Nginx, Apache HTTPD, Caddy</li> <li>Message Queues: RabbitMQ, Apache Kafka</li> <li>VPN: OpenVPN, WireGuard</li> <li>SSH: OpenSSH</li> </ul> <pre><code># Discover all services and generate CBOM\n./build/cbom-generator --discover-services --output discovered.json\n\n# With privacy mode (recommended)\n./build/cbom-generator --discover-services --no-personal-data --output cbom.json\n\n# With custom plugin directory\n./build/cbom-generator --discover-services --plugin-dir /custom/plugins --output cbom.json\n</code></pre> <p>Output: <pre><code>INFO: Phase 1: Loading YAML plugins...\nINFO:   Loaded 13 YAML plugins from 'plugins/'\nINFO: Phase 2: Discovering services...\nINFO:   Discovered 3 service(s)\nINFO: Phase 3: Extracting crypto configurations...\nINFO:   Processing service: PostgreSQL SSL/TLS Scanner\nINFO:     Certificates: 1, Keys: 1, TLS: yes\nINFO:     Components generated successfully\nINFO: Extracted configs for 3/3 services\nINFO: Phase 4.5 pipeline complete\n</code></pre></p> <p>Detection Methods:</p> Method How It Works Process Scans /proc for process names and command patterns Port Checks listening ports with optional TLS handshake probe Config File Glob pattern matching for config file presence Systemd Queries systemd for active services Package Checks if service packages are installed <p>Component Generation:</p> <ul> <li>Creates SERVICE components for each discovered service</li> <li>Creates CERTIFICATE components from extracted cert paths</li> <li>Creates PROTOCOL components (TLS 1.2, TLS 1.3, SSH)</li> <li>Creates CIPHER_SUITE components from config</li> <li>Builds relationship graph: SERVICE\u2192CERT\u2192PROTOCOL\u2192CIPHER</li> </ul>"},{"location":"cbom-generator/cli-reference/service-discovery/#-plugin-dir-dir","title":"<code>--plugin-dir DIR</code>","text":"<p>Specify custom directory for YAML plugins.</p> <p>Default: <code>plugins/</code> (relative to current directory)</p> <pre><code># Use custom plugin directory\n./build/cbom-generator --discover-services --plugin-dir /etc/cbom/plugins\n\n# Use absolute path\n./build/cbom-generator --discover-services --plugin-dir /opt/cbom-plugins\n\n# Use embedded plugins for Yocto/IoT\n./build/cbom-generator --discover-services --plugin-dir plugins/embedded\n</code></pre> <p>Plugin File Format: YAML files (.yaml or .yml extension)</p>"},{"location":"cbom-generator/cli-reference/service-discovery/#-list-plugins","title":"<code>--list-plugins</code>","text":"<p>List all loaded plugins and exit.</p> <pre><code># List all plugins\n./build/cbom-generator --list-plugins\n\n# List plugins from custom directory\n./build/cbom-generator --list-plugins --plugin-dir /custom/plugins\n</code></pre> <p>Output: <pre><code>Loaded 13 YAML plugins from 'plugins/'\n\n=== CBOM Generator Plugins ===\n\nBuilt-in Scanners (5):\n  1. builtin_cert_scanner v1.0.0 - Certificate Scanner\n  2. builtin_key_scanner v1.0.0 - Key Scanner\n  3. builtin_package_scanner v1.0.0 - Package Scanner\n  4. builtin_service_scanner v1.0.0 - Service Scanner\n  5. builtin_fs_scanner v1.0.0 - Filesystem Scanner\n\nYAML Plugins (13 loaded)\n\nTotal: 18 plugins (5 built-in + 13 YAML)\n</code></pre></p>"},{"location":"cbom-generator/cli-reference/service-discovery/#creating-custom-plugins","title":"Creating Custom Plugins","text":"<p>YAML Plugin Structure:</p> <pre><code># plugins/myservice.yaml\nplugin:\n  plugin_schema_version: \"1.0\"\n  name: \"My Service TLS Scanner\"\n  version: \"1.0.0\"\n  category: \"custom\"\n  description: \"Detects My Service and extracts TLS config\"\n\ndetection:\n  methods:\n    - type: process\n      names: [\"myservice\"]\n    - type: port\n      ports: [8443]\n      check_ssl: true\n\nconfig_extraction:\n  files:\n    - path: \"/etc/myservice/config.yaml\"\n      parser: \"yaml\"\n      crypto_directives:\n        - key: \"tls.cert\"\n          type: \"path\"\n          maps_to: \"certificate.path\"\n</code></pre> <p>Supported Parsers:</p> Parser Use For <code>ini</code> INI/properties format (PostgreSQL, MySQL, Redis) <code>apache</code> Apache HTTPD config format <code>nginx</code> Nginx config format <code>yaml</code> YAML format (MongoDB, Kubernetes) <code>json</code> JSON format (Caddy, modern apps) <code>openssl_cipher</code> OpenSSL cipher string expansion <p>See Also: Plugin Development Guide</p>"},{"location":"cbom-generator/features/","title":"Features","text":"<p>CBOM Generator provides comprehensive cryptographic asset discovery and analysis capabilities.</p>"},{"location":"cbom-generator/features/#core-features","title":"Core Features","text":"Feature Description Asset Discovery 8 built-in scanners for comprehensive crypto detection Key Material Detection Multi-format key discovery with security analysis Service Dependencies 4-level dependency graph (SERVICE\u2192PROTOCOL\u2192SUITE\u2192ALGO) Protocol Properties TLS/SSH/IPsec protocol analysis PQC Assessment Post-Quantum Cryptography readiness scoring Relationship Graph Complete dependency tracking Privacy Controls GDPR/CCPA-compliant redaction Deduplication Intelligent duplicate handling"},{"location":"cbom-generator/features/#scanner-overview","title":"Scanner Overview","text":"<p>CBOM Generator includes 8 scanner types:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    CBOM Generator                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Scanners                                                    \u2502\n\u2502  \u251c\u2500\u2500 Certificate Scanner (X.509, OpenPGP)                   \u2502\n\u2502  \u251c\u2500\u2500 Key Scanner (RSA, ECDSA, Ed25519, DSA, DH)            \u2502\n\u2502  \u251c\u2500\u2500 Package Scanner (APT, RPM, pip, npm)                   \u2502\n\u2502  \u251c\u2500\u2500 Service Scanner (Apache, Nginx, OpenSSH)               \u2502\n\u2502  \u251c\u2500\u2500 Filesystem Scanner (crypto-related files)              \u2502\n\u2502  \u251c\u2500\u2500 Application Scanner (binary dependency analysis)       \u2502\n\u2502  \u251c\u2500\u2500 Library Scanner (crypto library detection)             \u2502\n\u2502  \u2514\u2500\u2500 Algorithm Detection (derived from all sources)         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"cbom-generator/features/#component-types","title":"Component Types","text":"Type Description Example Certificate X.509 and OpenPGP certificates CA root certs, server certs Key Private/public key material RSA-2048, Ed25519 keys Algorithm Cryptographic primitives AES-256-GCM, SHA-384 Library Crypto libraries OpenSSL, libgcrypt Protocol Communication protocols TLS 1.3, SSH 2.0 Service Network services nginx, sshd, postgres Cipher Suite Protocol cipher suites TLS_AES_256_GCM_SHA384 Application Crypto-using applications curl, git, openssl"},{"location":"cbom-generator/features/#relationship-types","title":"Relationship Types","text":"<p>The scanner builds a complete dependency graph:</p> <pre><code>APPLICATION\n    \u2514\u2500\u2500 DEPENDS_ON \u2192 LIBRARY\n                         \u2514\u2500\u2500 PROVIDES \u2192 ALGORITHM\n\nSERVICE\n    \u2514\u2500\u2500 USES \u2192 PROTOCOL\n                   \u2514\u2500\u2500 PROVIDES \u2192 CIPHER_SUITE\n                                      \u2514\u2500\u2500 USES \u2192 ALGORITHM\n\nCERTIFICATE\n    \u2514\u2500\u2500 USES \u2192 ALGORITHM (signature)\n    \u2514\u2500\u2500 USES \u2192 ALGORITHM (public key)\n</code></pre>"},{"location":"cbom-generator/features/#supported-formats","title":"Supported Formats","text":"<p>Input: PEM, DER, PKCS#12, PKCS#8, OpenSSH, ELF binaries</p> <p>Output: CycloneDX 1.6/1.7 JSON</p>"},{"location":"cbom-generator/features/asset-discovery/","title":"Asset Discovery","text":"<p>The CBOM Generator includes 8 scanner types that discover cryptographic assets across your system.</p>"},{"location":"cbom-generator/features/asset-discovery/#scanner-overview","title":"Scanner Overview","text":"Scanner Strategy What It Finds Certificate Every file X.509, OpenPGP certificates Key Every file RSA, ECDSA, Ed25519, DSA, DH keys Package System-wide Crypto libraries via package managers Service System-wide Network services using crypto Filesystem Filtered Crypto-related files by extension Application Binary analysis Applications with crypto dependencies Library Integrated Crypto libraries linked to apps Algorithm Derived Algorithms from all sources"},{"location":"cbom-generator/features/asset-discovery/#file-counts-vs-component-counts","title":"File Counts vs Component Counts","text":"<p>The TUI displays both file counts (files examined) and component counts (assets discovered). These differ significantly:</p> <p>Example (scanning /home with 4.23M files): <pre><code>Certificate Scanner: 4,122,000 files examined (97.4%)\nKey Scanner:         4,126,000 files examined (97.5%)\nFilesystem Scanner:  1,525,000 files examined (36% - crypto files only)\n</code></pre></p> <p>Why counts differ:</p> <ul> <li>Certificate/Key scanners examine EVERY file (comprehensive search)</li> <li>Filesystem scanner pre-filters by extension (efficient search)</li> <li>Both strategies are correct for their use cases</li> </ul>"},{"location":"cbom-generator/features/asset-discovery/#certificate-scanner","title":"Certificate Scanner","text":"<p>Discovers: X.509 and OpenPGP certificates</p> <p>Formats: PEM, DER, PKCS#12</p> <p>Information Extracted:</p> <ul> <li>Subject and issuer DNs (RFC2253 normalized)</li> <li>Validity periods (notValidBefore, notValidAfter)</li> <li>Signature algorithms with OIDs</li> <li>Public key algorithms and sizes</li> <li>Trust validation status (15 failure reasons tracked)</li> <li>Certificate state (active, expired, revoked)</li> <li>Extensions (KeyUsage, ExtendedKeyUsage, SubjectAltName)</li> </ul> <p>Deduplication Behavior:</p> <p>Certificate bundles (e.g., <code>ca-certificates.crt</code>) are processed first. Individual .pem files are often symlinks to certificates already in bundles, so they're skipped as duplicates. This is expected behavior.</p>"},{"location":"cbom-generator/features/asset-discovery/#key-scanner","title":"Key Scanner","text":"<p>Discovers: Private and public keys</p> <p>Formats: PEM, DER, OpenSSH, PKCS#8, PKCS#1, SEC1</p> <p>Key Types: RSA, ECDSA, Ed25519, Ed448, DSA, DH</p> <p>Security Features:</p> <ul> <li>CRITICAL: Only stores SHA-256 hashes, NEVER raw key material</li> <li>Detects storage security (plaintext, encrypted, HSM, TPM)</li> <li>Tracks key lifecycle states (NIST SP 800-57)</li> <li>Identifies weak keys (RSA &lt;2048, ECDSA &lt;256)</li> </ul>"},{"location":"cbom-generator/features/asset-discovery/#package-scanner","title":"Package Scanner","text":"<p>Discovers: Cryptographic libraries via package managers</p> <p>Package Managers: APT, RPM, Pacman, pip, npm, RubyGems</p> <p>How it works:</p> <ul> <li>Queries package manager databases (no file scanning)</li> <li>System-wide scope</li> <li>Detects OpenSSL, GnuTLS, libgcrypt, nettle, and 20+ more</li> </ul>"},{"location":"cbom-generator/features/asset-discovery/#service-scanner","title":"Service Scanner","text":"<p>Discovers: Network services using cryptography</p> <p>Services: Apache, Nginx, OpenSSH, Postfix (built-in) + 65+ via YAML plugins</p> <p>Analysis:</p> <ul> <li>Config file parsing (httpd.conf, nginx.conf, sshd_config)</li> <li>TLS/SSH protocol detection</li> <li>Cipher suite extraction</li> <li>Security profile classification (MODERN, INTERMEDIATE, OLD)</li> <li>Network endpoint mapping</li> </ul>"},{"location":"cbom-generator/features/asset-discovery/#application-scanner","title":"Application Scanner","text":"<p>Discovers: Applications with cryptographic dependencies</p> <p>Directories Scanned: <code>/usr/bin</code>, <code>/usr/sbin</code>, custom paths</p> <p>Discovery Process:</p> <ol> <li>ELF Validation: Checks executable permission and ELF magic bytes</li> <li>Library Extraction: Uses <code>readelf -d</code> (cross-arch compatible)</li> <li>Crypto Detection: Matches libraries against crypto registry</li> <li>Alternate Detection: Kernel crypto API, static linking, symbol analysis</li> </ol> <p>Role Classification:</p> Role Criteria Examples Service Located in <code>/sbin/</code>, ends with 'd', contains \"server\" sshd, nginx, dockerd Client Contains \"client\" ssh, curl, wget Utility Default openssl, gpg"},{"location":"cbom-generator/features/asset-discovery/#library-scanner","title":"Library Scanner","text":"<p>Discovers: Crypto libraries linked to applications</p> <p>Built-in Registry:</p> Library SONAME Patterns Algorithms OpenSSL libssl.so, libcrypto.so RSA, ECDSA, AES, ChaCha20 libgcrypt libgcrypt.so RSA, DSA, AES, Twofish libsodium libsodium.so X25519, Ed25519, ChaCha20 nettle libnettle.so, libhogweed.so RSA, ECDSA, AES Kerberos libkrb5.so, libgssapi_krb5.so AES, 3DES, RC4 liboqs liboqs.so ML-KEM, ML-DSA, Falcon, SPHINCS+"},{"location":"cbom-generator/features/asset-discovery/#algorithm-detection","title":"Algorithm Detection","text":"<p>Algorithms are derived components extracted from other assets:</p> <p>From Certificates: - Public Key Algorithm: RSA, ECDSA, Ed25519 - Signature Algorithm: sha256WithRSAEncryption, ecdsa-with-SHA256</p> <p>From Keys: - Key type and size: RSA-2048, ECDSA-P256</p> <p>From Cipher Suites: - Key Exchange: ECDHE, DHE - Authentication: RSA, ECDSA - Encryption: AES-256-GCM - MAC: SHA384</p> <p>From Libraries: - Algorithm capabilities from crypto registry</p>"},{"location":"cbom-generator/features/deduplication/","title":"Deduplication","text":"<p>Control how duplicate cryptographic assets are handled in the CBOM output.</p>"},{"location":"cbom-generator/features/deduplication/#deduplication-modes","title":"Deduplication Modes","text":"Mode Behavior Use Case OFF No deduplication Forensic analysis, exact file tracking SAFE Smart deduplication (default) Most production scans STRICT Aggressive with bundles Enterprise scans, minimal output"},{"location":"cbom-generator/features/deduplication/#off-mode","title":"OFF Mode","text":"<p>Legacy behavior with no deduplication:</p> <ul> <li>Same certificate found in 3 files \u2192 3 separate components</li> <li>Every occurrence is a distinct component</li> <li>Largest output size</li> </ul> <pre><code>./build/cbom-generator --dedup-mode=off --output cbom.json\n</code></pre> <p>Use when: - Forensic analysis requiring exact file locations - Debugging duplicate detection - Compliance requiring per-file tracking</p>"},{"location":"cbom-generator/features/deduplication/#safe-mode-default-recommended","title":"SAFE Mode (Default, Recommended)","text":"<p>Smart deduplication with evidence tracking:</p> <ul> <li>Same certificate in 3 files \u2192 1 component with 3 evidence occurrences</li> <li>Applies to: Certificates, keys, OpenPGP keys</li> <li>Preserves all location information</li> </ul> <pre><code>./build/cbom-generator --dedup-mode=safe --output cbom.json\n</code></pre> <p>Output example:</p> <pre><code>{\n  \"name\": \"DigiCert Global Root CA\",\n  \"bom-ref\": \"cert:digicert-global-root-ca-sha256:abc123\",\n  \"evidence\": {\n    \"occurrences\": [\n      {\"location\": \"/etc/ssl/certs/DigiCert_Global_Root_CA.pem\"},\n      {\"location\": \"/usr/share/ca-certificates/DigiCert_Global_Root_CA.crt\"},\n      {\"location\": \"/etc/pki/tls/certs/ca-bundle.crt\"}\n    ]\n  }\n}\n</code></pre> <p>Benefits: - Single component per unique certificate - All locations preserved in evidence - Balanced output size and detail</p>"},{"location":"cbom-generator/features/deduplication/#strict-mode","title":"STRICT Mode","text":"<p>Aggressive deduplication with bundle modeling:</p> <ul> <li>Safe mode features plus bundle grouping</li> <li>Groups similar components (e.g., all CA certs \u2192 single bundle)</li> <li>Smallest output size</li> </ul> <pre><code>./build/cbom-generator --dedup-mode=strict --emit-bundles --output cbom.json\n</code></pre> <p>Bundle example:</p> <pre><code>{\n  \"type\": \"cryptographic-asset\",\n  \"name\": \"System CA Bundle\",\n  \"description\": \"System root certificate authority bundle (147 certificates)\",\n  \"components\": [\n    {\"ref\": \"cert:digicert-global-root-ca\"},\n    {\"ref\": \"cert:isrg-root-x1\"},\n    {\"ref\": \"cert:globalsign-root-ca\"}\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/features/deduplication/#-emit-bundles-flag","title":"<code>--emit-bundles</code> Flag","text":"<p>Use with <code>--dedup-mode=strict</code> to create bundle components:</p> <pre><code>./build/cbom-generator --dedup-mode=strict --emit-bundles --output cbom.json\n</code></pre> <p>Without <code>--emit-bundles</code>: Strict mode applies aggressive deduplication but doesn't create explicit bundle components.</p>"},{"location":"cbom-generator/features/deduplication/#deduplication-statistics","title":"Deduplication Statistics","text":"<p>The CBOM includes deduplication metrics:</p> <pre><code>{\n  \"properties\": [\n    { \"name\": \"cbom:dedup:mode\", \"value\": \"safe\" },\n    { \"name\": \"cbom:dedup:total_candidates\", \"value\": \"1245\" },\n    { \"name\": \"cbom:dedup:unique_components\", \"value\": \"328\" },\n    { \"name\": \"cbom:dedup:duplicates_merged\", \"value\": \"917\" }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/features/deduplication/#choosing-a-mode","title":"Choosing a Mode","text":"Scenario Recommended Mode General production scanning <code>safe</code> (default) Compliance audit <code>safe</code> Security investigation <code>off</code> Large enterprise scan <code>strict --emit-bundles</code> Minimal output for CI/CD <code>strict --emit-bundles</code> Exact file tracking <code>off</code>"},{"location":"cbom-generator/features/deduplication/#how-deduplication-works","title":"How Deduplication Works","text":"<ol> <li>Content Hashing: SHA-256 hash of certificate/key content</li> <li>Identity Check: Same hash = same cryptographic asset</li> <li>Evidence Merging: All locations stored in evidence array</li> <li>First-Wins: First occurrence's metadata is preserved</li> </ol> <p>Example flow: <pre><code>/etc/ssl/certs/ca-certificates.crt  (contains 147 certs)\n    \u2193 Parse and hash each certificate\n/etc/ssl/certs/DigiCert.pem         (symlink to single cert)\n    \u2193 Hash matches cert #42 from bundle\n    \u2192 Merge: Add location to cert #42's evidence\n    \u2192 Skip: Don't create duplicate component\n</code></pre></p>"},{"location":"cbom-generator/features/key-material-detection/","title":"Key Material Detection","text":"<p>The Key Material Scanner provides comprehensive discovery and security analysis of cryptographic keys.</p>"},{"location":"cbom-generator/features/key-material-detection/#supported-key-types","title":"Supported Key Types","text":"Key Type Description Example Sizes RSA RSA asymmetric keys 1024, 2048, 3072, 4096 bits ECDSA Elliptic Curve DSA P-256, P-384, P-521 Ed25519 Edwards curve 25519 256 bits (fixed) Ed448 Edwards curve 448 448 bits (fixed) DSA Digital Signature Algorithm (legacy) 1024, 2048, 3072 bits DH Diffie-Hellman 2048, 3072, 4096 bits AES AES symmetric keys 128, 192, 256 bits ChaCha20 ChaCha20 stream cipher 256 bits HMAC HMAC keys Variable"},{"location":"cbom-generator/features/key-material-detection/#supported-formats","title":"Supported Formats","text":"<ul> <li>PEM: ASCII armor format with BEGIN/END markers</li> <li>DER: Binary Distinguished Encoding Rules</li> <li>OpenSSH: OpenSSH format (<code>ssh-rsa</code>, <code>ssh-ed25519</code>)</li> <li>PKCS#8: Private key information syntax</li> <li>PKCS#1: RSA private key format</li> <li>SEC1: EC private key format</li> <li>RAW: Raw key bytes</li> </ul>"},{"location":"cbom-generator/features/key-material-detection/#storage-security-detection","title":"Storage Security Detection","text":"<p>The scanner automatically detects how keys are protected:</p> Storage Type Description Security Level HSM Hardware Security Module Highest TPM Trusted Platform Module High Encrypted Password-protected Medium Keyring OS keyring/keychain Medium Plaintext Unencrypted file LOW RISK <p>Example Detection: <pre><code># Scan for unencrypted private keys\n./build/cbom-generator /etc/ssl/private --output cbom.json\ncat cbom.json | jq '.components[] |\n    select(.properties[]? |\n    select(.name == \"cbom:key:storage_security\" and .value == \"PLAINTEXT\")) |\n    .name'\n</code></pre></p>"},{"location":"cbom-generator/features/key-material-detection/#key-lifecycle-tracking-nist-sp-800-57","title":"Key Lifecycle Tracking (NIST SP 800-57)","text":"<p>Keys are classified by their lifecycle state:</p> State Description Pre-activation Generated but not yet in use Active Currently in use Suspended Temporarily disabled Deactivated No longer in use Compromised Known or suspected compromise Destroyed Securely deleted"},{"location":"cbom-generator/features/key-material-detection/#weakness-detection","title":"Weakness Detection","text":"<p>The scanner automatically identifies weak keys:</p> <ul> <li>RSA keys &lt; 2048 bits (NIST recommendation)</li> <li>ECDSA keys &lt; 256 bits (NIST recommendation)</li> <li>DSA keys (deprecated algorithm)</li> <li>DH keys &lt; 2048 bits</li> </ul>"},{"location":"cbom-generator/features/key-material-detection/#cyclonedx-properties","title":"CycloneDX Properties","text":"<p>Keys appear in the output with these properties:</p> <pre><code>{\n  \"type\": \"cryptographic-asset\",\n  \"name\": \"RSA-2048\",\n  \"bom-ref\": \"key:rsa-2048-sha256:a1b2c3d4\",\n  \"cryptoProperties\": {\n    \"assetType\": \"related-crypto-material\",\n    \"relatedCryptoMaterialProperties\": {\n      \"type\": \"private-key\",\n      \"state\": \"active\",\n      \"size\": 2048\n    }\n  },\n  \"properties\": [\n    { \"name\": \"cbom:key:type\", \"value\": \"RSA\" },\n    { \"name\": \"cbom:key:size\", \"value\": \"2048\" },\n    { \"name\": \"cbom:key:format\", \"value\": \"PEM\" },\n    { \"name\": \"cbom:key:classification\", \"value\": \"private\" },\n    { \"name\": \"cbom:key:storage_security\", \"value\": \"ENCRYPTED\" },\n    { \"name\": \"cbom:key:is_weak\", \"value\": \"false\" },\n    { \"name\": \"cbom:pqc:status\", \"value\": \"UNSAFE\" },\n    { \"name\": \"cbom:pqc:break_estimate\", \"value\": \"2035\" }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/features/key-material-detection/#common-use-cases","title":"Common Use Cases","text":""},{"location":"cbom-generator/features/key-material-detection/#finding-unencrypted-private-keys","title":"Finding Unencrypted Private Keys","text":"<pre><code>./build/cbom-generator /etc/ssl --output cbom.json\ncat cbom.json | jq -r '.components[] |\n    select(.cryptoProperties?.relatedCryptoMaterialProperties?.type == \"private-key\") |\n    select(.properties[]? | select(.name == \"cbom:key:storage_security\" and .value == \"PLAINTEXT\")) |\n    .evidence.occurrences[0].location'\n</code></pre>"},{"location":"cbom-generator/features/key-material-detection/#identifying-weak-keys","title":"Identifying Weak Keys","text":"<pre><code>./build/cbom-generator --output cbom.json\ncat cbom.json | jq '.components[] |\n    select(.properties[]? | select(.name == \"cbom:key:is_weak\" and .value == \"true\")) |\n    {name: .name, location: .evidence.occurrences[0].location}'\n</code></pre>"},{"location":"cbom-generator/features/key-material-detection/#hsm-inventory","title":"HSM Inventory","text":"<pre><code>./build/cbom-generator --output cbom.json\ncat cbom.json | jq -r '.components[] |\n    select(.properties[]? | select(.name == \"cbom:key:storage_security\" and .value == \"HSM\")) |\n    \"\\(.name) - \\(.evidence.occurrences[0].location)\"'\n</code></pre>"},{"location":"cbom-generator/features/key-material-detection/#security-note","title":"Security Note","text":"<p>The scanner NEVER stores raw key material. Only SHA-256 hashes of key content are stored for identification purposes.</p>"},{"location":"cbom-generator/features/pqc-assessment/","title":"PQC Readiness Assessment","text":"<p>Post-Quantum Cryptography (PQC) assessment analyzes your cryptographic assets for quantum computer vulnerability.</p>"},{"location":"cbom-generator/features/pqc-assessment/#safety-categories","title":"Safety Categories","text":"Category Meaning Examples Risk Level SAFE Post-quantum secure ML-KEM (Kyber), ML-DSA (Dilithium), SPHINCS+ Low TRANSITIONAL Classically strong, quantum-vulnerable RSA-2048+, ECDSA-P256+, AES-256, SHA-256 Medium-High DEPRECATED Broken/weak algorithms MD5, SHA-1, RC4, DES Critical UNSAFE Quantum-vulnerable + weak RSA-1024, DSA Critical"},{"location":"cbom-generator/features/pqc-assessment/#break-year-estimation","title":"Break Year Estimation","text":"<p>Each quantum-vulnerable algorithm includes an estimated break year based on NIST IR 8413 and NSA CNSA 2.0 guidance:</p> Algorithm Key Size Break Year Priority RSA-1024, MD5, SHA-1, RC4, DES - 2030 CRITICAL RSA-2048, ECDSA-P256, ECDH-P256 2048/256 bits 2035 HIGH RSA-3072, ECDSA-P384 3072/384 bits 2040 MEDIUM RSA-4096, ECDSA-P521 4096+/521 bits 2045 LOW"},{"location":"cbom-generator/features/pqc-assessment/#readiness-score","title":"Readiness Score","text":"<p>The PQC readiness score (0-100%) is calculated as:</p> <pre><code>score = (SAFE\u00d7100 + TRANSITIONAL\u00d750 + DEPRECATED\u00d70 + UNSAFE\u00d70) / total\n</code></pre> <p>Migration Recommendations:</p> Score Status Action &lt; 30% CRITICAL Immediate action required 30-60% Plan migration Within 12-24 months 60-90% Good readiness Complete remaining migrations &gt; 90% PQC-ready Maintain configuration"},{"location":"cbom-generator/features/pqc-assessment/#cbom-output-properties","title":"CBOM Output Properties","text":"<p>The CBOM includes aggregate PQC metrics:</p> <pre><code>{\n  \"properties\": [\n    {\"name\": \"cbom:pqc:total_assets\", \"value\": \"351\"},\n    {\"name\": \"cbom:pqc:safe_count\", \"value\": \"1\"},\n    {\"name\": \"cbom:pqc:transitional_count\", \"value\": \"20\"},\n    {\"name\": \"cbom:pqc:deprecated_count\", \"value\": \"0\"},\n    {\"name\": \"cbom:pqc:unsafe_count\", \"value\": \"330\"},\n    {\"name\": \"cbom:pqc:readiness_score\", \"value\": \"3.1\"},\n    {\"name\": \"cbom:pqc:break_2030_count\", \"value\": \"119\"},\n    {\"name\": \"cbom:pqc:break_2035_count\", \"value\": \"64\"},\n    {\"name\": \"cbom:pqc:break_2040_count\", \"value\": \"0\"},\n    {\"name\": \"cbom:pqc:break_2045_count\", \"value\": \"0\"}\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/features/pqc-assessment/#per-component-pqc-status","title":"Per-Component PQC Status","text":"<p>Every algorithm, certificate, and key includes PQC assessment:</p> <pre><code>{\n  \"name\": \"RSA-2048\",\n  \"properties\": [\n    { \"name\": \"cbom:pqc:status\", \"value\": \"TRANSITIONAL\" },\n    { \"name\": \"cbom:pqc:confidence\", \"value\": \"HIGH\" },\n    { \"name\": \"cbom:pqc:migration_urgency\", \"value\": \"HIGH\" },\n    { \"name\": \"cbom:pqc:alternative\", \"value\": \"ML-DSA-65\" },\n    { \"name\": \"cbom:pqc:break_estimate\", \"value\": \"2035\" },\n    { \"name\": \"cbom:pqc:rationale\", \"value\": \"Quantum-vulnerable but meets current classical security standards\" }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/features/pqc-assessment/#classification-philosophy","title":"Classification Philosophy","text":""},{"location":"cbom-generator/features/pqc-assessment/#libraries-worst-case-classification","title":"Libraries: Worst-Case Classification","text":"<p>Libraries are classified based on the weakest algorithm they implement:</p> Library Implements Classification Rationale AES-256 + RSA-2048 + MD5 DEPRECATED MD5 is deprecated AES-256 + RSA-2048 TRANSITIONAL RSA-2048 is quantum-vulnerable AES-256 + ML-KEM-768 SAFE Both are PQC-safe"},{"location":"cbom-generator/features/pqc-assessment/#servicesapplications-best-case-classification","title":"Services/Applications: Best-Case Classification","text":"<p>Services are classified based on the strongest configured algorithm:</p> Service Configured With Classification TLS_AES_256_GCM_SHA384 + curve25519-sha256 TRANSITIONAL TLS_AES_256_GCM_SHA384 + sntrup761x25519 SAFE SSLv3 + RC4 only DEPRECATED"},{"location":"cbom-generator/features/pqc-assessment/#pqc-kex-detection","title":"PQC KEX Detection","text":"<p>The generator recognizes Post-Quantum key exchange algorithms:</p> Pattern Algorithm Type <code>sntrup761*</code> NTRU Prime hybrid OpenSSH <code>mlkem*</code> / <code>kyber*</code> ML-KEM/Kyber TLS 1.3 <code>dilithium*</code> / <code>mldsa*</code> ML-DSA/Dilithium Signatures"},{"location":"cbom-generator/features/pqc-assessment/#enabling-pqc-for-services","title":"Enabling PQC for Services","text":""},{"location":"cbom-generator/features/pqc-assessment/#openssh-v90","title":"OpenSSH (v9.0+)","text":"<pre><code># /etc/ssh/sshd_config\nKexAlgorithms sntrup761x25519-sha512@openssh.com,curve25519-sha256\n</code></pre>"},{"location":"cbom-generator/features/pqc-assessment/#nginx-openssl-32","title":"Nginx (OpenSSL 3.2+)","text":"<pre><code>ssl_ecdh_curve X25519MLKEM768:X25519:P-256;\n</code></pre>"},{"location":"cbom-generator/features/pqc-assessment/#apache-openssl-32","title":"Apache (OpenSSL 3.2+)","text":"<pre><code>SSLOpenSSLConfCmd Curves X25519MLKEM768:X25519:P-256\n</code></pre>"},{"location":"cbom-generator/features/pqc-assessment/#common-queries","title":"Common Queries","text":""},{"location":"cbom-generator/features/pqc-assessment/#finding-critical-assets-break-by-2030","title":"Finding Critical Assets (Break by 2030)","text":"<pre><code>cat cbom.json | jq '.components[] |\n    select(.properties[]? | select(.name == \"cbom:pqc:break_estimate\" and .value == \"2030\")) |\n    .name'\n</code></pre>"},{"location":"cbom-generator/features/pqc-assessment/#services-without-pqc","title":"Services Without PQC","text":"<pre><code>cat cbom.json | jq -r '.components[] |\n    select(.type == \"operating-system\") |\n    select(.properties[]? | select(.name == \"cbom:pqc:status\" and .value == \"TRANSITIONAL\")) |\n    \"\\(.name): \\(.properties[] | select(.name == \"cbom:pqc:rationale\").value)\"'\n</code></pre>"},{"location":"cbom-generator/features/pqc-assessment/#pqc-ready-components","title":"PQC-Ready Components","text":"<pre><code>cat cbom.json | jq '.components[] |\n    select(.properties[]? | select(.name == \"cbom:pqc:status\" and .value == \"SAFE\")) |\n    .name'\n</code></pre>"},{"location":"cbom-generator/features/privacy-controls/","title":"Privacy Controls","text":"<p>CBOM Generator implements privacy-by-default for GDPR/CCPA compliance.</p>"},{"location":"cbom-generator/features/privacy-controls/#privacy-by-default","title":"Privacy-by-Default","text":"<p>Personal data is automatically redacted unless <code>--include-personal-data</code> is specified.</p>"},{"location":"cbom-generator/features/privacy-controls/#what-is-redacted","title":"What is Redacted","text":"Data Type Original Redacted Hostnames <code>myserver.example.com</code> <code>&lt;host-hash-XXXXXXXX&gt;</code> Usernames <code>alice</code> <code>&lt;user-alice&gt;</code> Home directories <code>/home/alice/.ssh</code> <code>&lt;path-hash-XXXXXXXX&gt;</code> User paths <code>/home/bob/certs</code> <code>&lt;path-hash-XXXXXXXX&gt;</code>"},{"location":"cbom-generator/features/privacy-controls/#what-is-not-redacted","title":"What is NOT Redacted","text":"<ul> <li>System paths (<code>/etc</code>, <code>/usr</code>, <code>/var</code>)</li> <li>Algorithm names and OIDs</li> <li>Certificate subjects/issuers (already pseudonymous)</li> <li>Cryptographic properties</li> <li>Package names and versions</li> </ul>"},{"location":"cbom-generator/features/privacy-controls/#redaction-method","title":"Redaction Method","text":"<p>CBOM Generator uses salted hashing for consistent pseudonymization:</p> <ol> <li>Salted Hashing: Uses <code>CBOM_SALT</code> environment variable</li> <li>Consistency: Same input produces same pseudonym across runs</li> <li>Entropy Validation: Requires \u2265128 bits entropy</li> </ol> <pre><code># Set custom salt for reproducible pseudonyms\nexport CBOM_SALT=\"my-organization-specific-salt-value\"\n./build/cbom-generator --no-personal-data --output cbom.json\n</code></pre>"},{"location":"cbom-generator/features/privacy-controls/#privacy-metadata","title":"Privacy Metadata","text":"<p>The output includes privacy documentation:</p> <pre><code>{\n  \"metadata\": {\n    \"privacy\": {\n      \"no_personal_data\": true,\n      \"redaction_applied\": true,\n      \"methods\": [\"hostname_redaction\", \"path_redaction\", \"username_redaction\"],\n      \"compliance\": [\"GDPR\", \"CCPA\"],\n      \"mode\": \"privacy-by-default\"\n    }\n  }\n}\n</code></pre>"},{"location":"cbom-generator/features/privacy-controls/#cli-options","title":"CLI Options","text":""},{"location":"cbom-generator/features/privacy-controls/#-no-personal-data-default-on","title":"<code>--no-personal-data</code> (Default: ON)","text":"<p>Enables privacy redaction.</p> <pre><code>./build/cbom-generator --no-personal-data --output cbom.json\n</code></pre>"},{"location":"cbom-generator/features/privacy-controls/#-include-personal-data","title":"<code>--include-personal-data</code>","text":"<p>Disables privacy redaction for internal scans.</p> <pre><code>./build/cbom-generator --include-personal-data --output cbom-full.json\n</code></pre> <p>Warning: Output may contain sensitive information. Use appropriate access controls.</p>"},{"location":"cbom-generator/features/privacy-controls/#user-ssh-configuration","title":"User SSH Configuration","text":"<p>User SSH configs (<code>~/.ssh/config</code>) are only scanned with <code>--include-personal-data</code>:</p> Mode User SSH Configs <code>--no-personal-data</code> Not scanned <code>--include-personal-data</code> Scanned for all users in /home/* <p>Rationale: User SSH configs reveal: - Individual cryptographic preferences - Non-public KEX algorithm choices - Personal security configurations</p>"},{"location":"cbom-generator/features/privacy-controls/#compliance","title":"Compliance","text":""},{"location":"cbom-generator/features/privacy-controls/#gdpr-compliance","title":"GDPR Compliance","text":"<ul> <li>Article 25: Privacy by design (default redaction)</li> <li>Article 4(5): Pseudonymization (salted hashing)</li> <li>Article 89: Research safeguards (consistent pseudonyms)</li> </ul>"},{"location":"cbom-generator/features/privacy-controls/#ccpa-compliance","title":"CCPA Compliance","text":"<ul> <li>1798.100(c): De-identified data requirements</li> <li>1798.140(h): Pseudonymization standards</li> </ul>"},{"location":"cbom-generator/features/privacy-controls/#use-cases","title":"Use Cases","text":""},{"location":"cbom-generator/features/privacy-controls/#external-sharing","title":"External Sharing","text":"<pre><code># Safe for sharing with third parties\n./build/cbom-generator --no-personal-data --output audit-cbom.json\n</code></pre>"},{"location":"cbom-generator/features/privacy-controls/#internal-investigation","title":"Internal Investigation","text":"<pre><code># Full details for internal security team\n./build/cbom-generator --include-personal-data --output internal-cbom.json\n</code></pre>"},{"location":"cbom-generator/features/privacy-controls/#cross-organization-analysis","title":"Cross-Organization Analysis","text":"<pre><code># Same salt across organization for correlation\nexport CBOM_SALT=\"org-wide-consistent-salt\"\n./build/cbom-generator --no-personal-data --output team-a-cbom.json\n</code></pre>"},{"location":"cbom-generator/features/protocol-properties/","title":"Protocol Properties","text":"<p>The Protocol Analysis module extracts detailed cryptographic protocol configurations from services.</p>"},{"location":"cbom-generator/features/protocol-properties/#supported-protocol-types","title":"Supported Protocol Types","text":"Protocol Description Detection Source TLS Transport Layer Security Apache, Nginx, Postfix configs SSH Secure Shell sshd_config, ssh_config IPsec IP Security strongSwan, OpenConnect configs DTLS Datagram TLS VPN configurations QUIC Quick UDP Internet Connections Modern web servers WireGuard WireGuard VPN WireGuard configs OpenVPN OpenVPN protocol OpenVPN configs"},{"location":"cbom-generator/features/protocol-properties/#tls-version-detection","title":"TLS Version Detection","text":"<p>Protocols track which TLS versions are enabled:</p> <pre><code>{\n  \"type\": \"cryptographic-asset\",\n  \"name\": \"TLS\",\n  \"bom-ref\": \"protocol:tls\",\n  \"properties\": [\n    { \"name\": \"cbom:proto:type\", \"value\": \"TLS\" },\n    { \"name\": \"cbom:proto:version_min\", \"value\": \"1.2\" },\n    { \"name\": \"cbom:proto:version_max\", \"value\": \"1.3\" },\n    { \"name\": \"cbom:proto:security_profile\", \"value\": \"MODERN\" }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/features/protocol-properties/#tls-version-analysis","title":"TLS Version Analysis","text":"Version Status Risk Level TLS 1.3 Current Safe TLS 1.2 Supported Safe (with modern ciphers) TLS 1.1 Deprecated HIGH RISK TLS 1.0 Deprecated HIGH RISK SSLv3 Obsolete CRITICAL"},{"location":"cbom-generator/features/protocol-properties/#ssh-protocol-properties","title":"SSH Protocol Properties","text":"<p>SSH configurations are analyzed at three levels:</p> <p>Server Configuration (<code>/etc/ssh/sshd_config</code>): - KexAlgorithms (key exchange) - Ciphers, MACs - HostKeyAlgorithms - Usage: <code>server</code> (inbound connections)</p> <p>System Client Configuration (<code>/etc/ssh/ssh_config</code>): - KexAlgorithms, Ciphers, MACs - Usage: <code>client</code> (system-wide outbound)</p> <p>User Client Configuration (<code>~/.ssh/config</code>): - Requires <code>--include-personal-data</code> flag - Per-user KEX preferences - Usage: <code>client-user-&lt;username&gt;</code></p>"},{"location":"cbom-generator/features/protocol-properties/#pqc-kex-algorithm-detection","title":"PQC KEX Algorithm Detection","text":"<p>The scanner detects Post-Quantum safe KEX algorithms:</p> Algorithm Type PQC Status <code>sntrup761x25519-sha512@openssh.com</code> Hybrid (NTRU Prime + X25519) PQC SAFE <code>curve25519-sha256</code> ECDH Vulnerable <code>ecdh-sha2-nistp256</code> ECDH Vulnerable <code>diffie-hellman-group16-sha512</code> DH Vulnerable"},{"location":"cbom-generator/features/protocol-properties/#cipher-suite-decomposition","title":"Cipher Suite Decomposition","text":"<p>Cipher suites are broken down into component algorithms:</p> <p>TLS 1.3 Cipher Suites (fixed format):</p> Cipher Suite Encryption Hash TLS_AES_256_GCM_SHA384 AES-256-GCM SHA384 TLS_AES_128_GCM_SHA256 AES-128-GCM SHA256 TLS_CHACHA20_POLY1305_SHA256 ChaCha20-Poly1305 SHA256 <p>TLS 1.2 Cipher Suites (decomposed):</p> <p>Example: <code>ECDHE-RSA-AES256-GCM-SHA384</code></p> Component Algorithm Key Exchange ECDHE Authentication RSA Encryption AES-256-GCM MAC SHA384"},{"location":"cbom-generator/features/protocol-properties/#protocol-cyclonedx-output","title":"Protocol CycloneDX Output","text":"<pre><code>{\n  \"type\": \"cryptographic-asset\",\n  \"name\": \"TLS 1.3\",\n  \"bom-ref\": \"protocol:tls-1.3\",\n  \"cryptoProperties\": {\n    \"assetType\": \"protocol\",\n    \"protocolProperties\": {\n      \"type\": \"tls\",\n      \"version\": \"1.3\"\n    }\n  },\n  \"properties\": [\n    { \"name\": \"cbom:proto:type\", \"value\": \"TLS\" },\n    { \"name\": \"cbom:proto:version\", \"value\": \"1.3\" },\n    { \"name\": \"cbom:proto:security_profile\", \"value\": \"MODERN\" },\n    { \"name\": \"cbom:pqc:status\", \"value\": \"UNSAFE\" }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/features/protocol-properties/#common-queries","title":"Common Queries","text":""},{"location":"cbom-generator/features/protocol-properties/#finding-deprecated-tls-versions","title":"Finding Deprecated TLS Versions","text":"<pre><code>cat cbom.json | jq -r '.components[] |\n    select(.cryptoProperties?.protocolProperties?.type == \"tls\") |\n    select(.cryptoProperties?.protocolProperties?.version | test(\"1.0|1.1\")) |\n    \"\\(.name) - DEPRECATED\"'\n</code></pre>"},{"location":"cbom-generator/features/protocol-properties/#ssh-kex-algorithm-inventory","title":"SSH KEX Algorithm Inventory","text":"<pre><code>cat cbom.json | jq -r '.components[] |\n    select(.bom-ref | startswith(\"algo:\")) |\n    select(.properties[]? | select(.name == \"cbom:algo:context\" and .value | test(\"kex\"))) |\n    .name'\n</code></pre>"},{"location":"cbom-generator/features/protocol-properties/#services-using-tls-13","title":"Services Using TLS 1.3","text":"<pre><code>cat cbom.json | jq -r '.dependencies[] |\n    select(.dependsOn[]? | contains(\"protocol:tls-1.3\")) |\n    .ref'\n</code></pre>"},{"location":"cbom-generator/features/relationship-graph/","title":"Relationship Graph","text":"<p>The CBOM Generator builds a complete dependency graph showing how cryptographic components relate to each other.</p>"},{"location":"cbom-generator/features/relationship-graph/#relationship-types","title":"Relationship Types","text":"Relationship Description Example USES Consumer uses provider Service uses Protocol PROVIDES Provider offers capability Protocol provides Cipher Suite DEPENDS_ON Direct dependency Application depends on Library AUTHENTICATES_WITH Authentication relationship nginx authenticates with server.crt CONFIGURES Configuration relationship apache2 configures TLS 1.3 SIGNS Signing relationship CA signs end-entity certificate ISSUED_BY Issuance relationship Certificate issued by CA"},{"location":"cbom-generator/features/relationship-graph/#dependency-chains","title":"Dependency Chains","text":""},{"location":"cbom-generator/features/relationship-graph/#service-to-algorithm-chain","title":"Service to Algorithm Chain","text":"<pre><code>SERVICE \u2192 PROTOCOL \u2192 CIPHER_SUITE \u2192 ALGORITHM\n</code></pre> <p>Example: <pre><code>nginx\n  \u2514\u2500\u2500 USES \u2192 TLS 1.3\n                \u2514\u2500\u2500 PROVIDES \u2192 TLS_AES_256_GCM_SHA384\n                                   \u2514\u2500\u2500 USES \u2192 AES-256-GCM\n                                   \u2514\u2500\u2500 USES \u2192 SHA384\n</code></pre></p>"},{"location":"cbom-generator/features/relationship-graph/#application-to-library-chain","title":"Application to Library Chain","text":"<pre><code>APPLICATION \u2192 LIBRARY \u2192 ALGORITHM\n</code></pre> <p>Example: <pre><code>curl\n  \u2514\u2500\u2500 DEPENDS_ON \u2192 OpenSSL\n                       \u2514\u2500\u2500 PROVIDES \u2192 RSA\n                       \u2514\u2500\u2500 PROVIDES \u2192 ECDSA\n                       \u2514\u2500\u2500 PROVIDES \u2192 AES-256-GCM\n</code></pre></p>"},{"location":"cbom-generator/features/relationship-graph/#certificate-chain","title":"Certificate Chain","text":"<pre><code>END_ENTITY_CERT \u2192 INTERMEDIATE_CA \u2192 ROOT_CA\n</code></pre> <p>Example: <pre><code>server.crt\n  \u2514\u2500\u2500 ISSUED_BY \u2192 Intermediate CA\n                      \u2514\u2500\u2500 ISSUED_BY \u2192 Root CA\n                                          \u2514\u2500\u2500 SELF_SIGNED\n</code></pre></p>"},{"location":"cbom-generator/features/relationship-graph/#cyclonedx-dependencies-array","title":"CycloneDX Dependencies Array","text":"<p>The dependency graph is represented in the <code>dependencies</code> array:</p> <pre><code>{\n  \"dependencies\": [\n    {\n      \"ref\": \"service:nginx\",\n      \"dependsOn\": [\"protocol:tls\"]\n    },\n    {\n      \"ref\": \"protocol:tls\",\n      \"dependsOn\": [\n        \"cipher:tls-ecdhe-rsa-with-aes-256-gcm-sha384\"\n      ]\n    },\n    {\n      \"ref\": \"cipher:tls-ecdhe-rsa-with-aes-256-gcm-sha384\",\n      \"dependsOn\": [\n        \"algo:aes-256-gcm-256\",\n        \"algo:ecdhe\",\n        \"algo:rsa\",\n        \"algo:sha384\"\n      ]\n    }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/features/relationship-graph/#provider-properties","title":"Provider Properties","text":"<p>Components that provide services include <code>cbom:provides</code> property:</p> <pre><code>{\n  \"name\": \"TLS\",\n  \"type\": \"protocol\",\n  \"properties\": [\n    {\n      \"name\": \"cbom:provides\",\n      \"value\": \"cipher-suite-1, cipher-suite-2\"\n    }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/features/relationship-graph/#common-queries","title":"Common Queries","text":""},{"location":"cbom-generator/features/relationship-graph/#finding-all-dependencies-of-a-service","title":"Finding All Dependencies of a Service","text":"<pre><code>cat cbom.json | jq '.dependencies[] | select(.ref == \"service:nginx\")'\n</code></pre>"},{"location":"cbom-generator/features/relationship-graph/#tracing-algorithm-usage","title":"Tracing Algorithm Usage","text":"<pre><code># Find all components that use a specific algorithm\ncat cbom.json | jq '.dependencies[] |\n    select(.dependsOn[]? | contains(\"algo:aes-256-gcm\")) |\n    .ref'\n</code></pre>"},{"location":"cbom-generator/features/relationship-graph/#building-full-dependency-tree","title":"Building Full Dependency Tree","text":"<pre><code># Show complete dependency chain for a service\nSERVICE=\"service:nginx\"\ncat cbom.json | jq --arg svc \"$SERVICE\" '\n    .dependencies[] |\n    select(.ref == $svc or .ref as $r |\n        (.dependencies[] | select(.ref == $svc).dependsOn[]?) == $r)'\n</code></pre>"},{"location":"cbom-generator/features/relationship-graph/#finding-orphan-components","title":"Finding Orphan Components","text":"<pre><code># Components not referenced in any dependency\ncat cbom.json | jq '\n    [.dependencies[].ref, .dependencies[].dependsOn[]] | flatten | unique as $refs |\n    .components[].[\"bom-ref\"] |\n    select(. as $br | $refs | index($br) | not)'\n</code></pre>"},{"location":"cbom-generator/features/relationship-graph/#relationship-statistics","title":"Relationship Statistics","text":"<p>The CBOM includes relationship counts in metadata:</p> <pre><code>{\n  \"properties\": [\n    { \"name\": \"cbom:relationships:total\", \"value\": \"537\" },\n    { \"name\": \"cbom:relationships:uses\", \"value\": \"245\" },\n    { \"name\": \"cbom:relationships:provides\", \"value\": \"189\" },\n    { \"name\": \"cbom:relationships:depends_on\", \"value\": \"103\" }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/features/service-dependencies/","title":"Service Dependencies","text":"<p>The Service Discovery Scanner automatically detects running services and maps their complete cryptographic dependency chains.</p>"},{"location":"cbom-generator/features/service-dependencies/#4-level-dependency-architecture","title":"4-Level Dependency Architecture","text":"<pre><code>SERVICE \u2192 PROTOCOL \u2192 CIPHER_SUITE \u2192 ALGORITHM\n</code></pre> <p>This architecture enables complete PQC readiness assessment by tracing every algorithm used by each service.</p>"},{"location":"cbom-generator/features/service-dependencies/#supported-services-69-total","title":"Supported Services (69+ Total)","text":"<p>Built-in Scanners (4):</p> <ul> <li>Apache HTTPD, Nginx</li> <li>OpenSSH</li> <li>Postfix</li> </ul> <p>YAML Plugins (65+):</p> Category Services Databases PostgreSQL, MySQL, MongoDB, MariaDB, Redis, Cassandra, Elasticsearch Web Servers Caddy, Traefik, HAProxy, lighttpd Containers Docker, Kubernetes, K3s, containerd, Podman VPN OpenVPN, WireGuard, strongSwan, tinc Mail Dovecot, Exim, Sendmail Message Brokers RabbitMQ, Kafka, ActiveMQ, mosquitto Monitoring Prometheus, Grafana, Fluentd"},{"location":"cbom-generator/features/service-dependencies/#detection-methods","title":"Detection Methods","text":"<p>Services are discovered using multiple methods:</p> Method How It Works Process Scanning <code>/proc</code> for running daemons Port Analyzing <code>/proc/net/tcp</code> for listening services Config File Finding configuration files in standard paths Systemd Querying <code>systemctl</code> for active services Package Checking installed packages (dpkg/rpm/pacman)"},{"location":"cbom-generator/features/service-dependencies/#security-profiles","title":"Security Profiles","text":"<p>Services are automatically classified based on their configuration:</p> Profile Criteria Risk Level MODERN TLS 1.3 only, no weak ciphers Low INTERMEDIATE TLS 1.2+ with strong ciphers Medium OLD TLS 1.0/1.1 or weak ciphers HIGH RISK CUSTOM Custom configuration Varies"},{"location":"cbom-generator/features/service-dependencies/#example-dependency-chain","title":"Example Dependency Chain","text":"<p>Apache HTTPD with TLS 1.2:</p> <pre><code>service:apache-httpd (Apache HTTPD 2.4.52)\n  |-- USES --&gt; protocol:tls (TLS 1.2)\n      |-- PROVIDES --&gt; cipher:tls-ecdhe-rsa-with-aes-256-gcm-sha384\n          |-- USES --&gt; algo:ecdhe (ECDHE key exchange)\n          |-- USES --&gt; algo:rsa (RSA authentication)\n          |-- USES --&gt; algo:aes-256-gcm-256 (AES-256-GCM encryption)\n          |-- USES --&gt; algo:sha384 (SHA384 MAC)\n</code></pre> <p>OpenSSH with PQC KEX:</p> <pre><code>service:openssh (OpenSSH 8.9p1)\n  |-- USES --&gt; protocol:ssh-2 (SSH 2.0)\n      |-- USES --&gt; algo:curve25519-sha256 (X25519 KEX)\n      |-- USES --&gt; algo:sntrup761x25519-sha512-openssh-com (PQC HYBRID KEX) [PQC SAFE]\n</code></pre>"},{"location":"cbom-generator/features/service-dependencies/#cyclonedx-dependencies-array","title":"CycloneDX Dependencies Array","text":"<p>The complete dependency graph appears in the <code>dependencies</code> array:</p> <pre><code>{\n  \"dependencies\": [\n    {\n      \"ref\": \"service:apache-httpd\",\n      \"dependsOn\": [\"protocol:tls\"]\n    },\n    {\n      \"ref\": \"protocol:tls\",\n      \"dependsOn\": [\n        \"cipher:tls-ecdhe-rsa-with-aes-256-gcm-sha384\"\n      ]\n    },\n    {\n      \"ref\": \"cipher:tls-ecdhe-rsa-with-aes-256-gcm-sha384\",\n      \"dependsOn\": [\n        \"algo:ecdhe\",\n        \"algo:rsa\",\n        \"algo:aes-256-gcm-256\",\n        \"algo:sha384\"\n      ]\n    }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/features/service-dependencies/#service-properties","title":"Service Properties","text":"<pre><code>{\n  \"type\": \"operating-system\",\n  \"name\": \"Apache HTTPD\",\n  \"bom-ref\": \"service:apache-httpd\",\n  \"properties\": [\n    { \"name\": \"cbom:svc:name\", \"value\": \"Apache HTTPD\" },\n    { \"name\": \"cbom:svc:version\", \"value\": \"2.4.52\" },\n    { \"name\": \"cbom:svc:is_running\", \"value\": \"true\" },\n    { \"name\": \"cbom:svc:port\", \"value\": \"443\" },\n    { \"name\": \"cbom:svc:config_file\", \"value\": \"/etc/apache2/sites-enabled/default-ssl.conf\" },\n    { \"name\": \"cbom:pqc:status\", \"value\": \"UNSAFE\" }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/features/service-dependencies/#common-queries","title":"Common Queries","text":""},{"location":"cbom-generator/features/service-dependencies/#finding-services-by-security-profile","title":"Finding Services by Security Profile","text":"<pre><code># List all services with OLD security profile (high risk)\n./build/cbom-generator --discover-services --output cbom.json\ncat cbom.json | jq -r '.components[] |\n    select(.type == \"operating-system\") |\n    select(.properties[]? | select(.name == \"cbom:proto:security_profile\" and .value == \"OLD\")) |\n    \"\\(.name) - \\(.properties[] | select(.name == \"cbom:svc:config_file\").value)\"'\n</code></pre>"},{"location":"cbom-generator/features/service-dependencies/#mapping-service-crypto-dependencies","title":"Mapping Service Crypto Dependencies","text":"<pre><code># Show complete dependency chain for services\ncat cbom.json | jq '.dependencies[] | select(.ref | startswith(\"service:\"))'\n</code></pre>"},{"location":"cbom-generator/features/service-dependencies/#finding-pqc-ready-services","title":"Finding PQC-Ready Services","text":"<pre><code># List services using PQC/hybrid algorithms\ncat cbom.json | jq -r '.components[] |\n    select(.type == \"operating-system\") |\n    select(.properties[]? | select(.name == \"cbom:pqc:status\" and .value == \"SAFE\")) |\n    .name'\n</code></pre>"},{"location":"cbom-generator/getting-started/","title":"Getting Started","text":"<p>This section helps you install CBOM Generator and run your first scan.</p>"},{"location":"cbom-generator/getting-started/#overview","title":"Overview","text":"<p>CBOM Generator is built from source and requires a few common Linux development dependencies. Installation takes about 5 minutes on most systems.</p>"},{"location":"cbom-generator/getting-started/#pages-in-this-section","title":"Pages in This Section","text":"<ul> <li>Installation - Prerequisites, build instructions, and verification</li> <li>Quick Start - Run your first scan and understand the output</li> </ul>"},{"location":"cbom-generator/getting-started/#system-requirements","title":"System Requirements","text":"<ul> <li>Operating System: Linux (Ubuntu 20.04+, RHEL 8+, Debian 10+)</li> <li>Architecture: x86_64 or ARM64</li> <li>Memory: 512MB minimum, 2GB recommended for large scans</li> <li>Disk: 50MB for build artifacts</li> </ul>"},{"location":"cbom-generator/getting-started/#next-steps","title":"Next Steps","text":"<ol> <li>Install the prerequisites and build</li> <li>Run your first scan</li> <li>Explore the CLI options</li> </ol>"},{"location":"cbom-generator/getting-started/installation/","title":"Installation","text":""},{"location":"cbom-generator/getting-started/installation/#prerequisites","title":"Prerequisites","text":""},{"location":"cbom-generator/getting-started/installation/#ubuntudebian","title":"Ubuntu/Debian","text":"<pre><code>sudo apt-get install build-essential cmake libssl-dev libjson-c-dev \\\n    libcurl4-openssl-dev libncurses-dev libyaml-dev libjansson-dev\n</code></pre>"},{"location":"cbom-generator/getting-started/installation/#rhelcentos","title":"RHEL/CentOS","text":"<pre><code>sudo yum install gcc cmake openssl-devel json-c-devel libcurl-devel \\\n    ncurses-devel libyaml-devel jansson-devel\n</code></pre>"},{"location":"cbom-generator/getting-started/installation/#required-dependencies","title":"Required Dependencies","text":"Dependency Minimum Version Notes OpenSSL 3.0+ 3.5+ recommended for PQC support json-c 0.15+ JSON output generation libcurl latest Network operations ncurses 6.0+ TUI display libyaml 0.2.2+ YAML plugin support jansson 2.13+ JSON parsing CMake 3.16+ Build system GCC C11 support Compiler"},{"location":"cbom-generator/getting-started/installation/#build-from-source","title":"Build from Source","text":"<pre><code># Clone repository\ngit clone https://github.com/your-org/cryptoBOM.git\ncd cryptoBOM\n\n# Configure for release build\ncmake -B build -DCMAKE_BUILD_TYPE=Release\n\n# Build\ncmake --build build\n\n# Install (optional)\nsudo cmake --install build\n</code></pre>"},{"location":"cbom-generator/getting-started/installation/#build-options","title":"Build Options","text":"Option Default Description <code>CMAKE_BUILD_TYPE</code> Release Release or Debug <code>ENABLE_TESTS</code> ON Build test suite <code>ENABLE_STATIC_ANALYSIS</code> OFF Enable Clang analyzer"},{"location":"cbom-generator/getting-started/installation/#debug-build","title":"Debug Build","text":"<p>For development or troubleshooting:</p> <pre><code>cmake -B build-debug -DCMAKE_BUILD_TYPE=Debug\ncmake --build build-debug\n</code></pre>"},{"location":"cbom-generator/getting-started/installation/#verify-installation","title":"Verify Installation","text":"<pre><code># Check version\n./build/cbom-generator --version\n# Output: CBOM Generator 1.9.0\n\n# Run help\n./build/cbom-generator --help\n\n# Run test suite (optional)\ncd build &amp;&amp; ctest\n</code></pre>"},{"location":"cbom-generator/getting-started/installation/#troubleshooting-installation","title":"Troubleshooting Installation","text":""},{"location":"cbom-generator/getting-started/installation/#missing-openssl-headers","title":"Missing OpenSSL Headers","text":"<pre><code>fatal error: openssl/ssl.h: No such file or directory\n</code></pre> <p>Solution: Install OpenSSL development package: <pre><code>sudo apt-get install libssl-dev  # Debian/Ubuntu\nsudo yum install openssl-devel   # RHEL/CentOS\n</code></pre></p>"},{"location":"cbom-generator/getting-started/installation/#cmake-version-too-old","title":"CMake Version Too Old","text":"<pre><code>CMake 3.16 or higher is required\n</code></pre> <p>Solution: Install newer CMake: <pre><code>pip install cmake --upgrade\n# Or download from https://cmake.org/download/\n</code></pre></p>"},{"location":"cbom-generator/getting-started/installation/#missing-libyaml","title":"Missing libyaml","text":"<pre><code>Could not find libyaml\n</code></pre> <p>Solution: Install libyaml development package: <pre><code>sudo apt-get install libyaml-dev  # Debian/Ubuntu\nsudo yum install libyaml-devel    # RHEL/CentOS\n</code></pre></p>"},{"location":"cbom-generator/getting-started/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start - Run your first scan</li> </ul>"},{"location":"cbom-generator/getting-started/quick-start/","title":"Quick Start","text":"<p>Run your first CBOM scan in minutes.</p>"},{"location":"cbom-generator/getting-started/quick-start/#basic-system-scan","title":"Basic System Scan","text":"<pre><code># Scan entire system, output to stdout\n./build/cbom-generator\n\n# Save to file\n./build/cbom-generator --output my-cbom.json\n\n# Generate CycloneDX format\n./build/cbom-generator --format cyclonedx --output cbom.cdx.json\n</code></pre>"},{"location":"cbom-generator/getting-started/quick-start/#privacy-compliant-scan","title":"Privacy-Compliant Scan","text":"<p>CBOM Generator is privacy-by-default. Personal data (hostnames, paths, usernames) is automatically redacted.</p> <pre><code># Privacy mode (default: redacts hostnames, paths, usernames)\n./build/cbom-generator --no-personal-data --output cbom.json\n\n# Include full paths (disable redaction)\n./build/cbom-generator --include-personal-data --output cbom-full.json\n</code></pre>"},{"location":"cbom-generator/getting-started/quick-start/#pqc-readiness-check","title":"PQC Readiness Check","text":"<p>Assess your system's Post-Quantum Cryptography readiness:</p> <pre><code># Generate CBOM with PQC assessment\n./build/cbom-generator --format cyclonedx --output pqc-assessment.json\n\n# View PQC readiness score\ncat pqc-assessment.json | jq '.metadata.properties[] | select(.name == \"cbom:pqc_readiness_percent\")'\n</code></pre> <p>Understanding the Score:</p> Score Status Action 0-20% Critical Immediate migration needed 20-50% Poor Plan migration timeline 50-80% Good Continue improvements 80-100% Excellent Quantum-safe infrastructure"},{"location":"cbom-generator/getting-started/quick-start/#service-discovery","title":"Service Discovery","text":"<p>Discover running services and their cryptographic configurations:</p> <pre><code># Enable service discovery with plugins\n./build/cbom-generator --discover-services --plugin-dir plugins \\\n    --format cyclonedx --cyclonedx-spec 1.7 --output services.json\n</code></pre> <p>This scans: - Running processes (nginx, apache, sshd, etc.) - Configuration files (TLS settings, cipher suites) - Network endpoints (listening ports, protocols)</p>"},{"location":"cbom-generator/getting-started/quick-start/#scan-specific-directories","title":"Scan Specific Directories","text":"<p>Focus on particular areas of your system:</p> <pre><code># Scan /etc for certificates and configs\n./build/cbom-generator --output etc-cbom.json /etc\n\n# Scan multiple directories\n./build/cbom-generator --output app-cbom.json /usr/sbin /usr/lib /etc\n\n# Scan embedded rootfs (Yocto/Buildroot)\n./build/cbom-generator --cross-arch --output rootfs-cbom.json /path/to/rootfs\n</code></pre>"},{"location":"cbom-generator/getting-started/quick-start/#understanding-the-output","title":"Understanding the Output","text":"<p>CBOM Generator outputs JSON in CycloneDX format:</p> <pre><code>{\n  \"bomFormat\": \"CycloneDX\",\n  \"specVersion\": \"1.6\",\n  \"version\": 1,\n  \"metadata\": {\n    \"timestamp\": \"2025-12-04T12:00:00Z\",\n    \"properties\": [\n      {\"name\": \"cbom:total_components\", \"value\": \"150\"},\n      {\"name\": \"cbom:pqc_readiness_percent\", \"value\": \"4.9\"}\n    ]\n  },\n  \"components\": [\n    {\n      \"type\": \"cryptographic-asset\",\n      \"name\": \"OpenSSL\",\n      \"version\": \"3.0.2\",\n      \"cryptoProperties\": {\n        \"assetType\": \"library\"\n      }\n    }\n  ]\n}\n</code></pre> <p>Key sections: - metadata: Scan timestamp, totals, PQC readiness - components: Discovered cryptographic assets - dependencies: Relationships between components</p>"},{"location":"cbom-generator/getting-started/quick-start/#next-steps","title":"Next Steps","text":"<ul> <li>CLI Reference - Complete command-line options</li> <li>Features - Deep-dive into capabilities</li> <li>Playbooks - Migration guides</li> </ul>"},{"location":"cbom-generator/output/","title":"CycloneDX CBOM Output","text":"<p>Understanding the CBOM Generator output format.</p>"},{"location":"cbom-generator/output/#top-level-structure","title":"Top-Level Structure","text":"<pre><code>{\n  \"bomFormat\": \"CycloneDX\",\n  \"specVersion\": \"1.6\",\n  \"serialNumber\": \"urn:uuid:...\",\n  \"version\": 1,\n  \"metadata\": { /* Tool, host, provenance */ },\n  \"components\": [ /* Array of cryptographic assets */ ],\n  \"dependencies\": [ /* Provider/consumer graph */ ],\n  \"relationships\": [ /* Typed edges with confidence */ ],\n  \"pqc_assessment\": { /* PQC readiness analysis */ },\n  \"scan_completion_pct\": 92,\n  \"completion\": { /* Scanner completeness */ },\n  \"errors\": [ /* Non-fatal issues */ ]\n}\n</code></pre>"},{"location":"cbom-generator/output/#key-sections","title":"Key Sections","text":"Section Description Components Cryptographic assets discovered Crypto Properties CycloneDX CBOM-specific fields Namespaced Properties cbom:* extended properties Dependencies Provider/consumer relationships Relationships Typed edges with confidence"},{"location":"cbom-generator/output/#output-formats","title":"Output Formats","text":"Format Version Description CycloneDX 1.6 Default Maximum compatibility CycloneDX 1.7 <code>--cyclonedx-spec 1.7</code> Latest spec, enhanced dependencies <p>Both formats produce similar content. Key differences:</p> <ul> <li><code>specVersion</code> field: <code>\"1.6\"</code> vs <code>\"1.7\"</code></li> <li>Schema validation: against respective CycloneDX schemas</li> </ul>"},{"location":"cbom-generator/output/#metadata-section","title":"Metadata Section","text":"<pre><code>{\n  \"metadata\": {\n    \"timestamp\": \"2025-12-04T12:00:00Z\",\n    \"tools\": [{\n      \"vendor\": \"Graziano Labs Corp.\",\n      \"name\": \"cbom-generator\",\n      \"version\": \"1.9.0\"\n    }],\n    \"properties\": [\n      {\"name\": \"cbom:total_components\", \"value\": \"150\"},\n      {\"name\": \"cbom:pqc_readiness_percent\", \"value\": \"4.9\"},\n      {\"name\": \"cbom:scan_paths\", \"value\": \"/usr/sbin,/etc\"}\n    ],\n    \"privacy\": {\n      \"no_personal_data\": true,\n      \"redaction_applied\": true,\n      \"compliance\": [\"GDPR\", \"CCPA\"]\n    },\n    \"provenance\": {\n      \"git_commit\": \"abc123...\",\n      \"compiler\": \"GCC 11.4.0\",\n      \"openssl_version\": \"3.0.2\",\n      \"build_timestamp\": \"2025-11-09T15:00:00Z\"\n    }\n  }\n}\n</code></pre>"},{"location":"cbom-generator/output/#quick-reference","title":"Quick Reference","text":""},{"location":"cbom-generator/output/#finding-all-certificates","title":"Finding All Certificates","text":"<pre><code>cat cbom.json | jq '.components[] |\n    select(.cryptoProperties?.assetType == \"certificate\") |\n    .name'\n</code></pre>"},{"location":"cbom-generator/output/#counting-components-by-type","title":"Counting Components by Type","text":"<pre><code>cat cbom.json | jq '[.components[] | .cryptoProperties?.assetType] |\n    group_by(.) |\n    map({type: .[0], count: length})'\n</code></pre>"},{"location":"cbom-generator/output/#viewing-dependencies","title":"Viewing Dependencies","text":"<pre><code>cat cbom.json | jq '.dependencies[] | select(.ref | startswith(\"service:\"))'\n</code></pre>"},{"location":"cbom-generator/output/components/","title":"Understanding Components","text":"<p>Every component in the CBOM represents a cryptographic asset.</p>"},{"location":"cbom-generator/output/components/#component-structure","title":"Component Structure","text":"<p>Required Fields:</p> Field Description <code>type</code> Component type <code>name</code> Human-readable name <code>bom-ref</code> Unique identifier <p>Optional Fields:</p> Field Description <code>version</code> Component version <code>cryptoProperties</code> CycloneDX CBOM-specific fields <code>properties</code> Namespaced cbom:* properties <code>evidence</code> File locations and hashes"},{"location":"cbom-generator/output/components/#human-readable-bom-refs-v11","title":"Human-Readable bom-refs (v1.1+)","text":"<p>Starting in v1.1, bom-ref values are human-readable:</p> <p>Before (v1.0): <pre><code>\"bom-ref\": \"5db9813bf30c015aaf7c729a5f84c415d6b1a90bf090f1fceb...\"\n</code></pre></p> <p>After (v1.1): <pre><code>\"bom-ref\": \"cert:swisssign-gold-ca-g2\"\n</code></pre></p> <p>Format by Asset Type:</p> Type Format Example Certificate <code>cert:&lt;sanitized-cn&gt;</code> <code>cert:digicert-assured-id-root-ca</code> Algorithm <code>algo:&lt;algorithm&gt;-&lt;keysize&gt;</code> <code>algo:aes-256-gcm-256</code> Key <code>key:&lt;algorithm&gt;-&lt;keysize&gt;-&lt;hash&gt;</code> <code>key:rsa-2048-a1b2c3d4</code> Service <code>service:&lt;name&gt;</code> <code>service:apache-httpd</code> Protocol <code>protocol:&lt;name&gt;</code> <code>protocol:tls</code> Cipher Suite <code>cipher:&lt;name&gt;</code> <code>cipher:tls-ecdhe-rsa-with-aes-256-gcm-sha384</code> Library <code>library:&lt;name&gt;</code> <code>library:openssl</code> Application <code>app:&lt;name&gt;</code> <code>app:curl</code>"},{"location":"cbom-generator/output/components/#component-types","title":"Component Types","text":""},{"location":"cbom-generator/output/components/#cryptographic-asset","title":"cryptographic-asset","text":"<p>Has a <code>cryptoProperties</code> block:</p> <pre><code>{\n  \"type\": \"cryptographic-asset\",\n  \"name\": \"AES-256-GCM\",\n  \"bom-ref\": \"algo:aes-256-gcm-256\",\n  \"cryptoProperties\": {\n    \"assetType\": \"algorithm\",\n    \"algorithmProperties\": {\n      \"primitive\": \"ae\",\n      \"parameterSetIdentifier\": \"256\",\n      \"mode\": \"gcm\"\n    }\n  }\n}\n</code></pre> <p>Asset Types:</p> assetType Description Example <code>algorithm</code> Cryptographic algorithm AES-256-GCM <code>certificate</code> X.509 certificate CA root cert <code>related-crypto-material</code> Key material RSA-2048 key <code>protocol</code> Communication protocol TLS 1.3"},{"location":"cbom-generator/output/components/#library","title":"library","text":"<p>Crypto libraries tracked via package managers:</p> <pre><code>{\n  \"type\": \"library\",\n  \"name\": \"OpenSSL\",\n  \"bom-ref\": \"library:openssl\",\n  \"version\": \"3.0.2\",\n  \"properties\": [\n    { \"name\": \"cbom:lib:soname\", \"value\": \"libssl.so.3\" },\n    { \"name\": \"cbom:lib:type\", \"value\": \"crypto\" }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/output/components/#operating-system","title":"operating-system","text":"<p>Services with network functionality:</p> <pre><code>{\n  \"type\": \"operating-system\",\n  \"name\": \"Apache HTTPD\",\n  \"bom-ref\": \"service:apache-httpd\",\n  \"properties\": [\n    { \"name\": \"cbom:svc:port\", \"value\": \"443\" },\n    { \"name\": \"cbom:svc:config_file\", \"value\": \"/etc/apache2/sites-enabled/default-ssl.conf\" }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/output/components/#application","title":"application","text":"<p>Applications with crypto dependencies:</p> <pre><code>{\n  \"type\": \"application\",\n  \"name\": \"curl\",\n  \"bom-ref\": \"app:curl\",\n  \"properties\": [\n    { \"name\": \"cbom:app:role\", \"value\": \"client\" },\n    { \"name\": \"cbom:app:binary_path\", \"value\": \"/usr/bin/curl\" }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/output/components/#evidence-section","title":"Evidence Section","text":"<p>Components include evidence of where they were found:</p> <pre><code>{\n  \"evidence\": {\n    \"occurrences\": [\n      {\n        \"location\": \"/etc/ssl/certs/DigiCert_Global_Root_CA.pem\"\n      },\n      {\n        \"location\": \"/usr/share/ca-certificates/DigiCert_Global_Root_CA.crt\"\n      }\n    ]\n  }\n}\n</code></pre>"},{"location":"cbom-generator/output/components/#common-queries","title":"Common Queries","text":""},{"location":"cbom-generator/output/components/#list-all-component-types","title":"List All Component Types","text":"<pre><code>cat cbom.json | jq '[.components[].type] | unique'\n</code></pre>"},{"location":"cbom-generator/output/components/#find-components-by-bom-ref-prefix","title":"Find Components by bom-ref Prefix","text":"<pre><code>cat cbom.json | jq '.components[] | select(.[\"bom-ref\"] | startswith(\"cert:\"))'\n</code></pre>"},{"location":"cbom-generator/output/components/#count-components-by-asset-type","title":"Count Components by Asset Type","text":"<pre><code>cat cbom.json | jq '[.components[] | .cryptoProperties?.assetType] |\n    group_by(.) |\n    map({type: .[0], count: length})'\n</code></pre>"},{"location":"cbom-generator/output/crypto-properties/","title":"Crypto Properties","text":"<p>The <code>cryptoProperties</code> block contains CycloneDX CBOM-specific fields.</p>"},{"location":"cbom-generator/output/crypto-properties/#algorithmproperties","title":"algorithmProperties","text":"<p>For: Algorithms and cipher suites</p> <pre><code>{\n  \"cryptoProperties\": {\n    \"assetType\": \"algorithm\",\n    \"algorithmProperties\": {\n      \"primitive\": \"ae\",\n      \"parameterSetIdentifier\": \"256\",\n      \"mode\": \"gcm\",\n      \"classicalSecurityLevel\": 256,\n      \"nistQuantumSecurityLevel\": 5,\n      \"certificationLevel\": [\"fips140-2-l1\"],\n      \"policy\": \"CNSA\"\n    }\n  }\n}\n</code></pre> <p>Primitives:</p> Primitive Description Examples <code>ae</code> Authenticated encryption AES-GCM, ChaCha20-Poly1305 <code>block-cipher</code> Block cipher AES, DES, 3DES <code>stream-cipher</code> Stream cipher ChaCha20, RC4 <code>hash</code> Hash function SHA-256, SHA-3, MD5 <code>signature</code> Digital signature RSA, ECDSA, Ed25519, ML-DSA <code>key-agree</code> Key agreement ECDH, DH, X25519 <code>mac</code> Message authentication HMAC <code>kdf</code> Key derivation PBKDF2, HKDF, scrypt <code>kem</code> Key encapsulation ML-KEM (Kyber), NTRU"},{"location":"cbom-generator/output/crypto-properties/#certificateproperties","title":"certificateProperties","text":"<p>For: X.509 certificates</p> <pre><code>{\n  \"cryptoProperties\": {\n    \"assetType\": \"certificate\",\n    \"certificateProperties\": {\n      \"subjectName\": \"CN=Example CA\",\n      \"issuerName\": \"CN=Root CA\",\n      \"notValidBefore\": \"2020-01-01T00:00:00Z\",\n      \"notValidAfter\": \"2030-01-01T00:00:00Z\",\n      \"certificateFormat\": \"X.509\",\n      \"certificateState\": [\n        {\n          \"state\": \"active\",\n          \"activationDate\": \"2020-01-01T00:00:00Z\",\n          \"deactivationDate\": null,\n          \"revocationDate\": null,\n          \"reason\": null\n        }\n      ]\n    }\n  }\n}\n</code></pre> <p>Certificate States:</p> State Description <code>pre-activation</code> Not yet valid (notValidBefore in future) <code>active</code> Currently valid <code>deactivated</code> Expired (past notValidAfter) <code>revoked</code> Revoked by CA"},{"location":"cbom-generator/output/crypto-properties/#relatedcryptomaterialproperties","title":"relatedCryptoMaterialProperties","text":"<p>For: Private keys, public keys, secrets</p> <pre><code>{\n  \"cryptoProperties\": {\n    \"assetType\": \"related-crypto-material\",\n    \"relatedCryptoMaterialProperties\": {\n      \"type\": \"private-key\",\n      \"state\": \"active\",\n      \"size\": 2048,\n      \"format\": \"PEM\",\n      \"creationDate\": \"2024-01-01T00:00:00Z\",\n      \"activationDate\": \"2024-01-01T00:00:00Z\",\n      \"expirationDate\": \"2034-01-01T00:00:00Z\"\n    }\n  }\n}\n</code></pre> <p>Key Types:</p> Type Description <code>private-key</code> Private key material <code>public-key</code> Public key material <code>secret-key</code> Symmetric secret key <code>key</code> Generic key <p>Key States (NIST SP 800-57):</p> State Description <code>pre-activation</code> Generated but not yet active <code>active</code> Currently in use <code>suspended</code> Temporarily disabled <code>deactivated</code> No longer used for protection <code>compromised</code> Known or suspected compromise <code>destroyed</code> Securely erased"},{"location":"cbom-generator/output/crypto-properties/#protocolproperties","title":"protocolProperties","text":"<p>For: Communication protocols</p> <pre><code>{\n  \"cryptoProperties\": {\n    \"assetType\": \"protocol\",\n    \"protocolProperties\": {\n      \"type\": \"tls\",\n      \"version\": \"1.3\"\n    }\n  }\n}\n</code></pre> <p>Protocol Types:</p> Type Description <code>tls</code> Transport Layer Security <code>ssh</code> Secure Shell <code>ipsec</code> IP Security <code>dtls</code> Datagram TLS <code>wireguard</code> WireGuard VPN"},{"location":"cbom-generator/output/crypto-properties/#common-queries","title":"Common Queries","text":""},{"location":"cbom-generator/output/crypto-properties/#find-algorithms-by-primitive","title":"Find Algorithms by Primitive","text":"<pre><code>cat cbom.json | jq '.components[] |\n    select(.cryptoProperties?.algorithmProperties?.primitive == \"hash\") |\n    .name'\n</code></pre>"},{"location":"cbom-generator/output/crypto-properties/#find-active-certificates","title":"Find Active Certificates","text":"<pre><code>cat cbom.json | jq '.components[] |\n    select(.cryptoProperties?.certificateProperties?.certificateState[0]?.state == \"active\") |\n    .name'\n</code></pre>"},{"location":"cbom-generator/output/crypto-properties/#find-keys-by-size","title":"Find Keys by Size","text":"<pre><code>cat cbom.json | jq '.components[] |\n    select(.cryptoProperties?.relatedCryptoMaterialProperties?.size &lt; 2048) |\n    {name, size: .cryptoProperties.relatedCryptoMaterialProperties.size}'\n</code></pre>"},{"location":"cbom-generator/output/dependencies/","title":"Dependencies Array","text":"<p>The <code>dependencies</code> array shows provider/consumer relationships between components.</p>"},{"location":"cbom-generator/output/dependencies/#structure","title":"Structure","text":"<pre><code>{\n  \"dependencies\": [\n    {\n      \"ref\": \"service:nginx\",\n      \"dependsOn\": [\n        \"protocol:tls\",\n        \"library:openssl\"\n      ]\n    },\n    {\n      \"ref\": \"cipher:tls-ecdhe-rsa-with-aes-256-gcm-sha384\",\n      \"dependsOn\": [\n        \"algo:aes-256-gcm-256\",\n        \"algo:ecdhe\",\n        \"algo:rsa\",\n        \"algo:sha384\"\n      ]\n    }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/output/dependencies/#fields","title":"Fields","text":"Field Description <code>ref</code> Consumer component ID (bom-ref) <code>dependsOn</code> Array of provider component IDs"},{"location":"cbom-generator/output/dependencies/#human-readable-references-v11","title":"Human-Readable References (v1.1+)","text":"<p>In v1.1 and later, all refs use human-readable identifiers:</p> Before (v1.0) After (v1.1+) <code>5db9813bf30c...</code> <code>service:nginx</code> <code>a1b2c3d4e5f6...</code> <code>algo:aes-256-gcm-256</code> <p>This makes dependency graphs self-documenting.</p>"},{"location":"cbom-generator/output/dependencies/#dependency-chains","title":"Dependency Chains","text":""},{"location":"cbom-generator/output/dependencies/#service-to-algorithm","title":"Service to Algorithm","text":"<pre><code>service:nginx\n  \u2514\u2500\u2500 dependsOn \u2192 protocol:tls\n                      \u2514\u2500\u2500 dependsOn \u2192 cipher:tls-ecdhe-rsa-with-aes-256-gcm-sha384\n                                          \u2514\u2500\u2500 dependsOn \u2192 algo:aes-256-gcm-256\n                                          \u2514\u2500\u2500 dependsOn \u2192 algo:sha384\n</code></pre>"},{"location":"cbom-generator/output/dependencies/#application-to-library","title":"Application to Library","text":"<pre><code>app:curl\n  \u2514\u2500\u2500 dependsOn \u2192 library:openssl\n                      \u2514\u2500\u2500 dependsOn \u2192 algo:rsa\n                      \u2514\u2500\u2500 dependsOn \u2192 algo:aes-256-gcm-256\n</code></pre>"},{"location":"cbom-generator/output/dependencies/#semantics","title":"Semantics","text":"Direction Meaning <code>A</code> \u2192 <code>B</code> A depends on B (A is consumer, B is provider) Service \u2192 Protocol Service uses protocol Protocol \u2192 Cipher Protocol provides cipher suite Cipher \u2192 Algorithm Cipher uses algorithm App \u2192 Library Application links to library"},{"location":"cbom-generator/output/dependencies/#validation","title":"Validation","text":"<p>Dependencies are validated:</p> <ul> <li>No dangling refs: All refs must exist as components</li> <li>No self-dependencies: A component cannot depend on itself</li> <li>Sorted arrays: dependsOn arrays sorted alphabetically for determinism</li> </ul>"},{"location":"cbom-generator/output/dependencies/#common-queries","title":"Common Queries","text":""},{"location":"cbom-generator/output/dependencies/#find-all-service-dependencies","title":"Find All Service Dependencies","text":"<pre><code>cat cbom.json | jq '.dependencies[] | select(.ref | startswith(\"service:\"))'\n</code></pre>"},{"location":"cbom-generator/output/dependencies/#trace-algorithm-usage","title":"Trace Algorithm Usage","text":"<pre><code>cat cbom.json | jq '.dependencies[] |\n    select(.dependsOn[]? | contains(\"algo:sha256\")) |\n    .ref'\n</code></pre>"},{"location":"cbom-generator/output/dependencies/#count-dependencies-per-component","title":"Count Dependencies per Component","text":"<pre><code>cat cbom.json | jq '.dependencies[] |\n    {ref: .ref, count: (.dependsOn | length)}'\n</code></pre>"},{"location":"cbom-generator/output/dependencies/#find-components-with-most-dependencies","title":"Find Components with Most Dependencies","text":"<pre><code>cat cbom.json | jq '.dependencies |\n    sort_by(.dependsOn | length) |\n    reverse |\n    .[0:10] |\n    map({ref, count: (.dependsOn | length)})'\n</code></pre>"},{"location":"cbom-generator/output/dependencies/#full-dependency-tree-for-a-service","title":"Full Dependency Tree for a Service","text":"<pre><code>SERVICE=\"service:nginx\"\ncat cbom.json | jq --arg svc \"$SERVICE\" '\n    .dependencies[] | select(.ref == $svc) |\n    {service: .ref, dependencies: .dependsOn}'\n</code></pre>"},{"location":"cbom-generator/output/dependencies/#statistics","title":"Statistics","text":"<p>Dependency counts are included in metadata:</p> <pre><code>{\n  \"properties\": [\n    { \"name\": \"cbom:relationships:total\", \"value\": \"537\" },\n    { \"name\": \"cbom:dependencies:count\", \"value\": \"149\" }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/output/namespaced-properties/","title":"Namespaced Properties (cbom:*)","text":"<p>Extended properties using the <code>cbom:*</code> namespace provide additional detail.</p>"},{"location":"cbom-generator/output/namespaced-properties/#algorithm-properties","title":"Algorithm Properties","text":"<pre><code>{\n  \"name\": \"cbom:algo:primitive\",\n  \"value\": \"block-cipher\"\n},\n{\n  \"name\": \"cbom:algo:key_size\",\n  \"value\": \"256\"\n},\n{\n  \"name\": \"cbom:algo:is_weak\",\n  \"value\": \"false\"\n}\n</code></pre>"},{"location":"cbom-generator/output/namespaced-properties/#certificate-properties","title":"Certificate Properties","text":"<pre><code>{\n  \"name\": \"cbom:cert:signature_algorithm_oid\",\n  \"value\": \"1.2.840.113549.1.1.11\"\n},\n{\n  \"name\": \"cbom:cert:validity_state\",\n  \"value\": \"active\"\n},\n{\n  \"name\": \"cbom:cert:revocation_status\",\n  \"value\": \"GOOD\"\n}\n</code></pre> Property Values <code>validity_state</code> pre-activation, active, deactivated <code>revocation_status</code> GOOD, REVOKED, UNKNOWN"},{"location":"cbom-generator/output/namespaced-properties/#key-properties","title":"Key Properties","text":"<pre><code>{\n  \"name\": \"cbom:key:type\",\n  \"value\": \"RSA\"\n},\n{\n  \"name\": \"cbom:key:size\",\n  \"value\": \"2048\"\n},\n{\n  \"name\": \"cbom:key:storage_security\",\n  \"value\": \"encrypted\"\n},\n{\n  \"name\": \"cbom:key:is_weak\",\n  \"value\": \"false\"\n}\n</code></pre> storage_security Description <code>plaintext</code> Unencrypted file <code>encrypted</code> Password-protected <code>hsm</code> Hardware Security Module <code>tpm</code> Trusted Platform Module <code>keyring</code> OS keyring/keychain"},{"location":"cbom-generator/output/namespaced-properties/#protocol-properties","title":"Protocol Properties","text":"<pre><code>{\n  \"name\": \"cbom:proto:type\",\n  \"value\": \"TLS\"\n},\n{\n  \"name\": \"cbom:proto:version\",\n  \"value\": \"1.3\"\n},\n{\n  \"name\": \"cbom:proto:security_profile\",\n  \"value\": \"MODERN\"\n}\n</code></pre> security_profile Description <code>MODERN</code> TLS 1.3 only, strong ciphers <code>INTERMEDIATE</code> TLS 1.2+, good ciphers <code>OLD</code> TLS 1.0/1.1, weak ciphers"},{"location":"cbom-generator/output/namespaced-properties/#service-properties","title":"Service Properties","text":"<pre><code>{\n  \"name\": \"cbom:svc:name\",\n  \"value\": \"Apache HTTPD\"\n},\n{\n  \"name\": \"cbom:svc:version\",\n  \"value\": \"2.4.52\"\n},\n{\n  \"name\": \"cbom:svc:is_running\",\n  \"value\": \"true\"\n},\n{\n  \"name\": \"cbom:svc:port\",\n  \"value\": \"443\"\n},\n{\n  \"name\": \"cbom:svc:config_file\",\n  \"value\": \"/etc/apache2/sites-enabled/default-ssl.conf\"\n}\n</code></pre>"},{"location":"cbom-generator/output/namespaced-properties/#application-properties","title":"Application Properties","text":"<pre><code>{\n  \"name\": \"cbom:app:role\",\n  \"value\": \"service\"\n},\n{\n  \"name\": \"cbom:app:binary_path\",\n  \"value\": \"/usr/sbin/nginx\"\n},\n{\n  \"name\": \"cbom:app:detection_method\",\n  \"value\": \"BINARY_SCAN_PARALLEL\"\n}\n</code></pre> role Description <code>service</code> Network daemon <code>client</code> Client application <code>utility</code> Command-line tool"},{"location":"cbom-generator/output/namespaced-properties/#pqc-properties","title":"PQC Properties","text":"<pre><code>{\n  \"name\": \"cbom:pqc:status\",\n  \"value\": \"TRANSITIONAL\"\n},\n{\n  \"name\": \"cbom:pqc:alternative\",\n  \"value\": \"ML-DSA-65\"\n},\n{\n  \"name\": \"cbom:pqc:migration_urgency\",\n  \"value\": \"HIGH\"\n},\n{\n  \"name\": \"cbom:pqc:break_estimate\",\n  \"value\": \"2035\"\n},\n{\n  \"name\": \"cbom:pqc:rationale\",\n  \"value\": \"Quantum-vulnerable but meets current classical security standards\"\n}\n</code></pre> status Description <code>SAFE</code> Post-quantum secure <code>TRANSITIONAL</code> Classically strong, quantum-vulnerable <code>DEPRECATED</code> Broken/weak algorithms <code>UNSAFE</code> Quantum-vulnerable + weak"},{"location":"cbom-generator/output/namespaced-properties/#context-properties","title":"Context Properties","text":"<p>Detection provenance information:</p> <pre><code>{\n  \"name\": \"cbom:ctx:detection_method\",\n  \"value\": \"FILE_CONTENT\"\n},\n{\n  \"name\": \"cbom:ctx:confidence\",\n  \"value\": \"0.95\"\n},\n{\n  \"name\": \"cbom:ctx:scanner_name\",\n  \"value\": \"certificate_scanner\"\n}\n</code></pre> Detection Method Description Confidence <code>FILE_CONTENT</code> File parsing 0.95-1.0 <code>BINARY_SCAN_PARALLEL</code> ELF analysis 0.85-0.90 <code>KERNEL_CRYPTO_API</code> AF_ALG sockets 0.80 <code>STATIC_LINKED</code> Go/Rust crypto 0.75-0.85 <code>SYMBOL_ANALYSIS</code> Symbol table 0.70-0.80"},{"location":"cbom-generator/output/namespaced-properties/#common-queries","title":"Common Queries","text":""},{"location":"cbom-generator/output/namespaced-properties/#find-weak-components","title":"Find Weak Components","text":"<pre><code>cat cbom.json | jq '.components[] |\n    select(.properties[]? | select(.name == \"cbom:key:is_weak\" and .value == \"true\")) |\n    .name'\n</code></pre>"},{"location":"cbom-generator/output/namespaced-properties/#find-by-security-profile","title":"Find by Security Profile","text":"<pre><code>cat cbom.json | jq '.components[] |\n    select(.properties[]? | select(.name == \"cbom:proto:security_profile\" and .value == \"OLD\")) |\n    .name'\n</code></pre>"},{"location":"cbom-generator/output/namespaced-properties/#find-by-pqc-status","title":"Find by PQC Status","text":"<pre><code>cat cbom.json | jq '.components[] |\n    select(.properties[]? | select(.name == \"cbom:pqc:status\" and .value == \"DEPRECATED\")) |\n    .name'\n</code></pre>"},{"location":"cbom-generator/output/relationships/","title":"Relationships Array","text":"<p>The <code>relationships</code> array provides typed edges with confidence scores.</p>"},{"location":"cbom-generator/output/relationships/#structure","title":"Structure","text":"<pre><code>{\n  \"relationships\": [\n    {\n      \"type\": \"USES\",\n      \"source\": \"service|apache\",\n      \"target\": \"protocol|TLS\",\n      \"confidence\": \"0.95\"\n    },\n    {\n      \"type\": \"PROVIDES\",\n      \"source\": \"protocol|TLS\",\n      \"target\": \"cipher-suite-123\",\n      \"confidence\": \"0.95\"\n    },\n    {\n      \"type\": \"evidence\",\n      \"source\": \"/etc/ssl/cert.pem\",\n      \"target\": \"component-456\"\n    }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/output/relationships/#fields","title":"Fields","text":"Field Description <code>type</code> Relationship type <code>source</code> Source component or file path <code>target</code> Target component <code>confidence</code> Confidence score (0.0-1.0)"},{"location":"cbom-generator/output/relationships/#relationship-types","title":"Relationship Types","text":"Type Description Example <code>USES</code> Consumer uses provider Service uses protocol <code>PROVIDES</code> Provider offers capability Protocol provides cipher <code>DEPENDS_ON</code> Direct dependency App depends on library <code>AUTHENTICATES_WITH</code> Authentication Service uses certificate <code>CONFIGURES</code> Configuration Service configures protocol <code>SIGNS</code> Signing CA signs certificate <code>ISSUED_BY</code> Issuance Cert issued by CA <code>evidence</code> File evidence File contains component"},{"location":"cbom-generator/output/relationships/#confidence-scores","title":"Confidence Scores","text":"Range Meaning Example 0.95-1.0 Very high Direct file parsing 0.85-0.95 High Dynamic library analysis 0.75-0.85 Medium Static analysis 0.70-0.80 Lower Heuristic detection"},{"location":"cbom-generator/output/relationships/#relationship-examples","title":"Relationship Examples","text":""},{"location":"cbom-generator/output/relationships/#service-uses-protocol","title":"Service Uses Protocol","text":"<pre><code>{\n  \"type\": \"USES\",\n  \"source\": \"service|nginx\",\n  \"target\": \"protocol|TLS\",\n  \"confidence\": \"0.95\"\n}\n</code></pre>"},{"location":"cbom-generator/output/relationships/#protocol-provides-cipher-suite","title":"Protocol Provides Cipher Suite","text":"<pre><code>{\n  \"type\": \"PROVIDES\",\n  \"source\": \"protocol|TLS\",\n  \"target\": \"cipher:tls-aes-256-gcm-sha384\",\n  \"confidence\": \"0.95\"\n}\n</code></pre>"},{"location":"cbom-generator/output/relationships/#application-depends-on-library","title":"Application Depends on Library","text":"<pre><code>{\n  \"type\": \"DEPENDS_ON\",\n  \"source\": \"app|curl\",\n  \"target\": \"library|openssl\",\n  \"confidence\": \"0.90\"\n}\n</code></pre>"},{"location":"cbom-generator/output/relationships/#evidence-relationship","title":"Evidence Relationship","text":"<pre><code>{\n  \"type\": \"evidence\",\n  \"source\": \"/etc/ssl/certs/ca-certificates.crt\",\n  \"target\": \"cert:digicert-global-root-ca\"\n}\n</code></pre>"},{"location":"cbom-generator/output/relationships/#dependencies-vs-relationships","title":"Dependencies vs Relationships","text":"Feature dependencies relationships Format Array of arrays Array of objects Types Implicit \"depends on\" Explicit type field Confidence Not included Included Purpose CycloneDX standard Extended detail <p>Both represent the same graph, but <code>relationships</code> provides more detail.</p>"},{"location":"cbom-generator/output/relationships/#common-queries","title":"Common Queries","text":""},{"location":"cbom-generator/output/relationships/#find-all-uses-relationships","title":"Find All USES Relationships","text":"<pre><code>cat cbom.json | jq '.relationships[] | select(.type == \"USES\")'\n</code></pre>"},{"location":"cbom-generator/output/relationships/#find-high-confidence-relationships","title":"Find High-Confidence Relationships","text":"<pre><code>cat cbom.json | jq '.relationships[] |\n    select(.confidence | tonumber &gt; 0.9)'\n</code></pre>"},{"location":"cbom-generator/output/relationships/#find-evidence-for-a-component","title":"Find Evidence for a Component","text":"<pre><code>cat cbom.json | jq '.relationships[] |\n    select(.type == \"evidence\" and .target | contains(\"digicert\"))'\n</code></pre>"},{"location":"cbom-generator/output/relationships/#count-relationships-by-type","title":"Count Relationships by Type","text":"<pre><code>cat cbom.json | jq '[.relationships[].type] |\n    group_by(.) |\n    map({type: .[0], count: length})'\n</code></pre>"},{"location":"cbom-generator/output/relationships/#statistics","title":"Statistics","text":"<p>Relationship counts in metadata:</p> <pre><code>{\n  \"properties\": [\n    { \"name\": \"cbom:relationships:total\", \"value\": \"537\" },\n    { \"name\": \"cbom:relationships:uses\", \"value\": \"245\" },\n    { \"name\": \"cbom:relationships:provides\", \"value\": \"189\" },\n    { \"name\": \"cbom:relationships:depends_on\", \"value\": \"103\" }\n  ]\n}\n</code></pre>"},{"location":"cbom-generator/playbooks/","title":"Playbooks","text":"<p>Step-by-step migration guides for common cryptographic transitions.</p>"},{"location":"cbom-generator/playbooks/#available-playbooks","title":"Available Playbooks","text":"Playbook Description OpenSSH PQC Migration Enable Post-Quantum key exchange in SSH TLS Upgrade Guide Migrate from TLS 1.0/1.1 to TLS 1.3 Certificate Rotation Plan and execute certificate lifecycle FIPS Compliance Validate FIPS 140-2/3 compliance"},{"location":"cbom-generator/playbooks/#using-cbom-generator-with-playbooks","title":"Using CBOM Generator with Playbooks","text":"<p>Each playbook follows this pattern:</p> <ol> <li>Assess: Run CBOM scan to establish baseline</li> <li>Plan: Identify components needing migration</li> <li>Execute: Make configuration changes</li> <li>Verify: Re-scan to confirm improvements</li> </ol>"},{"location":"cbom-generator/playbooks/#common-commands","title":"Common Commands","text":""},{"location":"cbom-generator/playbooks/#baseline-scan","title":"Baseline Scan","text":"<pre><code>./build/cbom-generator \\\n    --discover-services \\\n    --plugin-dir plugins \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --no-personal-data \\\n    --pqc-report baseline-report.txt \\\n    --output baseline-cbom.json\n</code></pre>"},{"location":"cbom-generator/playbooks/#verification-scan","title":"Verification Scan","text":"<pre><code>./build/cbom-generator \\\n    --discover-services \\\n    --plugin-dir plugins \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --no-personal-data \\\n    --pqc-report after-migration-report.txt \\\n    --output after-migration-cbom.json\n</code></pre>"},{"location":"cbom-generator/playbooks/#compare-beforeafter","title":"Compare Before/After","text":"<pre><code># Compare PQC readiness scores\ncat baseline-cbom.json | jq '.metadata.properties[] | select(.name == \"cbom:pqc:readiness_score\")'\ncat after-migration-cbom.json | jq '.metadata.properties[] | select(.name == \"cbom:pqc:readiness_score\")'\n</code></pre>"},{"location":"cbom-generator/playbooks/#migration-priority-framework","title":"Migration Priority Framework","text":"Priority Break Year Action Timeline CRITICAL 2030 Immediate (within 6 months) HIGH 2035 Plan now (within 12 months) MEDIUM 2040 Schedule (within 24 months) LOW 2045+ Monitor (plan for future)"},{"location":"cbom-generator/playbooks/certificate-rotation/","title":"Certificate Rotation","text":"<p>Plan and execute certificate lifecycle management using CBOM Generator.</p>"},{"location":"cbom-generator/playbooks/certificate-rotation/#prerequisites","title":"Prerequisites","text":"<ul> <li>CBOM Generator installed</li> <li>Access to certificate authority or ACME provider</li> <li>Root access for certificate deployment</li> </ul>"},{"location":"cbom-generator/playbooks/certificate-rotation/#step-1-identify-expiring-certificates","title":"Step 1: Identify Expiring Certificates","text":"<p>Run CBOM scan:</p> <pre><code>./build/cbom-generator \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --no-personal-data \\\n    --output cert-inventory.json /etc/ssl /etc/pki\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#find-certificates-expiring-soon","title":"Find Certificates Expiring Soon","text":"<pre><code># Certificates expiring within 30 days\nEXPIRE_DATE=$(date -d \"+30 days\" --iso-8601)\ncat cert-inventory.json | jq --arg exp \"$EXPIRE_DATE\" '.components[] |\n    select(.cryptoProperties?.certificateProperties?.notValidAfter &lt; $exp) |\n    select(.cryptoProperties?.certificateProperties != null) |\n    {name, expires: .cryptoProperties.certificateProperties.notValidAfter,\n     location: .evidence.occurrences[0].location}'\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#find-already-expired-certificates","title":"Find Already Expired Certificates","text":"<pre><code>cat cert-inventory.json | jq '.components[] |\n    select(.cryptoProperties?.certificateProperties?.certificateState[0]?.state == \"deactivated\") |\n    {name, state: \"EXPIRED\", location: .evidence.occurrences[0].location}'\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#step-2-plan-rotation-schedule","title":"Step 2: Plan Rotation Schedule","text":""},{"location":"cbom-generator/playbooks/certificate-rotation/#priority-matrix","title":"Priority Matrix","text":"Expiration Priority Action &lt; 7 days Critical Immediate rotation 7-30 days High Schedule this week 30-90 days Medium Schedule this month &gt; 90 days Low Plan future rotation"},{"location":"cbom-generator/playbooks/certificate-rotation/#export-rotation-candidates","title":"Export Rotation Candidates","text":"<pre><code>cat cert-inventory.json | jq -r '.components[] |\n    select(.cryptoProperties?.certificateProperties != null) |\n    \"\\(.name),\\(.cryptoProperties.certificateProperties.notValidAfter),\\(.evidence.occurrences[0].location)\"' \\\n    | sort -t',' -k2 &gt; rotation-schedule.csv\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#step-3-generate-new-certificates","title":"Step 3: Generate New Certificates","text":""},{"location":"cbom-generator/playbooks/certificate-rotation/#option-a-self-signed-development","title":"Option A: Self-Signed (Development)","text":"<pre><code># Generate new private key\nopenssl genrsa -out new-server.key 2048\n\n# Generate CSR\nopenssl req -new -key new-server.key -out new-server.csr \\\n    -subj \"/CN=server.example.com\"\n\n# Self-sign (for testing)\nopenssl x509 -req -days 365 -in new-server.csr \\\n    -signkey new-server.key -out new-server.crt\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#option-b-acmelets-encrypt","title":"Option B: ACME/Let's Encrypt","text":"<pre><code># Using certbot\nsudo certbot certonly --webroot -w /var/www/html \\\n    -d server.example.com \\\n    --cert-name server\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#option-c-enterprise-ca","title":"Option C: Enterprise CA","text":"<p>Follow your organization's certificate request process.</p>"},{"location":"cbom-generator/playbooks/certificate-rotation/#step-4-deploy-new-certificates","title":"Step 4: Deploy New Certificates","text":""},{"location":"cbom-generator/playbooks/certificate-rotation/#backup-existing-certificates","title":"Backup Existing Certificates","text":"<pre><code>BACKUP_DIR=\"/etc/ssl/backup-$(date +%Y%m%d)\"\nsudo mkdir -p $BACKUP_DIR\nsudo cp /etc/ssl/certs/server.crt $BACKUP_DIR/\nsudo cp /etc/ssl/private/server.key $BACKUP_DIR/\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#deploy-new-certificates","title":"Deploy New Certificates","text":"<pre><code>sudo cp new-server.crt /etc/ssl/certs/server.crt\nsudo cp new-server.key /etc/ssl/private/server.key\nsudo chmod 600 /etc/ssl/private/server.key\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#update-service-configurations-if-needed","title":"Update Service Configurations (if needed)","text":"<p>Verify certificate paths in service configs:</p> <pre><code># Nginx\ngrep ssl_certificate /etc/nginx/sites-enabled/*\n\n# Apache\ngrep SSLCertificate /etc/apache2/sites-enabled/*\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#step-5-restart-services","title":"Step 5: Restart Services","text":"<pre><code># Test configurations\nsudo nginx -t\nsudo apachectl configtest\n\n# Restart services\nsudo systemctl restart nginx\nsudo systemctl restart apache2\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#step-6-verify-with-cbom-scan","title":"Step 6: Verify with CBOM Scan","text":"<p>Re-run inventory:</p> <pre><code>./build/cbom-generator \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --no-personal-data \\\n    --output cert-after-rotation.json /etc/ssl /etc/pki\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#verify-new-certificate-detected","title":"Verify New Certificate Detected","text":"<pre><code>cat cert-after-rotation.json | jq '.components[] |\n    select(.name | contains(\"server.example.com\")) |\n    {name,\n     valid_from: .cryptoProperties.certificateProperties.notValidBefore,\n     valid_to: .cryptoProperties.certificateProperties.notValidAfter,\n     state: .cryptoProperties.certificateProperties.certificateState[0].state}'\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#step-7-verify-external-connectivity","title":"Step 7: Verify External Connectivity","text":"<pre><code># Test TLS connection\nopenssl s_client -connect server.example.com:443 -servername server.example.com &lt;/dev/null 2&gt;/dev/null | \\\n    openssl x509 -noout -dates\n\n# Check certificate chain\nopenssl s_client -connect server.example.com:443 -servername server.example.com &lt;/dev/null 2&gt;/dev/null | \\\n    openssl x509 -noout -text | grep -E \"Subject:|Issuer:|Not Before:|Not After:\"\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#automated-monitoring","title":"Automated Monitoring","text":""},{"location":"cbom-generator/playbooks/certificate-rotation/#set-up-expiration-alerts","title":"Set Up Expiration Alerts","text":"<p>Create a monitoring script:</p> <pre><code>#!/bin/bash\n# cert-monitor.sh\n\n./build/cbom-generator \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --no-personal-data \\\n    --output /tmp/cert-check.json /etc/ssl /etc/pki 2&gt;/dev/null\n\nEXPIRE_DATE=$(date -d \"+30 days\" --iso-8601)\nEXPIRING=$(cat /tmp/cert-check.json | jq --arg exp \"$EXPIRE_DATE\" \\\n    '[.components[] |\n     select(.cryptoProperties?.certificateProperties?.notValidAfter &lt; $exp) |\n     select(.cryptoProperties?.certificateProperties != null)] | length')\n\nif [ \"$EXPIRING\" -gt 0 ]; then\n    echo \"WARNING: $EXPIRING certificates expiring within 30 days\"\n    exit 1\nfi\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#schedule-with-cron","title":"Schedule with Cron","text":"<pre><code># Run weekly\n0 0 * * 0 /path/to/cert-monitor.sh\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#rollback-plan","title":"Rollback Plan","text":"<p>If issues occur after rotation:</p> <pre><code># Restore from backup\nsudo cp $BACKUP_DIR/server.crt /etc/ssl/certs/server.crt\nsudo cp $BACKUP_DIR/server.key /etc/ssl/private/server.key\n\n# Restart services\nsudo systemctl restart nginx\nsudo systemctl restart apache2\n</code></pre>"},{"location":"cbom-generator/playbooks/certificate-rotation/#success-criteria","title":"Success Criteria","text":"<ul> <li>[ ] All expiring certificates identified</li> <li>[ ] New certificates generated with adequate validity</li> <li>[ ] Certificates deployed to correct locations</li> <li>[ ] Services restarted successfully</li> <li>[ ] CBOM shows new certificates as \"active\"</li> <li>[ ] External connectivity verified</li> <li>[ ] Monitoring in place for future expirations</li> </ul>"},{"location":"cbom-generator/playbooks/fips-compliance/","title":"FIPS Compliance Validation","text":"<p>Validate FIPS 140-2/3 compliance using CBOM Generator.</p>"},{"location":"cbom-generator/playbooks/fips-compliance/#overview","title":"Overview","text":"<p>FIPS 140-2/3 (Federal Information Processing Standards) are U.S. government security standards for cryptographic modules. Many organizations require FIPS compliance for:</p> <ul> <li>Government contracts</li> <li>Financial services</li> <li>Healthcare (HIPAA)</li> <li>Critical infrastructure</li> </ul>"},{"location":"cbom-generator/playbooks/fips-compliance/#prerequisites","title":"Prerequisites","text":"<ul> <li>CBOM Generator installed</li> <li>Root access for system scanning</li> <li>Understanding of your compliance requirements</li> </ul>"},{"location":"cbom-generator/playbooks/fips-compliance/#step-1-scan-for-fips-certified-libraries","title":"Step 1: Scan for FIPS-Certified Libraries","text":"<p>Run comprehensive CBOM scan:</p> <pre><code>./build/cbom-generator \\\n    --discover-services \\\n    --plugin-dir plugins \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --no-personal-data \\\n    --output fips-assessment.json\n</code></pre>"},{"location":"cbom-generator/playbooks/fips-compliance/#find-libraries-with-fips-status","title":"Find Libraries with FIPS Status","text":"<pre><code>cat fips-assessment.json | jq '.components[] |\n    select(.type == \"library\") |\n    {name, version,\n     fips_status: [.properties[] | select(.name | contains(\"fips\"))][0].value // \"NOT_VALIDATED\"}'\n</code></pre>"},{"location":"cbom-generator/playbooks/fips-compliance/#step-2-identify-non-compliant-algorithms","title":"Step 2: Identify Non-Compliant Algorithms","text":""},{"location":"cbom-generator/playbooks/fips-compliance/#find-deprecated-algorithms","title":"Find Deprecated Algorithms","text":"<pre><code>cat fips-assessment.json | jq '.components[] |\n    select(.properties[]? | select(.name == \"cbom:pqc:status\" and .value == \"DEPRECATED\")) |\n    {name, reason: [.properties[] | select(.name == \"cbom:pqc:rationale\")][0].value}'\n</code></pre>"},{"location":"cbom-generator/playbooks/fips-compliance/#check-for-banned-algorithms","title":"Check for Banned Algorithms","text":"<p>FIPS prohibits certain algorithms:</p> Algorithm Status Replacement MD5 Banned SHA-256+ SHA-1 Deprecated SHA-256+ DES Banned AES 3DES Limited (2023 cutoff) AES RC4 Banned AES-GCM RSA &lt; 2048 Banned RSA-2048+ <pre><code># Find banned algorithms\ncat fips-assessment.json | jq '.components[] |\n    select(.name | test(\"MD5|DES|RC4|SHA-1\"; \"i\")) |\n    {name, location: .evidence.occurrences[0].location}'\n</code></pre>"},{"location":"cbom-generator/playbooks/fips-compliance/#step-3-verify-approved-algorithms","title":"Step 3: Verify Approved Algorithms","text":""},{"location":"cbom-generator/playbooks/fips-compliance/#fips-140-23-approved-algorithms","title":"FIPS 140-2/3 Approved Algorithms","text":"Category Approved Symmetric AES (128, 192, 256) Hash SHA-256, SHA-384, SHA-512, SHA-3 Signature RSA (2048+), ECDSA (P-256+) Key Agreement ECDH, DH (2048+) MAC HMAC-SHA-256+ KDF PBKDF2, HKDF <pre><code># Count approved vs non-approved\ncat fips-assessment.json | jq '\n    [.components[] |\n     select(.cryptoProperties?.assetType == \"algorithm\") |\n     if (.name | test(\"AES|SHA-256|SHA-384|SHA-512|ECDSA|RSA-[2-9][0-9]{3}\"; \"i\"))\n     then \"APPROVED\" else \"REVIEW\" end] |\n    group_by(.) |\n    map({status: .[0], count: length})'\n</code></pre>"},{"location":"cbom-generator/playbooks/fips-compliance/#step-4-check-service-configurations","title":"Step 4: Check Service Configurations","text":""},{"location":"cbom-generator/playbooks/fips-compliance/#verify-tls-cipher-suites","title":"Verify TLS Cipher Suites","text":"<p>FIPS-approved TLS cipher suites:</p> <pre><code>cat fips-assessment.json | jq '.components[] |\n    select(.[\"bom-ref\"] | startswith(\"cipher:\")) |\n    select(.name | test(\"AES.*GCM|AES.*CBC\"; \"i\")) |\n    .name' | sort | uniq\n</code></pre>"},{"location":"cbom-generator/playbooks/fips-compliance/#check-ssh-algorithms","title":"Check SSH Algorithms","text":"<pre><code>cat fips-assessment.json | jq '.components[] |\n    select(.name | test(\"ssh|sshd\"; \"i\")) |\n    {name, ciphers: [.properties[] | select(.name | contains(\"cipher\"))][0].value}'\n</code></pre>"},{"location":"cbom-generator/playbooks/fips-compliance/#step-5-replace-non-compliant-algorithms","title":"Step 5: Replace Non-Compliant Algorithms","text":""},{"location":"cbom-generator/playbooks/fips-compliance/#update-openssl-configuration","title":"Update OpenSSL Configuration","text":"<p>For FIPS mode (OpenSSL 3.0+):</p> <pre><code># Enable FIPS provider\nsudo nano /etc/ssl/openssl.cnf\n</code></pre> <p>Add:</p> <pre><code>[provider_sect]\ndefault = default_sect\nfips = fips_sect\nbase = base_sect\n\n[fips_sect]\nactivate = 1\n\n[base_sect]\nactivate = 1\n\n[default_sect]\nactivate = 1\n</code></pre>"},{"location":"cbom-generator/playbooks/fips-compliance/#update-application-configurations","title":"Update Application Configurations","text":"<p>Ensure services use FIPS-approved algorithms only:</p> <p>Apache: <pre><code>SSLCipherSuite ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256\n</code></pre></p> <p>Nginx: <pre><code>ssl_ciphers ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;\n</code></pre></p>"},{"location":"cbom-generator/playbooks/fips-compliance/#step-6-validate-compliance","title":"Step 6: Validate Compliance","text":"<p>Re-run CBOM scan:</p> <pre><code>./build/cbom-generator \\\n    --discover-services \\\n    --plugin-dir plugins \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --no-personal-data \\\n    --output fips-after-remediation.json\n</code></pre>"},{"location":"cbom-generator/playbooks/fips-compliance/#generate-compliance-report","title":"Generate Compliance Report","text":"<pre><code># Summary statistics\necho \"=== FIPS Compliance Summary ===\"\n\necho \"Deprecated algorithms:\"\ncat fips-after-remediation.json | jq '[.components[] |\n    select(.properties[]? | select(.name == \"cbom:pqc:status\" and .value == \"DEPRECATED\"))] | length'\n\necho \"Weak/Unsafe algorithms:\"\ncat fips-after-remediation.json | jq '[.components[] |\n    select(.properties[]? | select(.name == \"cbom:pqc:status\" and .value == \"UNSAFE\"))] | length'\n\necho \"Approved algorithms:\"\ncat fips-after-remediation.json | jq '[.components[] |\n    select(.cryptoProperties?.assetType == \"algorithm\") |\n    select(.name | test(\"AES|SHA-256|SHA-384|SHA-512|ECDSA|RSA-[2-9]\"; \"i\"))] | length'\n</code></pre>"},{"location":"cbom-generator/playbooks/fips-compliance/#step-7-generate-audit-report","title":"Step 7: Generate Audit Report","text":"<p>Create documentation for auditors:</p> <pre><code># Export compliance evidence\ncat fips-after-remediation.json | jq '{\n    scan_date: .metadata.timestamp,\n    total_components: (.components | length),\n    libraries: [.components[] | select(.type == \"library\") | {name, version}],\n    algorithms: [.components[] | select(.cryptoProperties?.assetType == \"algorithm\") | .name] | unique,\n    deprecated_count: [.components[] | select(.properties[]? | select(.name == \"cbom:pqc:status\" and .value == \"DEPRECATED\"))] | length,\n    unsafe_count: [.components[] | select(.properties[]? | select(.name == \"cbom:pqc:status\" and .value == \"UNSAFE\"))] | length\n}' &gt; fips-audit-report.json\n</code></pre>"},{"location":"cbom-generator/playbooks/fips-compliance/#nist-cmvp-certification","title":"NIST CMVP Certification","text":"<p>The NIST Cryptographic Module Validation Program (CMVP) validates cryptographic modules.</p>"},{"location":"cbom-generator/playbooks/fips-compliance/#check-for-validated-modules","title":"Check for Validated Modules","text":"<p>Visit: https://csrc.nist.gov/projects/cryptographic-module-validation-program/validated-modules</p> <p>Common validated modules: - OpenSSL FIPS Provider - libgcrypt FIPS mode - AWS-LC FIPS - NSS FIPS mode</p>"},{"location":"cbom-generator/playbooks/fips-compliance/#success-criteria","title":"Success Criteria","text":"<ul> <li>[ ] No deprecated algorithms (MD5, SHA-1, DES, RC4)</li> <li>[ ] All RSA keys &gt;= 2048 bits</li> <li>[ ] All ECDSA keys &gt;= P-256</li> <li>[ ] FIPS-approved cipher suites only</li> <li>[ ] FIPS provider enabled (OpenSSL 3.0+)</li> <li>[ ] Audit report generated</li> <li>[ ] Documentation for compliance evidence</li> </ul>"},{"location":"cbom-generator/playbooks/fips-compliance/#important-note","title":"Important Note","text":"<p>CBOM Generator provides stub metadata for FIPS certification status. Actual FIPS validation must be verified against the NIST CMVP database and your organization's compliance requirements.</p>"},{"location":"cbom-generator/playbooks/migrating-openssh/","title":"OpenSSH PQC Migration","text":"<p>Enable Post-Quantum key exchange in OpenSSH to protect against future quantum computer attacks.</p>"},{"location":"cbom-generator/playbooks/migrating-openssh/#prerequisites","title":"Prerequisites","text":"<ul> <li>OpenSSH 9.0 or later (includes sntrup761 hybrid KEX)</li> <li>CBOM Generator installed</li> <li>Root access for SSH configuration</li> </ul>"},{"location":"cbom-generator/playbooks/migrating-openssh/#check-openssh-version","title":"Check OpenSSH Version","text":"<pre><code>ssh -V\n# OpenSSH_9.0p1, OpenSSL 3.0.2 15 Mar 2022\n</code></pre>"},{"location":"cbom-generator/playbooks/migrating-openssh/#step-1-assess-current-ssh-crypto-posture","title":"Step 1: Assess Current SSH Crypto Posture","text":"<p>Run CBOM scan to identify current SSH configuration:</p> <pre><code>./build/cbom-generator \\\n    --discover-services \\\n    --plugin-dir plugins \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --pqc-report ssh-baseline.txt \\\n    --output ssh-baseline.json /etc/ssh\n</code></pre>"},{"location":"cbom-generator/playbooks/migrating-openssh/#check-current-kex-algorithms","title":"Check Current KEX Algorithms","text":"<pre><code>cat ssh-baseline.json | jq '.components[] |\n    select(.name | test(\"ssh|sshd\"; \"i\")) |\n    {name, pqc_status: [.properties[] | select(.name == \"cbom:pqc:status\")][0].value}'\n</code></pre>"},{"location":"cbom-generator/playbooks/migrating-openssh/#view-current-ssh-config","title":"View Current SSH Config","text":"<pre><code>grep -E \"^(KexAlgorithms|Ciphers|MACs)\" /etc/ssh/sshd_config\n</code></pre>"},{"location":"cbom-generator/playbooks/migrating-openssh/#step-2-enable-hybrid-pqc-key-exchange","title":"Step 2: Enable Hybrid PQC Key Exchange","text":"<p>Edit the SSH server configuration:</p> <pre><code>sudo nano /etc/ssh/sshd_config\n</code></pre> <p>Add or modify the KexAlgorithms line:</p> <pre><code># Enable hybrid PQC KEX (NTRU Prime + X25519) as first priority\nKexAlgorithms sntrup761x25519-sha512@openssh.com,curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512\n</code></pre>"},{"location":"cbom-generator/playbooks/migrating-openssh/#understanding-the-algorithm-order","title":"Understanding the Algorithm Order","text":"Position Algorithm Security 1st sntrup761x25519-sha512@openssh.com PQC SAFE (hybrid) 2nd curve25519-sha256 Classical (quantum-vulnerable) 3rd+ Fallbacks For older client compatibility"},{"location":"cbom-generator/playbooks/migrating-openssh/#step-3-update-client-configuration-optional","title":"Step 3: Update Client Configuration (Optional)","text":"<p>For system-wide client PQC:</p> <pre><code>sudo nano /etc/ssh/ssh_config\n</code></pre> <p>Add:</p> <pre><code># System-wide SSH client PQC KEX\nKexAlgorithms sntrup761x25519-sha512@openssh.com,curve25519-sha256,curve25519-sha256@libssh.org\n</code></pre> <p>For user-specific configuration:</p> <pre><code>nano ~/.ssh/config\n</code></pre> <p>Add to host sections:</p> <pre><code>Host *\n    KexAlgorithms sntrup761x25519-sha512@openssh.com,curve25519-sha256\n</code></pre>"},{"location":"cbom-generator/playbooks/migrating-openssh/#step-4-restart-ssh-service","title":"Step 4: Restart SSH Service","text":"<pre><code># Test configuration first\nsudo sshd -t\n\n# If test passes, restart\nsudo systemctl restart sshd\n\n# Verify service is running\nsudo systemctl status sshd\n</code></pre>"},{"location":"cbom-generator/playbooks/migrating-openssh/#step-5-verify-with-cbom-scan","title":"Step 5: Verify with CBOM Scan","text":"<p>Re-run the CBOM scan:</p> <pre><code>./build/cbom-generator \\\n    --discover-services \\\n    --plugin-dir plugins \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --pqc-report ssh-after-migration.txt \\\n    --output ssh-after-migration.json /etc/ssh\n</code></pre>"},{"location":"cbom-generator/playbooks/migrating-openssh/#verify-pqc-status","title":"Verify PQC Status","text":"<pre><code>cat ssh-after-migration.json | jq '.components[] |\n    select(.name | test(\"sshd|openssh\"; \"i\")) |\n    {name, pqc_status: [.properties[] | select(.name == \"cbom:pqc:status\")][0].value,\n     rationale: [.properties[] | select(.name == \"cbom:pqc:rationale\")][0].value}'\n</code></pre> <p>Expected output:</p> <pre><code>{\n  \"name\": \"sshd\",\n  \"pqc_status\": \"SAFE\",\n  \"rationale\": \"PQC-ready via sntrup761x25519-sha512@openssh.com\"\n}\n</code></pre>"},{"location":"cbom-generator/playbooks/migrating-openssh/#step-6-test-pqc-negotiation","title":"Step 6: Test PQC Negotiation","text":"<p>Connect and verify the KEX algorithm:</p> <pre><code>ssh -vvv localhost 2&gt;&amp;1 | grep \"kex:\"\n# Should show: kex: algorithm: sntrup761x25519-sha512@openssh.com\n</code></pre>"},{"location":"cbom-generator/playbooks/migrating-openssh/#rollback-plan","title":"Rollback Plan","text":"<p>If issues occur, revert to classical-only KEX:</p> <pre><code># /etc/ssh/sshd_config\nKexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group16-sha512\n\n# Restart\nsudo systemctl restart sshd\n</code></pre>"},{"location":"cbom-generator/playbooks/migrating-openssh/#compatibility-notes","title":"Compatibility Notes","text":"Client Version PQC KEX Support OpenSSH 9.0+ Full (sntrup761) OpenSSH 8.5-8.9 Experimental (may need compile flag) OpenSSH &lt; 8.5 No (falls back to curve25519) <p>When connecting to systems with older OpenSSH, the hybrid KEX will fall back gracefully to curve25519-sha256.</p>"},{"location":"cbom-generator/playbooks/migrating-openssh/#success-criteria","title":"Success Criteria","text":"<ul> <li>[ ] sshd_config contains sntrup761 as first KEX algorithm</li> <li>[ ] SSH service restart successful</li> <li>[ ] CBOM shows sshd with <code>cbom:pqc:status = SAFE</code></li> <li>[ ] Test connection shows sntrup761 KEX negotiation</li> <li>[ ] PQC readiness score improved</li> </ul>"},{"location":"cbom-generator/playbooks/tls-upgrade/","title":"TLS Upgrade Guide","text":"<p>Migrate from deprecated TLS 1.0/1.1 to TLS 1.2/1.3 for improved security.</p>"},{"location":"cbom-generator/playbooks/tls-upgrade/#prerequisites","title":"Prerequisites","text":"<ul> <li>CBOM Generator installed</li> <li>Root access for service configuration</li> <li>Modern OpenSSL (1.1.1+ for TLS 1.3)</li> </ul>"},{"location":"cbom-generator/playbooks/tls-upgrade/#step-1-inventory-current-tls-versions","title":"Step 1: Inventory Current TLS Versions","text":"<p>Run CBOM scan with service discovery:</p> <pre><code>./build/cbom-generator \\\n    --discover-services \\\n    --plugin-dir plugins \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --no-personal-data \\\n    --output tls-baseline.json\n</code></pre>"},{"location":"cbom-generator/playbooks/tls-upgrade/#find-services-with-deprecated-tls","title":"Find Services with Deprecated TLS","text":"<pre><code>cat tls-baseline.json | jq -r '.components[] |\n    select(.properties[]? |\n        select(.name == \"cbom:proto:security_profile\" and .value == \"OLD\")) |\n    \"\\(.name) - \\(.properties[] | select(.name == \"cbom:svc:config_file\").value // \"N/A\")\"'\n</code></pre>"},{"location":"cbom-generator/playbooks/tls-upgrade/#list-tls-version-distribution","title":"List TLS Version Distribution","text":"<pre><code>cat tls-baseline.json | jq '[.components[] |\n    select(.cryptoProperties?.protocolProperties?.type == \"tls\") |\n    .cryptoProperties.protocolProperties.version] |\n    group_by(.) |\n    map({version: .[0], count: length})'\n</code></pre>"},{"location":"cbom-generator/playbooks/tls-upgrade/#step-2-identify-tls-1011-services","title":"Step 2: Identify TLS 1.0/1.1 Services","text":""},{"location":"cbom-generator/playbooks/tls-upgrade/#apache-httpd","title":"Apache HTTPD","text":"<pre><code>grep -r \"SSLProtocol\" /etc/apache2/\n</code></pre>"},{"location":"cbom-generator/playbooks/tls-upgrade/#nginx","title":"Nginx","text":"<pre><code>grep -r \"ssl_protocols\" /etc/nginx/\n</code></pre>"},{"location":"cbom-generator/playbooks/tls-upgrade/#postfix","title":"Postfix","text":"<pre><code>grep \"smtpd_tls_protocols\\|smtp_tls_protocols\" /etc/postfix/main.cf\n</code></pre>"},{"location":"cbom-generator/playbooks/tls-upgrade/#step-3-update-service-configurations","title":"Step 3: Update Service Configurations","text":""},{"location":"cbom-generator/playbooks/tls-upgrade/#apache-httpd_1","title":"Apache HTTPD","text":"<p>Edit SSL configuration:</p> <pre><code>sudo nano /etc/apache2/sites-available/default-ssl.conf\n</code></pre> <p>Update:</p> <pre><code># Disable TLS 1.0/1.1, enable TLS 1.2/1.3\nSSLProtocol -all +TLSv1.2 +TLSv1.3\n\n# Modern cipher suite\nSSLCipherSuite ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384\n\n# Server preference\nSSLHonorCipherOrder on\n</code></pre>"},{"location":"cbom-generator/playbooks/tls-upgrade/#nginx_1","title":"Nginx","text":"<p>Edit server block:</p> <pre><code>sudo nano /etc/nginx/sites-available/default\n</code></pre> <p>Update:</p> <pre><code># TLS 1.2 and 1.3 only\nssl_protocols TLSv1.2 TLSv1.3;\n\n# Modern cipher suite\nssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384;\n\n# Server preference\nssl_prefer_server_ciphers on;\n</code></pre>"},{"location":"cbom-generator/playbooks/tls-upgrade/#postfix_1","title":"Postfix","text":"<p>Edit main.cf:</p> <pre><code>sudo nano /etc/postfix/main.cf\n</code></pre> <p>Update:</p> <pre><code># TLS 1.2+ for both SMTP submission and relay\nsmtpd_tls_protocols = !SSLv2, !SSLv3, !TLSv1, !TLSv1.1\nsmtp_tls_protocols = !SSLv2, !SSLv3, !TLSv1, !TLSv1.1\nsmtpd_tls_mandatory_protocols = !SSLv2, !SSLv3, !TLSv1, !TLSv1.1\nsmtp_tls_mandatory_protocols = !SSLv2, !SSLv3, !TLSv1, !TLSv1.1\n</code></pre>"},{"location":"cbom-generator/playbooks/tls-upgrade/#step-4-verify-cipher-suite-strength","title":"Step 4: Verify Cipher Suite Strength","text":""},{"location":"cbom-generator/playbooks/tls-upgrade/#check-for-weak-ciphers","title":"Check for Weak Ciphers","text":"<pre><code>cat tls-baseline.json | jq '.components[] |\n    select(.[\"bom-ref\"] | startswith(\"cipher:\")) |\n    select(.properties[]? | select(.name == \"cbom:pqc:status\" and .value == \"DEPRECATED\")) |\n    .name'\n</code></pre>"},{"location":"cbom-generator/playbooks/tls-upgrade/#recommended-cipher-suites","title":"Recommended Cipher Suites","text":"Profile TLS 1.3 TLS 1.2 Modern TLS_AES_256_GCM_SHA384 ECDHE-ECDSA-AES256-GCM-SHA384 Modern TLS_CHACHA20_POLY1305_SHA256 ECDHE-RSA-AES256-GCM-SHA384 Modern TLS_AES_128_GCM_SHA256 ECDHE-ECDSA-AES128-GCM-SHA256"},{"location":"cbom-generator/playbooks/tls-upgrade/#step-5-restart-services","title":"Step 5: Restart Services","text":"<pre><code># Test configurations first\nsudo apachectl configtest\nsudo nginx -t\nsudo postfix check\n\n# Restart services\nsudo systemctl restart apache2\nsudo systemctl restart nginx\nsudo systemctl restart postfix\n</code></pre>"},{"location":"cbom-generator/playbooks/tls-upgrade/#step-6-validate-with-cbom-scan","title":"Step 6: Validate with CBOM Scan","text":"<p>Re-run the scan:</p> <pre><code>./build/cbom-generator \\\n    --discover-services \\\n    --plugin-dir plugins \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --no-personal-data \\\n    --output tls-after-upgrade.json\n</code></pre>"},{"location":"cbom-generator/playbooks/tls-upgrade/#verify-no-old-security-profiles","title":"Verify No OLD Security Profiles","text":"<pre><code>cat tls-after-upgrade.json | jq '[.components[] |\n    select(.properties[]? |\n        select(.name == \"cbom:proto:security_profile\")).properties[] |\n    select(.name == \"cbom:proto:security_profile\").value] |\n    group_by(.) |\n    map({profile: .[0], count: length})'\n</code></pre> <p>Expected: No \"OLD\" profiles, all \"MODERN\" or \"INTERMEDIATE\"</p>"},{"location":"cbom-generator/playbooks/tls-upgrade/#step-7-external-validation","title":"Step 7: External Validation","text":"<p>Test with SSL Labs or testssl.sh:</p> <pre><code># Using testssl.sh\n./testssl.sh --protocols --cipher-per-proto https://your-server.example.com\n\n# Or use nmap\nnmap --script ssl-enum-ciphers -p 443 your-server.example.com\n</code></pre>"},{"location":"cbom-generator/playbooks/tls-upgrade/#rollback-plan","title":"Rollback Plan","text":"<p>Keep backup of original configs:</p> <pre><code>sudo cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.backup\nsudo cp /etc/apache2/sites-available/default-ssl.conf /etc/apache2/sites-available/default-ssl.conf.backup\n</code></pre> <p>To rollback:</p> <pre><code>sudo cp /etc/nginx/nginx.conf.backup /etc/nginx/nginx.conf\nsudo systemctl restart nginx\n</code></pre>"},{"location":"cbom-generator/playbooks/tls-upgrade/#success-criteria","title":"Success Criteria","text":"<ul> <li>[ ] No TLS 1.0/1.1 protocols enabled</li> <li>[ ] All services use TLS 1.2+ minimum</li> <li>[ ] No weak cipher suites (RC4, DES, 3DES)</li> <li>[ ] CBOM shows MODERN or INTERMEDIATE security profiles</li> <li>[ ] External validation passes (SSL Labs A rating)</li> </ul>"},{"location":"cbom-generator/reference/cli-syntax/","title":"CLI Syntax Reference","text":"<p>Complete command-line syntax for CBOM Generator.</p>"},{"location":"cbom-generator/reference/cli-syntax/#usage","title":"Usage","text":"<pre><code>cbom-generator [OPTIONS] [PATHS...]\n</code></pre> <p>If no paths specified, scans default system locations.</p>"},{"location":"cbom-generator/reference/cli-syntax/#options","title":"Options","text":""},{"location":"cbom-generator/reference/cli-syntax/#output-options","title":"Output Options","text":"Option Description Default <code>-o, --output FILE</code> Output file path stdout <code>-f, --format FORMAT</code> Output format (json/cyclonedx) cyclonedx <code>--cyclonedx-spec VERSION</code> Spec version (1.6/1.7) 1.6"},{"location":"cbom-generator/reference/cli-syntax/#privacy-options","title":"Privacy Options","text":"Option Description Default <code>--no-personal-data</code> Redact personal data ON <code>--include-personal-data</code> Include full paths/hostnames OFF <code>--no-network</code> Disable network operations OFF"},{"location":"cbom-generator/reference/cli-syntax/#display-options","title":"Display Options","text":"Option Description Default <code>--tui</code> Enable Terminal UI OFF <code>--pqc-report FILE</code> Generate PQC report - <code>--error-log FILE</code> Write errors to file -"},{"location":"cbom-generator/reference/cli-syntax/#performance-options","title":"Performance Options","text":"Option Description Default <code>-t, --threads N</code> Worker threads (1-32) CPU count <code>-d, --deterministic</code> Deterministic output ON <code>--no-deterministic</code> Include timestamps OFF <code>--cross-arch</code> Cross-architecture mode OFF"},{"location":"cbom-generator/reference/cli-syntax/#deduplication-options","title":"Deduplication Options","text":"Option Description Default <code>--dedup-mode MODE</code> off/safe/strict safe <code>--emit-bundles</code> Create bundle components OFF"},{"location":"cbom-generator/reference/cli-syntax/#service-discovery-options","title":"Service Discovery Options","text":"Option Description Default <code>--discover-services</code> Enable service discovery OFF <code>--plugin-dir DIR</code> YAML plugin directory plugins/ <code>--list-plugins</code> List plugins and exit -"},{"location":"cbom-generator/reference/cli-syntax/#crypto-registry-options","title":"Crypto Registry Options","text":"Option Description Default <code>--crypto-registry FILE</code> External registry YAML -"},{"location":"cbom-generator/reference/cli-syntax/#attestation-options","title":"Attestation Options","text":"Option Description Default <code>--enable-attestation</code> Enable attestation OFF <code>--signature-method METHOD</code> dsse/pgp dsse <code>--signing-key PATH</code> Signing key file -"},{"location":"cbom-generator/reference/cli-syntax/#information-options","title":"Information Options","text":"Option Description <code>-h, --help</code> Display help <code>-v, --version</code> Display version"},{"location":"cbom-generator/reference/cli-syntax/#examples","title":"Examples","text":""},{"location":"cbom-generator/reference/cli-syntax/#basic-scan","title":"Basic Scan","text":"<pre><code>./build/cbom-generator --output cbom.json\n</code></pre>"},{"location":"cbom-generator/reference/cli-syntax/#privacy-compliant-scan","title":"Privacy-Compliant Scan","text":"<pre><code>./build/cbom-generator --no-personal-data --output cbom.json\n</code></pre>"},{"location":"cbom-generator/reference/cli-syntax/#full-service-discovery","title":"Full Service Discovery","text":"<pre><code>./build/cbom-generator \\\n    --discover-services \\\n    --plugin-dir plugins \\\n    --format cyclonedx --cyclonedx-spec 1.7 \\\n    --no-personal-data \\\n    --output cbom.json\n</code></pre>"},{"location":"cbom-generator/reference/cli-syntax/#cross-architecture-yocto","title":"Cross-Architecture (Yocto)","text":"<pre><code>./build/cbom-generator \\\n    --cross-arch \\\n    --discover-services \\\n    --plugin-dir plugins/embedded \\\n    --crypto-registry crypto-registry-yocto.yaml \\\n    --output yocto-cbom.json \\\n    /path/to/rootfs/usr /path/to/rootfs/etc\n</code></pre>"},{"location":"cbom-generator/reference/cli-syntax/#tui-with-logging","title":"TUI with Logging","text":"<pre><code>./build/cbom-generator \\\n    --tui \\\n    --error-log /tmp/errors.log \\\n    --output cbom.json\n</code></pre>"},{"location":"cbom-generator/reference/cli-syntax/#minimal-output","title":"Minimal Output","text":"<pre><code>./build/cbom-generator \\\n    --dedup-mode strict \\\n    --emit-bundles \\\n    --output cbom.json\n</code></pre>"},{"location":"cbom-generator/reference/cli-syntax/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 Success 1 Error (see stderr/error log)"},{"location":"cbom-generator/reference/cli-syntax/#environment-variables","title":"Environment Variables","text":"Variable Description <code>CBOM_SALT</code> Salt for privacy redaction <code>CBOM_CACHE_DIR</code> Cache directory <code>CBOM_LOG_LEVEL</code> Logging verbosity"},{"location":"cbom-generator/reference/deprecated-features/","title":"Deprecated Features","text":"<p>Migration guidance for deprecated functionality.</p>"},{"location":"cbom-generator/reference/deprecated-features/#deprecated-in-v11","title":"Deprecated in v1.1","text":""},{"location":"cbom-generator/reference/deprecated-features/#epoch-timestamps","title":"Epoch Timestamps","text":"<p>Deprecated: <code>cbom:cert:not_before_epoch</code>, <code>cbom:cert:not_after_epoch</code></p> <p>Replacement: Use ISO-8601 timestamps in <code>cryptoProperties.certificateProperties</code>:</p> <pre><code>// Deprecated\n{\n  \"name\": \"cbom:cert:not_before_epoch\",\n  \"value\": \"1577836800\"\n}\n\n// Use instead\n{\n  \"cryptoProperties\": {\n    \"certificateProperties\": {\n      \"notValidBefore\": \"2020-01-01T00:00:00Z\",\n      \"notValidAfter\": \"2030-01-01T00:00:00Z\"\n    }\n  }\n}\n</code></pre> <p>Reason: ISO-8601 is human-readable and CycloneDX standard.</p>"},{"location":"cbom-generator/reference/deprecated-features/#deprecated-in-v17","title":"Deprecated in v1.7","text":""},{"location":"cbom-generator/reference/deprecated-features/#-no-package-resolution","title":"<code>--no-package-resolution</code>","text":"<p>Deprecated: <code>--no-package-resolution</code> flag</p> <p>Replacement: Use <code>--cross-arch</code>:</p> <pre><code># Deprecated\n./build/cbom-generator --no-package-resolution --output cbom.json\n\n# Use instead\n./build/cbom-generator --cross-arch --output cbom.json\n</code></pre> <p>Reason: <code>--cross-arch</code> provides clearer semantics and enables VERNEED version detection.</p>"},{"location":"cbom-generator/reference/deprecated-features/#vestigial-flags","title":"Vestigial Flags","text":"<p>These flags are accepted for backward compatibility but have no effect:</p>"},{"location":"cbom-generator/reference/deprecated-features/#-format-json","title":"<code>--format json</code>","text":"<p>Status: Accepted, no effect</p> <p>Behavior: All output is CycloneDX format regardless of this flag.</p> <pre><code># These produce identical output\n./build/cbom-generator --format json --output cbom.json\n./build/cbom-generator --format cyclonedx --output cbom.json\n./build/cbom-generator --output cbom.json\n</code></pre>"},{"location":"cbom-generator/reference/deprecated-features/#-no-network","title":"<code>--no-network</code>","text":"<p>Status: Accepted, recorded in metadata, no functional effect in v1.0</p> <p>Planned for v1.1+: Will control OCSP, CRL, and NIST CMVP validation.</p>"},{"location":"cbom-generator/reference/deprecated-features/#removed-features","title":"Removed Features","text":"<p>None. All features from v1.0 remain available.</p>"},{"location":"cbom-generator/reference/deprecated-features/#migration-path","title":"Migration Path","text":""},{"location":"cbom-generator/reference/deprecated-features/#for-v10-v11","title":"For v1.0 \u2192 v1.1+","text":"<ol> <li>Update any scripts parsing epoch timestamps to use ISO-8601</li> <li>Replace <code>--no-package-resolution</code> with <code>--cross-arch</code></li> <li>No action needed for vestigial flags (still accepted)</li> </ol>"},{"location":"cbom-generator/reference/deprecated-features/#compatibility-mode","title":"Compatibility Mode","text":"<p>Deprecated features remain functional for at least 2 minor versions after deprecation notice.</p>"},{"location":"cbom-generator/reference/output-format/","title":"Output Format Reference","text":"<p>CycloneDX format specification details.</p>"},{"location":"cbom-generator/reference/output-format/#supported-formats","title":"Supported Formats","text":"<p>CBOM Generator outputs CycloneDX format only:</p> Format Specification CLI Flag CycloneDX 1.6 Default <code>--cyclonedx-spec 1.6</code> or omit CycloneDX 1.7 Latest <code>--cyclonedx-spec 1.7</code>"},{"location":"cbom-generator/reference/output-format/#cyclonedx-16-vs-17","title":"CycloneDX 1.6 vs 1.7","text":"<p>Both versions produce similar content:</p> Feature 1.6 1.7 <code>specVersion</code> <code>\"1.6\"</code> <code>\"1.7\"</code> Schema validation CycloneDX 1.6 schema CycloneDX 1.7 schema Tool compatibility Wider Growing Dependencies array Supported Enhanced <p>Recommendation: Use 1.6 for maximum compatibility. Use 1.7 when you need full dependency graph features.</p>"},{"location":"cbom-generator/reference/output-format/#json-structure","title":"JSON Structure","text":"<pre><code>{\n  \"bomFormat\": \"CycloneDX\",\n  \"specVersion\": \"1.6\",\n  \"serialNumber\": \"urn:uuid:...\",\n  \"version\": 1,\n  \"metadata\": {},\n  \"components\": [],\n  \"dependencies\": [],\n  \"relationships\": []\n}\n</code></pre>"},{"location":"cbom-generator/reference/output-format/#schema-validation","title":"Schema Validation","text":"<p>Validate output against CycloneDX schema:</p> <pre><code># Using cyclonedx-cli\ncyclonedx validate --input cbom.json\n\n# Using ajv\najv validate -s bom-1.6.schema.json -d cbom.json\n</code></pre> <p>Schema files available at: - https://cyclonedx.org/schema/bom-1.6.schema.json - https://cyclonedx.org/schema/bom-1.7.schema.json</p>"},{"location":"cbom-generator/reference/output-format/#cbom-extensions","title":"CBOM Extensions","text":"<p>CBOM Generator uses standard CycloneDX fields plus namespaced properties:</p>"},{"location":"cbom-generator/reference/output-format/#standard-cyclonedx-fields","title":"Standard CycloneDX Fields","text":"<ul> <li><code>type</code>: Component type</li> <li><code>name</code>: Component name</li> <li><code>bom-ref</code>: Unique identifier</li> <li><code>version</code>: Version string</li> <li><code>cryptoProperties</code>: CBOM crypto details</li> </ul>"},{"location":"cbom-generator/reference/output-format/#cbom-namespaced-properties","title":"CBOM Namespaced Properties","text":"<p>Properties prefixed with <code>cbom:</code> provide extended detail:</p> <ul> <li><code>cbom:pqc:*</code> - PQC assessment</li> <li><code>cbom:cert:*</code> - Certificate details</li> <li><code>cbom:key:*</code> - Key details</li> <li><code>cbom:proto:*</code> - Protocol details</li> <li><code>cbom:ctx:*</code> - Detection context</li> </ul>"},{"location":"cbom-generator/reference/output-format/#output-determinism","title":"Output Determinism","text":"<p>With <code>--deterministic</code> (default):</p> <ul> <li>Component order: Sorted alphabetically</li> <li>Property order: Consistent</li> <li>Timestamps: Excluded</li> <li>Serial number: Content-based UUID</li> </ul>"},{"location":"cbom-generator/reference/output-format/#file-size-estimates","title":"File Size Estimates","text":"Scan Type Components File Size /etc/ssl/certs only ~200 ~500KB System scan ~500-1000 ~1-2MB With services ~500-2000 ~2-5MB Enterprise ~5000+ ~10MB+ <p>Use <code>--dedup-mode=strict</code> to reduce size.</p>"},{"location":"cbom-generator/troubleshooting/","title":"Troubleshooting","text":"<p>Solutions for common issues with CBOM Generator.</p>"},{"location":"cbom-generator/troubleshooting/#common-issues","title":"Common Issues","text":"Issue Quick Link Empty or minimal results No Components Found Access denied errors Permission Errors Slow scans or high memory Performance Tuning Different output between runs Non-Deterministic Output"},{"location":"cbom-generator/troubleshooting/#quick-diagnostics","title":"Quick Diagnostics","text":""},{"location":"cbom-generator/troubleshooting/#check-version","title":"Check Version","text":"<pre><code>./build/cbom-generator --version\n</code></pre>"},{"location":"cbom-generator/troubleshooting/#verify-installation","title":"Verify Installation","text":"<pre><code># Run help\n./build/cbom-generator --help\n\n# Quick test scan\n./build/cbom-generator --output /tmp/test.json /etc/ssl/certs\ncat /tmp/test.json | jq '.components | length'\n</code></pre>"},{"location":"cbom-generator/troubleshooting/#view-scan-errors","title":"View Scan Errors","text":"<pre><code>./build/cbom-generator --error-log /tmp/errors.log --output cbom.json\ncat /tmp/errors.log\n</code></pre>"},{"location":"cbom-generator/troubleshooting/#getting-help","title":"Getting Help","text":""},{"location":"cbom-generator/troubleshooting/#error-log-analysis","title":"Error Log Analysis","text":"<p>Run with <code>--error-log</code> to capture detailed error information:</p> <pre><code>./build/cbom-generator --error-log /tmp/cbom-errors.log --output cbom.json 2&gt;&amp;1\n</code></pre>"},{"location":"cbom-generator/troubleshooting/#verbose-output","title":"Verbose Output","text":"<p>Enable verbose mode for debugging:</p> <pre><code>./build/cbom-generator --output cbom.json /etc/ssl 2&gt;&amp;1 | tee scan.log\n</code></pre>"},{"location":"cbom-generator/troubleshooting/#check-metadata-properties","title":"Check Metadata Properties","text":"<p>The CBOM includes diagnostic metadata:</p> <pre><code>cat cbom.json | jq '.metadata.properties[] | select(.name | startswith(\"cbom:diagnostics\"))'\n</code></pre>"},{"location":"cbom-generator/troubleshooting/no-components-found/","title":"No Components Found","text":"<p>Troubleshooting when CBOM Generator returns empty or minimal results.</p>"},{"location":"cbom-generator/troubleshooting/no-components-found/#symptoms","title":"Symptoms","text":"<ul> <li>Output contains 0 or very few components</li> <li>Expected certificates/keys not detected</li> <li>Services not discovered</li> </ul>"},{"location":"cbom-generator/troubleshooting/no-components-found/#common-causes","title":"Common Causes","text":""},{"location":"cbom-generator/troubleshooting/no-components-found/#1-scanning-wrong-directory","title":"1. Scanning Wrong Directory","text":"<p>Problem: Scanning a directory without cryptographic assets.</p> <p>Solution: Scan system directories containing crypto:</p> <pre><code># Recommended paths\n./build/cbom-generator --output cbom.json /etc/ssl /etc/pki /usr/share/ca-certificates /etc/ssh\n\n# Or scan broader system paths\n./build/cbom-generator --output cbom.json /etc /usr/lib\n</code></pre>"},{"location":"cbom-generator/troubleshooting/no-components-found/#2-permission-issues","title":"2. Permission Issues","text":"<p>Problem: Scanner cannot read files.</p> <p>Solution: Run with appropriate permissions:</p> <pre><code># Check access\nls -la /etc/ssl/private/\n\n# Run as root for full access\nsudo ./build/cbom-generator --output cbom.json\n</code></pre> <p>See Permission Errors for details.</p>"},{"location":"cbom-generator/troubleshooting/no-components-found/#3-service-discovery-not-enabled","title":"3. Service Discovery Not Enabled","text":"<p>Problem: Services not detected because <code>--discover-services</code> not used.</p> <p>Solution: Enable service discovery:</p> <pre><code>./build/cbom-generator \\\n    --discover-services \\\n    --plugin-dir plugins \\\n    --output cbom.json\n</code></pre>"},{"location":"cbom-generator/troubleshooting/no-components-found/#4-cross-architecture-mode-misconfigured","title":"4. Cross-Architecture Mode Misconfigured","text":"<p>Problem: Scanning embedded rootfs without <code>--cross-arch</code>.</p> <p>Solution: Enable cross-arch mode for Yocto/Buildroot:</p> <pre><code>./build/cbom-generator \\\n    --cross-arch \\\n    --output cbom.json \\\n    /path/to/rootfs/usr/bin /path/to/rootfs/etc\n</code></pre>"},{"location":"cbom-generator/troubleshooting/no-components-found/#diagnostic-steps","title":"Diagnostic Steps","text":""},{"location":"cbom-generator/troubleshooting/no-components-found/#step-1-check-error-log","title":"Step 1: Check Error Log","text":"<pre><code>./build/cbom-generator --error-log /tmp/errors.log --output cbom.json /etc/ssl\ncat /tmp/errors.log\n</code></pre>"},{"location":"cbom-generator/troubleshooting/no-components-found/#step-2-check-scan-statistics","title":"Step 2: Check Scan Statistics","text":"<pre><code>cat cbom.json | jq '{\n    total_components: (.components | length),\n    certificates: [.components[] | select(.cryptoProperties?.assetType == \"certificate\")] | length,\n    keys: [.components[] | select(.cryptoProperties?.assetType == \"related-crypto-material\")] | length,\n    algorithms: [.components[] | select(.cryptoProperties?.assetType == \"algorithm\")] | length\n}'\n</code></pre>"},{"location":"cbom-generator/troubleshooting/no-components-found/#step-3-check-diagnostics-metadata","title":"Step 3: Check Diagnostics Metadata","text":"<pre><code>cat cbom.json | jq '.metadata.properties[] | select(.name | contains(\"diagnostics\"))'\n</code></pre>"},{"location":"cbom-generator/troubleshooting/no-components-found/#step-4-test-individual-directories","title":"Step 4: Test Individual Directories","text":"<pre><code># Test certificates directory\n./build/cbom-generator --output /tmp/test-certs.json /etc/ssl/certs\ncat /tmp/test-certs.json | jq '.components | length'\n\n# Test keys directory\nsudo ./build/cbom-generator --output /tmp/test-keys.json /etc/ssl/private\ncat /tmp/test-keys.json | jq '.components | length'\n</code></pre>"},{"location":"cbom-generator/troubleshooting/no-components-found/#expected-results","title":"Expected Results","text":"<p>For typical Linux systems:</p> Directory Expected Components /etc/ssl/certs 100-200+ certificates /etc/ssl/private Varies (may need sudo) /etc/ssh SSH config, host keys /usr/share/ca-certificates System CA certificates"},{"location":"cbom-generator/troubleshooting/no-components-found/#deduplication-behavior","title":"Deduplication Behavior","text":"<p>Note: Certificate bundles (like <code>ca-certificates.crt</code>) contain many certificates. With deduplication:</p> <ul> <li>Same certificate in multiple files \u2192 1 component with multiple evidence entries</li> <li>~95% of individual .pem files may be \"duplicates\" of bundle contents</li> </ul> <p>This is expected and correct. Check <code>evidence.occurrences</code> array for all locations.</p>"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/","title":"Non-Deterministic Output","text":"<p>Troubleshooting when identical scans produce different output.</p>"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#symptoms","title":"Symptoms","text":"<ul> <li>SHA-256 hash of output differs between runs</li> <li>File order changes between scans</li> <li>CI/CD change detection triggers falsely</li> </ul>"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#expected-determinism","title":"Expected Determinism","text":"<p>By default, CBOM Generator produces deterministic output:</p> <ul> <li>Same input \u2192 identical JSON (byte-for-byte)</li> <li>Component order sorted alphabetically</li> <li>Timestamps excluded in deterministic mode</li> <li>Thread count doesn't affect output content</li> </ul>"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#common-causes-of-non-determinism","title":"Common Causes of Non-Determinism","text":""},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#1-deterministic-mode-disabled","title":"1. Deterministic Mode Disabled","text":"<p>Problem: Running with <code>--no-deterministic</code>.</p> <p>Solution: Use deterministic mode (default):</p> <pre><code># Deterministic (default)\n./build/cbom-generator --deterministic --output cbom.json\n\n# Or simply omit the flag\n./build/cbom-generator --output cbom.json\n</code></pre>"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#2-different-input-files","title":"2. Different Input Files","text":"<p>Problem: Files changed between scans.</p> <p>Solution: Ensure identical input:</p> <pre><code># Compare file listings\nfind /etc/ssl -type f | sort &gt; files-before.txt\n# ... run scan ...\nfind /etc/ssl -type f | sort &gt; files-after.txt\ndiff files-before.txt files-after.txt\n</code></pre>"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#3-different-cbom_salt","title":"3. Different CBOM_SALT","text":"<p>Problem: Privacy redaction salt differs between runs.</p> <p>Solution: Set consistent salt:</p> <pre><code>export CBOM_SALT=\"consistent-salt-value\"\n./build/cbom-generator --no-personal-data --output cbom.json\n</code></pre>"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#4-service-state-changes","title":"4. Service State Changes","text":"<p>Problem: Running services changed between scans.</p> <p>Solution: For reproducible results, don't use <code>--discover-services</code> or ensure services are in consistent state.</p>"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#verifying-determinism","title":"Verifying Determinism","text":""},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#test-1-identical-runs","title":"Test 1: Identical Runs","text":"<pre><code>./build/cbom-generator --output run1.json /etc/ssl/certs\n./build/cbom-generator --output run2.json /etc/ssl/certs\n\n# Compare\ndiff run1.json run2.json\n# Should show no differences\n\n# Or compare hashes\nsha256sum run1.json run2.json\n# Should be identical\n</code></pre>"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#test-2-thread-invariance","title":"Test 2: Thread Invariance","text":"<pre><code>./build/cbom-generator --threads 1 --output single.json /etc/ssl/certs\n./build/cbom-generator --threads 4 --output multi.json /etc/ssl/certs\n\ndiff single.json multi.json\n# Should show no differences\n</code></pre>"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#comparing-cboms","title":"Comparing CBOMs","text":"<pre><code># Generate current CBOM\n./build/cbom-generator --deterministic --output current.json\n\n# Compare with baseline (ignore timestamps if needed)\ncat baseline.json | jq 'del(.metadata.timestamp)' &gt; baseline-no-ts.json\ncat current.json | jq 'del(.metadata.timestamp)' &gt; current-no-ts.json\ndiff baseline-no-ts.json current-no-ts.json\n</code></pre>"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#change-detection","title":"Change Detection","text":"<pre><code># Calculate hash for comparison\nsha256sum cbom.json | cut -d' ' -f1 &gt; cbom.hash\n\n# In CI, compare with previous hash\nif ! diff cbom.hash previous-cbom.hash; then\n    echo \"CBOM changed - review required\"\n    exit 1\nfi\n</code></pre>"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#timestamps-in-output","title":"Timestamps in Output","text":"<p>Deterministic mode excludes variable timestamps:</p> Field Deterministic Non-Deterministic <code>metadata.timestamp</code> Excluded Included Epoch timestamps Excluded Included Serial number Deterministic UUID Random UUID"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#debugging-non-determinism","title":"Debugging Non-Determinism","text":""},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#identify-differences","title":"Identify Differences","text":"<pre><code># JSON diff showing specific changes\ndiff &lt;(cat run1.json | jq -S .) &lt;(cat run2.json | jq -S .)\n</code></pre>"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#check-sorting","title":"Check Sorting","text":"<pre><code># Verify components are sorted\ncat cbom.json | jq '[.components[].name]' | head -20\n</code></pre>"},{"location":"cbom-generator/troubleshooting/non-deterministic-output/#verify-serial-number","title":"Verify Serial Number","text":"<pre><code># Deterministic serial numbers based on content hash\ncat run1.json | jq '.serialNumber'\ncat run2.json | jq '.serialNumber'\n# Should be identical for identical content\n</code></pre>"},{"location":"cbom-generator/troubleshooting/performance-tuning/","title":"Performance Tuning","text":"<p>Optimize CBOM Generator scan performance.</p>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#symptoms","title":"Symptoms","text":"<ul> <li>Scans take too long</li> <li>High memory usage</li> <li>System becomes unresponsive during scan</li> </ul>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#performance-factors","title":"Performance Factors","text":"Factor Impact Mitigation File count Linear Target specific directories Thread count Parallelism Adjust <code>--threads</code> Output size Memory Use deduplication Service discovery Adds overhead Disable if not needed"},{"location":"cbom-generator/troubleshooting/performance-tuning/#thread-optimization","title":"Thread Optimization","text":""},{"location":"cbom-generator/troubleshooting/performance-tuning/#default-behavior","title":"Default Behavior","text":"<p>By default, CBOM Generator uses CPU count threads:</p> <pre><code># 4-core system \u2192 4 threads\n# 8-core system \u2192 8 threads\n</code></pre>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#adjusting-threads","title":"Adjusting Threads","text":"<pre><code># Reduce for low-memory systems\n./build/cbom-generator --threads 2 --output cbom.json\n\n# Increase for high-core systems (up to 32)\n./build/cbom-generator --threads 16 --output cbom.json\n\n# Single-threaded (sequential)\n./build/cbom-generator --threads 1 --output cbom.json\n</code></pre>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#performance-impact","title":"Performance Impact","text":"Threads Time (294 certs) Speedup 1 0.36s baseline 4 0.22s 1.64x"},{"location":"cbom-generator/troubleshooting/performance-tuning/#scan-scope-optimization","title":"Scan Scope Optimization","text":""},{"location":"cbom-generator/troubleshooting/performance-tuning/#target-specific-directories","title":"Target Specific Directories","text":"<pre><code># Instead of entire filesystem\n./build/cbom-generator --output cbom.json /\n\n# Target specific directories\n./build/cbom-generator --output cbom.json \\\n    /etc/ssl /etc/pki /etc/ssh /usr/share/ca-certificates\n</code></pre>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#exclude-non-crypto-directories","title":"Exclude Non-Crypto Directories","text":"<p>The scanner automatically skips hidden directories (<code>.cache</code>, <code>.config</code>, etc.), but you can further optimize by specifying only relevant paths.</p>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#deduplication-for-output-size","title":"Deduplication for Output Size","text":"<p>Large scans can produce huge output files:</p> <pre><code># Strict deduplication for minimal output\n./build/cbom-generator --dedup-mode=strict --emit-bundles --output cbom.json\n</code></pre> Mode Output Size Use Case off Largest Forensic analysis safe Medium (default) General use strict Smallest Large enterprise scans"},{"location":"cbom-generator/troubleshooting/performance-tuning/#memory-optimization","title":"Memory Optimization","text":""},{"location":"cbom-generator/troubleshooting/performance-tuning/#for-large-scans","title":"For Large Scans","text":"<pre><code># Reduce thread count to lower memory usage\n./build/cbom-generator --threads 2 --output cbom.json\n\n# Scan in batches\n./build/cbom-generator --output cbom-etc.json /etc\n./build/cbom-generator --output cbom-usr.json /usr\n</code></pre>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#monitor-memory-usage","title":"Monitor Memory Usage","text":"<pre><code># Watch memory during scan\nwatch -n 1 'ps -o rss,vsz,comm -p $(pgrep cbom-generator)'\n</code></pre>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#service-discovery-performance","title":"Service Discovery Performance","text":"<p>Service discovery adds overhead. Disable if not needed:</p> <pre><code># Without service discovery (faster)\n./build/cbom-generator --output cbom.json /etc/ssl\n\n# With service discovery (slower, more complete)\n./build/cbom-generator --discover-services --plugin-dir plugins --output cbom.json\n</code></pre>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#caching","title":"Caching","text":"<p>CBOM Generator includes SQLite-based persistent caching:</p> <ul> <li>10x+ improvement on repeated scans</li> <li>Cache stored automatically</li> <li>No configuration needed</li> </ul>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#clear-cache-if-needed","title":"Clear Cache (if needed)","text":"<pre><code>rm -rf ~/.cache/cbom-generator/\n</code></pre>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#benchmarking","title":"Benchmarking","text":""},{"location":"cbom-generator/troubleshooting/performance-tuning/#time-a-scan","title":"Time a Scan","text":"<pre><code>time ./build/cbom-generator --output cbom.json /etc/ssl\n</code></pre>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#tui-progress-monitoring","title":"TUI Progress Monitoring","text":"<pre><code># Visual progress indication\n./build/cbom-generator --tui --output cbom.json\n</code></pre>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#recommended-settings","title":"Recommended Settings","text":""},{"location":"cbom-generator/troubleshooting/performance-tuning/#desktopdevelopment","title":"Desktop/Development","text":"<pre><code>./build/cbom-generator \\\n    --dedup-mode=safe \\\n    --output cbom.json\n</code></pre>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#serverproduction","title":"Server/Production","text":"<pre><code>./build/cbom-generator \\\n    --threads 4 \\\n    --dedup-mode=safe \\\n    --no-personal-data \\\n    --output cbom.json\n</code></pre>"},{"location":"cbom-generator/troubleshooting/performance-tuning/#large-enterprise","title":"Large Enterprise","text":"<pre><code>./build/cbom-generator \\\n    --threads 8 \\\n    --dedup-mode=strict \\\n    --emit-bundles \\\n    --no-personal-data \\\n    --output cbom.json\n</code></pre>"},{"location":"cbom-generator/troubleshooting/permission-errors/","title":"Permission Errors","text":"<p>Troubleshooting access denied and permission issues.</p>"},{"location":"cbom-generator/troubleshooting/permission-errors/#symptoms","title":"Symptoms","text":"<ul> <li>\"Permission denied\" errors in log</li> <li>Private keys not detected</li> <li>Service configs not readable</li> <li>Incomplete results</li> </ul>"},{"location":"cbom-generator/troubleshooting/permission-errors/#common-scenarios","title":"Common Scenarios","text":""},{"location":"cbom-generator/troubleshooting/permission-errors/#1-private-key-directories","title":"1. Private Key Directories","text":"<p>Problem: <code>/etc/ssl/private</code> requires root access.</p> <pre><code>[error] key_scanner: Permission denied: /etc/ssl/private/server.key\n</code></pre> <p>Solution: Run as root:</p> <pre><code>sudo ./build/cbom-generator --output cbom.json\n</code></pre>"},{"location":"cbom-generator/troubleshooting/permission-errors/#2-service-configuration-files","title":"2. Service Configuration Files","text":"<p>Problem: Some service configs are root-only.</p> <p>Solution: Run with elevated privileges:</p> <pre><code>sudo ./build/cbom-generator --discover-services --plugin-dir plugins --output cbom.json\n</code></pre>"},{"location":"cbom-generator/troubleshooting/permission-errors/#3-user-home-directories","title":"3. User Home Directories","text":"<p>Problem: Cannot scan other users' files.</p> <p>Solution: Either: - Run as root for full access - Accept partial results for accessible files</p> <pre><code># Full access (requires root)\nsudo ./build/cbom-generator --include-personal-data --output cbom.json /home\n\n# Current user only\n./build/cbom-generator --include-personal-data --output cbom.json ~/\n</code></pre>"},{"location":"cbom-generator/troubleshooting/permission-errors/#graceful-degradation","title":"Graceful Degradation","text":"<p>CBOM Generator handles permission errors gracefully:</p> <ul> <li>Logs the error</li> <li>Continues scanning accessible files</li> <li>Reports partial results</li> </ul> <p>This is by design - you get the best possible results given current permissions.</p>"},{"location":"cbom-generator/troubleshooting/permission-errors/#checking-permission-errors","title":"Checking Permission Errors","text":""},{"location":"cbom-generator/troubleshooting/permission-errors/#in-error-log","title":"In Error Log","text":"<pre><code>./build/cbom-generator --error-log /tmp/errors.log --output cbom.json\ngrep \"Permission denied\" /tmp/errors.log\n</code></pre>"},{"location":"cbom-generator/troubleshooting/permission-errors/#in-output-metadata","title":"In Output Metadata","text":"<pre><code>cat cbom.json | jq '.errors[] | select(.message | contains(\"Permission\"))'\n</code></pre>"},{"location":"cbom-generator/troubleshooting/permission-errors/#best-practices","title":"Best Practices","text":""},{"location":"cbom-generator/troubleshooting/permission-errors/#developmenttesting","title":"Development/Testing","text":"<pre><code># Run as current user, accept limitations\n./build/cbom-generator --output cbom.json /etc/ssl /etc/ssh\n</code></pre>"},{"location":"cbom-generator/troubleshooting/permission-errors/#productionaudit","title":"Production/Audit","text":"<pre><code># Run as root for complete inventory\nsudo ./build/cbom-generator --output cbom.json --no-personal-data\n</code></pre>"},{"location":"cbom-generator/troubleshooting/permission-errors/#least-privilege","title":"Least Privilege","text":"<p>Create a dedicated user with read access:</p> <pre><code># Create scanner group\nsudo groupadd cbom-scanner\n\n# Add read permissions where needed\nsudo setfacl -R -m g:cbom-scanner:r /etc/ssl/private/\n\n# Run as member of that group\nsudo -u cbom-user ./build/cbom-generator --output cbom.json\n</code></pre>"},{"location":"cbom-generator/troubleshooting/permission-errors/#security-considerations","title":"Security Considerations","text":"<p>When running as root:</p> <ul> <li>Output may contain sensitive file paths</li> <li>Use <code>--no-personal-data</code> for external sharing</li> <li>Secure the output file appropriately</li> </ul> <pre><code>sudo ./build/cbom-generator --no-personal-data --output /secure/cbom.json\nsudo chmod 600 /secure/cbom.json\n</code></pre>"}]}